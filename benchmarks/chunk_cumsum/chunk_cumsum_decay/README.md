# Chunk cumsum scalar decay benchmark

## A100

### Reverse = False

#### Speed
```
chunk_cumsum_decay-speed-b4-h16-d1-reverse_False-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.007766  0.106362       0.202318  0.008927
1   2048.0  0.008053  0.274241       0.385448  0.010854
2   4096.0  0.009265  0.608438       0.674028  0.012895
3   8192.0  0.009358  1.418652       1.363017  0.018420
4  16384.0  0.011615  2.702150       3.019218  0.029896
5  32768.0  0.013565  5.427081       5.883590  0.048682

chunk_cumsum_decay-speed-b16-h16-d1-reverse_False-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008601  0.117310       0.142146  0.013012
1   2048.0  0.009758  0.282915       0.343075  0.019156
2   4096.0  0.011025  0.634914       0.689870  0.029234
3   8192.0  0.014306  1.340768       1.393250  0.048854
4  16384.0  0.019843  2.785643       3.010166  0.089658
5  32768.0  0.030400  5.569691       5.617062  0.169752

chunk_cumsum_decay-speed-b4-h16-d128-reverse_False-bf16:
         n    triton       torch  torch_compile        fla
0   1024.0  0.057133    4.858410       0.034552   2.879292
1   2048.0  0.533682    9.693924       0.059925   5.636510
2   4096.0  0.164444   19.330233       0.109647  11.166965
3   8192.0  2.053746   38.680801       0.207704  22.210865
4  16384.0  0.727168   77.195068       0.406147  44.333904
5  32768.0  1.342985  154.372253       0.801401  88.662750

chunk_cumsum_decay-speed-b16-h16-d128-reverse_False-bf16:
         n     triton       torch  torch_compile         fla
0   1024.0   0.164976   19.329336       0.109766   11.186468
1   2048.0   3.974941   38.615040       0.208474   22.205175
2   4096.0   0.725525   77.196899       0.405715   44.329552
3   8192.0  15.794971  154.381287       0.800448   88.605919
4  16384.0   2.624440  308.772644       1.609255  177.016998
5  32768.0   5.233760  617.539490       3.232610  353.828644
```

#### Memory
```
chunk_cumsum_decay-memory-b4-h16-d1-reverse_False-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    0.25   0.875            0.5   0.375
1   2048.0    0.50   1.750            1.0   0.750
2   4096.0    1.00   3.500            2.0   1.500
3   8192.0    2.00   7.000            4.0   3.000
4  16384.0    4.00  14.000            8.0   6.000
5  32768.0    8.00  28.000           16.0  12.000

chunk_cumsum_decay-memory-b4-h16-d128-reverse_False-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    32.0   128.0           32.0    48.0
1   2048.0    64.0   256.0           64.0    96.0
2   4096.0   128.0   512.0          128.0   192.0
3   8192.0   256.0  1024.0          256.0   384.0
4  16384.0   512.0  2048.0          512.0   768.0
5  32768.0  1024.0  4096.0         1024.0  1536.0

chunk_cumsum_decay-memory-b16-h16-d1-reverse_False-bf16:
         n  triton  torch  torch_compile   fla
0   1024.0     1.0    3.5            2.0   1.5
1   2048.0     2.0    7.0            7.0   3.0
2   4096.0     4.0   14.0           14.0   6.0
3   8192.0     8.0   28.0           28.0  12.0
4  16384.0    16.0   56.0           56.0  24.0
5  32768.0    32.0  112.0          112.0  48.0

chunk_cumsum_decay-memory-b16-h16-d128-reverse_False-bf16:
         n  triton    torch  torch_compile     fla
0   1024.0   128.0    512.0          128.0   192.0
1   2048.0   256.0   1024.0          256.0   384.0
2   4096.0   512.0   2048.0          512.0   768.0
3   8192.0  1024.0   4096.0         1024.0  1536.0
4  16384.0  2048.0   8192.0         2048.0  3072.0
5  32768.0  4096.0  16384.0         4096.0  6144.0
```

### Reverse = False

#### Speed
```
chunk_cumsum_decay-speed-b4-h16-d1-reverse_True-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008319  0.276270       0.074292  0.009035
1   2048.0  0.008632  0.641287       0.355564  0.010413
2   4096.0  0.008576  1.153296       0.675315  0.013057
3   8192.0  0.010060  2.370416       1.228449  0.019098
4  16384.0  0.011843  4.554681       2.459328  0.028472
5  32768.0  0.013808  9.199734       4.994848  0.049371

chunk_cumsum_decay-speed-b4-h16-d128-reverse_True-bf16:
         n    triton       torch  torch_compile        fla
0   1024.0  0.048988    4.990823       0.090644   2.872268
1   2048.0  0.103075    9.958269       0.163634   5.638724
2   4096.0  0.140139   19.888224       0.309510  11.157001
3   8192.0  0.376451   39.671280       0.601004  22.212601
4  16384.0  0.681624   79.326622       1.183357  44.335552
5  32768.0  1.226589  158.640442       2.350210  88.550339

chunk_cumsum_decay-speed-b16-h16-d1-reverse_True-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.009146  0.276054       0.137403  0.013128
1   2048.0  0.009359  0.535712       0.595430  0.019103
2   4096.0  0.011764  1.098200       1.189672  0.028826
3   8192.0  0.014211  2.227920       2.318341  0.049464
4  16384.0  0.019815  4.519439       4.591922  0.088951
5  32768.0  0.030898  9.055392       8.980528  0.170235

chunk_cumsum_decay-speed-b16-h16-d128-reverse_True-bf16:
         n     triton       torch  torch_compile         fla
0   1024.0   0.141006   19.869007       0.309355   11.160347
1   2048.0   2.675309   39.669697       0.600969   22.217873
2   4096.0   0.671697   79.320419       1.182691   44.316113
3   8192.0  10.590286  158.632538       2.349433   88.484383
4  16384.0   2.525217  317.252747       4.727214  177.023590
5  32768.0   5.017418  634.626526       9.450788  354.172821
```

#### Memory
```
chunk_cumsum_decay-memory-b4-h16-d1-reverse_True-bf16:
         n  triton      torch  torch_compile     fla
0   1024.0    0.25   0.907227           0.50   0.375
1   2048.0    0.50   1.782227           1.25   0.750
2   4096.0    1.00   3.532227           2.50   1.500
3   8192.0    2.00   7.032227           5.00   3.000
4  16384.0    4.00  14.032227          10.00   6.000
5  32768.0    8.00  28.032227          20.00  12.000

chunk_cumsum_decay-memory-b4-h16-d128-reverse_True-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    32.0   163.0           64.0    48.0
1   2048.0    64.0   326.0          128.0    96.0
2   4096.0   128.0   652.0          256.0   192.0
3   8192.0   256.0  1304.0          512.0   384.0
4  16384.0   512.0  2608.0         1024.0   768.0
5  32768.0  1024.0  5216.0         2048.0  1536.0

chunk_cumsum_decay-memory-b16-h16-d1-reverse_True-bf16:
         n  triton       torch  torch_compile   fla
0   1024.0     1.0    3.626465       2.000000   1.5
1   2048.0     2.0    7.126465       7.126465   3.0
2   4096.0     4.0   14.126465      14.126465   6.0
3   8192.0     8.0   28.126465      28.126465  12.0
4  16384.0    16.0   56.126465      56.126465  24.0
5  32768.0    32.0  112.126465     112.126465  48.0

chunk_cumsum_decay-memory-b16-h16-d128-reverse_True-bf16:
         n  triton    torch  torch_compile     fla
0   1024.0   128.0    652.0          256.0   192.0
1   2048.0   256.0   1304.0          512.0   384.0
2   4096.0   512.0   2608.0         1024.0   768.0
3   8192.0  1024.0   5216.0         2048.0  1536.0
4  16384.0  2048.0  10432.0         4096.0  3072.0
5  32768.0  4096.0  20864.0         8192.0  6144.0
```

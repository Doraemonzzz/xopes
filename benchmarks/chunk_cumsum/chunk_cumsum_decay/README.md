# Chunk cumsum scalar decay benchmark

## A100

### Reverse = False

#### Speed
```
chunk_cumsum_decay-speed-b4-h16-d1-reverse_False-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008333  0.109372       0.202133  0.009568
1   2048.0  0.008471  0.275441       0.385245  0.010251
2   4096.0  0.008279  0.620688       0.748937  0.012772
3   8192.0  0.009375  1.341223       1.480110  0.022239
4  16384.0  0.011892  2.764011       3.024383  0.034080
5  32768.0  0.013610  5.510916       6.056282  0.059653

chunk_cumsum_decay-speed-b4-h16-d128-reverse_False-bf16:
         n    triton       torch  torch_compile        fla
0   1024.0  0.031703    4.852859       0.035165   2.876225
1   2048.0  0.052820    9.693507       0.059973   5.636902
2   4096.0  0.092614   19.336395       0.109618  11.161256
3   8192.0  0.173047   38.612846       0.208536  22.246910
4  16384.0  0.335045   77.195198       0.405988  44.343346
5  32768.0  0.652342  154.378403       0.806489  88.569405

chunk_cumsum_decay-speed-b16-h16-d1-reverse_False-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008628  0.113475       0.143007  0.013080
1   2048.0  0.009774  0.283422       0.334479  0.017928
2   4096.0  0.011042  0.629381       0.740854  0.028671
3   8192.0  0.014426  1.334518       1.385450  0.048007
4  16384.0  0.019276  2.783160       2.892708  0.088359
5  32768.0  0.030141  5.865780       5.921336  0.167676

chunk_cumsum_decay-speed-b16-h16-d128-reverse_False-bf16:
         n    triton       torch  torch_compile         fla
0   1024.0  0.094104   19.352736       0.109705   11.162940
1   2048.0  0.175257   38.619698       0.207938   22.233839
2   4096.0  0.344163   77.198845       0.405439   44.306702
3   8192.0  0.666384  154.368423       0.805644   88.624252
4  16384.0  1.317496  308.761932       1.611544  176.937531
5  32768.0  2.626026  617.768066       3.251422  353.776459
```

#### Memory
```
chunk_cumsum_decay-memory-b4-h16-d1-reverse_False-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    0.25   0.875            0.5   0.375
1   2048.0    0.50   1.750            1.0   0.750
2   4096.0    1.00   3.500            2.0   1.500
3   8192.0    2.00   7.000            4.0   3.000
4  16384.0    4.00  14.000            8.0   6.000
5  32768.0    8.00  28.000           16.0  12.000

chunk_cumsum_decay-memory-b4-h16-d128-reverse_False-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    32.0   128.0           32.0    48.0
1   2048.0    64.0   256.0           64.0    96.0
2   4096.0   128.0   512.0          128.0   192.0
3   8192.0   256.0  1024.0          256.0   384.0
4  16384.0   512.0  2048.0          512.0   768.0
5  32768.0  1024.0  4096.0         1024.0  1536.0

chunk_cumsum_decay-memory-b16-h16-d1-reverse_False-bf16:
         n  triton  torch  torch_compile   fla
0   1024.0     1.0    3.5            2.0   1.5
1   2048.0     2.0    7.0            7.0   3.0
2   4096.0     4.0   14.0           14.0   6.0
3   8192.0     8.0   28.0           28.0  12.0
4  16384.0    16.0   56.0           56.0  24.0
5  32768.0    32.0  112.0          112.0  48.0

chunk_cumsum_decay-memory-b16-h16-d128-reverse_False-bf16:
         n  triton    torch  torch_compile     fla
0   1024.0   128.0    512.0          128.0   192.0
1   2048.0   256.0   1024.0          256.0   384.0
2   4096.0   512.0   2048.0          512.0   768.0
3   8192.0  1024.0   4096.0         1024.0  1536.0
4  16384.0  2048.0   8192.0         2048.0  3072.0
5  32768.0  4096.0  16384.0         4096.0  6144.0
```

### Reverse = True

#### Speed
```
chunk_cumsum_decay-speed-b4-h16-d1-reverse_True-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.007924  0.273144       0.070683  0.009027
1   2048.0  0.007945  0.534838       0.354043  0.012889
2   4096.0  0.009189  1.110971       0.662904  0.015019
3   8192.0  0.009366  2.234371       1.308954  0.022550
4  16384.0  0.011242  4.531454       2.446570  0.032206
5  32768.0  0.014373  9.337677       4.883043  0.054708

chunk_cumsum_decay-speed-b4-h16-d128-reverse_True-bf16:
         n    triton       torch  torch_compile        fla
0   1024.0  0.033771    4.992311       0.090678   2.876475
1   2048.0  0.053926    9.968020       0.163529   5.644732
2   4096.0  0.094846   19.849327       0.309372  11.167988
3   8192.0  0.176417   39.667248       0.601180  22.227217
4  16384.0  0.339390   79.327171       1.182423  44.288544
5  32768.0  0.663215  158.621887       2.349839  88.595840

chunk_cumsum_decay-speed-b16-h16-d1-reverse_True-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008819  0.271886       0.127917  0.013288
1   2048.0  0.009833  0.598956       0.604797  0.018123
2   4096.0  0.011830  1.085095       1.137271  0.028340
3   8192.0  0.013890  2.200116       2.280105  0.048918
4  16384.0  0.019835  4.734618       5.012425  0.088794
5  32768.0  0.030922  9.529629       9.340719  0.168827

chunk_cumsum_decay-speed-b16-h16-d128-reverse_True-bf16:
         n    triton       torch  torch_compile         fla
0   1024.0  0.095428   19.887497       0.309345   11.158187
1   2048.0  0.180418   39.662064       0.601047   22.210735
2   4096.0  0.355529   79.322304       1.182743   44.298286
3   8192.0  0.684738  158.808350       2.350335   88.475677
4  16384.0  1.356251  317.242798       4.726473  176.940292
5  32768.0  2.714476  634.743958       9.456495  353.969940
```

#### Memory
```
chunk_cumsum_decay-memory-b4-h16-d1-reverse_True-bf16:
         n  triton      torch  torch_compile     fla
0   1024.0    0.25   0.907227           0.50   0.375
1   2048.0    0.50   1.782227           1.25   0.750
2   4096.0    1.00   3.532227           2.50   1.500
3   8192.0    2.00   7.032227           5.00   3.000
4  16384.0    4.00  14.032227          10.00   6.000
5  32768.0    8.00  28.032227          20.00  12.000

chunk_cumsum_decay-memory-b4-h16-d128-reverse_True-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    32.0   163.0           64.0    48.0
1   2048.0    64.0   326.0          128.0    96.0
2   4096.0   128.0   652.0          256.0   192.0
3   8192.0   256.0  1304.0          512.0   384.0
4  16384.0   512.0  2608.0         1024.0   768.0
5  32768.0  1024.0  5216.0         2048.0  1536.0

chunk_cumsum_decay-memory-b16-h16-d1-reverse_True-bf16:
         n  triton       torch  torch_compile   fla
0   1024.0     1.0    3.626465       2.000000   1.5
1   2048.0     2.0    7.126465       7.126465   3.0
2   4096.0     4.0   14.126465      14.126465   6.0
3   8192.0     8.0   28.126465      28.126465  12.0
4  16384.0    16.0   56.126465      56.126465  24.0
5  32768.0    32.0  112.126465     112.126465  48.0

chunk_cumsum_decay-memory-b16-h16-d128-reverse_True-bf16:
         n  triton    torch  torch_compile     fla
0   1024.0   128.0    652.0          256.0   192.0
1   2048.0   256.0   1304.0          512.0   384.0
2   4096.0   512.0   2608.0         1024.0   768.0
3   8192.0  1024.0   5216.0         2048.0  1536.0
4  16384.0  2048.0  10432.0         4096.0  3072.0
5  32768.0  4096.0  20864.0         8192.0  6144.0
```

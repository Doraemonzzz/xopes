# Chunk cumsum scalar decay benchmark

## A100

### Reverse = False

#### Speed
```
chunk_cumsum_decay-speed-b4-h16-d1-reverse_False-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008034  0.111900       0.201843  0.009496
1   2048.0  0.007926  0.281428       0.384501  0.012218
2   4096.0  0.009334  0.619250       0.763753  0.015965
3   8192.0  0.009523  1.398220       1.475481  0.022760
4  16384.0  0.011325  2.821508       3.013679  0.034039
5  32768.0  0.015316  5.884448       5.627612  0.049182

chunk_cumsum_decay-speed-b4-h16-d128-reverse_False-bf16:
         n    triton       torch  torch_compile        fla
0   1024.0  0.038867    4.848424       0.034451   2.875195
1   2048.0  0.075628    9.672732       0.063714   5.636708
2   4096.0  0.140599   19.382284       0.109522  11.166589
3   8192.0  0.269694   38.624413       0.208098  22.222055
4  16384.0  0.526098   77.207581       0.406098  44.335007
5  32768.0  1.038496  154.415421       0.799394  88.556221

chunk_cumsum_decay-speed-b16-h16-d1-reverse_False-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.009280  0.112223       0.141422  0.012968
1   2048.0  0.009427  0.292002       0.334149  0.018321
2   4096.0  0.012339  0.625338       0.686479  0.029172
3   8192.0  0.015612  1.348028       1.420895  0.049394
4  16384.0  0.023322  2.843581       2.929438  0.089525
5  32768.0  0.040539  5.794614       6.011378  0.170147

chunk_cumsum_decay-speed-b16-h16-d128-reverse_False-bf16:
         n    triton       torch  torch_compile         fla
0   1024.0  0.143187   19.328537       0.109594   11.151560
1   2048.0  0.273865   38.616211       0.208016   22.203257
2   4096.0  0.536270   77.203964       0.405650   44.300064
3   8192.0  1.055218  154.392899       0.805084   88.421791
4  16384.0  2.109579  308.810181       1.610317  176.864517
5  32768.0  4.202631  617.609009       3.231495  353.758728
```

#### Memory
```
chunk_cumsum_decay-memory-b4-h16-d1-reverse_False-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    0.25   0.875            0.5   0.375
1   2048.0    0.50   1.750            1.0   0.750
2   4096.0    1.00   3.500            2.0   1.500
3   8192.0    2.00   7.000            4.0   3.000
4  16384.0    4.00  14.000            8.0   6.000
5  32768.0    8.00  28.000           16.0  12.000

chunk_cumsum_decay-memory-b4-h16-d128-reverse_False-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    32.0   128.0           32.0    48.0
1   2048.0    64.0   256.0           64.0    96.0
2   4096.0   128.0   512.0          128.0   192.0
3   8192.0   256.0  1024.0          256.0   384.0
4  16384.0   512.0  2048.0          512.0   768.0
5  32768.0  1024.0  4096.0         1024.0  1536.0

chunk_cumsum_decay-memory-b16-h16-d1-reverse_False-bf16:
         n  triton  torch  torch_compile   fla
0   1024.0     1.0    3.5            2.0   1.5
1   2048.0     2.0    7.0            7.0   3.0
2   4096.0     4.0   14.0           14.0   6.0
3   8192.0     8.0   28.0           28.0  12.0
4  16384.0    16.0   56.0           56.0  24.0
5  32768.0    32.0  112.0          112.0  48.0

chunk_cumsum_decay-memory-b16-h16-d128-reverse_False-bf16:
         n  triton    torch  torch_compile     fla
0   1024.0   128.0    512.0          128.0   192.0
1   2048.0   256.0   1024.0          256.0   384.0
2   4096.0   512.0   2048.0          512.0   768.0
3   8192.0  1024.0   4096.0         1024.0  1536.0
4  16384.0  2048.0   8192.0         2048.0  3072.0
5  32768.0  4096.0  16384.0         4096.0  6144.0
```

### Reverse = True

#### Speed
```
chunk_cumsum_decay-speed-b4-h16-d1-reverse_True-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008431  0.266018       0.074927  0.009010
1   2048.0  0.010177  0.536999       0.341677  0.012312
2   4096.0  0.009162  1.125712       0.655375  0.015165
3   8192.0  0.010183  2.254381       1.221082  0.022827
4  16384.0  0.011446  4.541315       2.380143  0.034773
5  32768.0  0.015639  9.352256       4.797970  0.060617

chunk_cumsum_decay-speed-b4-h16-d128-reverse_True-bf16:
         n    triton       torch  torch_compile        fla
0   1024.0  0.041235    4.979895       0.090635   2.873482
1   2048.0  0.075490    9.936068       0.163229   5.633551
2   4096.0  0.140862   19.897266       0.308792  11.168003
3   8192.0  0.270035   39.663727       0.600177  22.207872
4  16384.0  0.527202   79.331711       1.181547  44.308304
5  32768.0  1.042016  158.616608       2.348142  88.513123

chunk_cumsum_decay-speed-b16-h16-d1-reverse_True-bf16:
         n    triton     torch  torch_compile       fla
0   1024.0  0.008585  0.258144       0.132761  0.016220
1   2048.0  0.010069  0.541187       0.605813  0.019121
2   4096.0  0.012079  1.085869       1.157840  0.028667
3   8192.0  0.015724  2.185515       2.276388  0.049471
4  16384.0  0.023579  4.644208       4.665647  0.088883
5  32768.0  0.040567  9.168394       9.336909  0.169552

chunk_cumsum_decay-speed-b16-h16-d128-reverse_True-bf16:
         n    triton       torch  torch_compile         fla
0   1024.0  0.141482   19.855585       0.309031   11.167396
1   2048.0  0.272260   39.668049       0.600942   22.192640
2   4096.0  0.531656   79.323837       1.182089   44.397808
3   8192.0  1.054808  158.632965       2.347674   88.504898
4  16384.0  2.095069  317.290649       4.721360  176.760391
5  32768.0  4.266201  634.570312       9.440714  353.770935
```

#### Memory
```
chunk_cumsum_decay-memory-b4-h16-d1-reverse_True-bf16:
         n  triton      torch  torch_compile     fla
0   1024.0    0.25   0.907227           0.50   0.375
1   2048.0    0.50   1.782227           1.25   0.750
2   4096.0    1.00   3.532227           2.50   1.500
3   8192.0    2.00   7.032227           5.00   3.000
4  16384.0    4.00  14.032227          10.00   6.000
5  32768.0    8.00  28.032227          20.00  12.000

chunk_cumsum_decay-memory-b4-h16-d128-reverse_True-bf16:
         n  triton   torch  torch_compile     fla
0   1024.0    32.0   163.0           64.0    48.0
1   2048.0    64.0   326.0          128.0    96.0
2   4096.0   128.0   652.0          256.0   192.0
3   8192.0   256.0  1304.0          512.0   384.0
4  16384.0   512.0  2608.0         1024.0   768.0
5  32768.0  1024.0  5216.0         2048.0  1536.0

chunk_cumsum_decay-memory-b16-h16-d1-reverse_True-bf16:
         n  triton       torch  torch_compile   fla
0   1024.0     1.0    3.626465       2.000000   1.5
1   2048.0     2.0    7.126465       7.126465   3.0
2   4096.0     4.0   14.126465      14.126465   6.0
3   8192.0     8.0   28.126465      28.126465  12.0
4  16384.0    16.0   56.126465      56.126465  24.0
5  32768.0    32.0  112.126465     112.126465  48.0

chunk_cumsum_decay-memory-b16-h16-d128-reverse_True-bf16:
         n  triton    torch  torch_compile     fla
0   1024.0   128.0    652.0          256.0   192.0
1   2048.0   256.0   1304.0          512.0   384.0
2   4096.0   512.0   2608.0         1024.0   768.0
3   8192.0  1024.0   5216.0         2048.0  1536.0
4  16384.0  2048.0  10432.0         4096.0  3072.0
5  32768.0  4096.0  20864.0         8192.0  6144.0
```

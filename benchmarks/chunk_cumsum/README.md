# Chunk cumsum benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Speed
```
chunk_cumsum-speed-fwd-batch4096-reverse_False-bf16:
         n        tr        to       toc
0   1024.0  0.032792  0.199187  0.054818
1   2048.0  0.056263  0.377132  0.175658
2   4096.0  0.104530  0.752053  0.334728
3   8192.0  0.201464  1.498789  0.611289
4  16384.0  0.395712  2.985634  1.233871
5  32768.0  0.784964  5.956838  2.379150

chunk_cumsum-speed-bwd-batch4096-reverse_False-bf16:
         n        tr          to        toc
0   1024.0  0.056982    0.528577   0.180272
1   2048.0  0.086348    1.832325   0.263437
2   4096.0  0.162859    5.994986   0.583887
3   8192.0  0.317017   21.407000   1.758555
4  16384.0  0.623704   80.384003   6.077365
5  32768.0  1.237988  311.834167  23.715504
```

### Memory
```
chunk_cumsum-memory-fwd-batch4096-reverse_False-bf16:
         n     tr      to     toc
0   1024.0   16.0    56.0    32.0
1   2048.0   32.0   112.0    64.0
2   4096.0   64.0   224.0   128.0
3   8192.0  128.0   448.0   256.0
4  16384.0  256.0   896.0   512.0
5  32768.0  512.0  1792.0  1024.0

chunk_cumsum-memory-bwd-batch4096-reverse_False-bf16:
         n      tr      to     toc
0   1024.0    39.6    81.6    55.6
1   2048.0    79.2   161.2   111.2
2   4096.0   158.4   320.4   222.4
3   8192.0   316.8   638.8   444.8
4  16384.0   633.6  1275.6   889.6
5  32768.0  1267.2  2549.2  2027.2
```

# A800

Torch C means using `torch.compile`.

## Head dim = 128

```
flao-speed-fwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C  Flao Tri
0    256.0   0.065819   0.104355   0.064970    0.107686  0.156040
1    512.0   0.115266   0.127821   0.114215    0.131522  0.357555
2   1024.0   0.199516   0.198863   0.398542    0.199749  0.310717
3   2048.0   0.355657   0.353274   0.355630    0.354453  1.073111
4   4096.0   0.659495   0.661189   0.662350    0.661941  2.409069
5   8192.0   2.735866   2.786280   2.769806    2.784580  5.219671
6  16384.0   5.558557   5.874289   5.763970    5.746245  9.655482
7  32768.0  11.252705  11.138893  11.136756   11.467720  8.578347

flao-memory-fwd-batch12-head12-dim128-dim128-bf16:
         n   Lao Tor  Lao Tor C  Flao Tor  Flao Tor C  Flao Tri
0    256.0    75.625     75.625    75.625      75.625    80.125
1    512.0   138.625    138.625   138.625     138.625   143.125
2   1024.0   264.625    264.625   264.625     264.625   269.125
3   2048.0   516.625    516.625   516.625     516.625   521.125
4   4096.0  1020.625   1020.625  1020.625    1020.625  1025.125
5   8192.0  2028.625   2028.625  2028.625    2028.625  2033.125
6  16384.0  4044.625   4044.625  4044.625    4044.625  4049.125
7  32768.0  8076.625   8076.625  8076.625    8076.625  8081.125

flao-speed-bwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C   Flao Tri
0    256.0   0.438498   0.496781   0.459431    0.445044   0.565881
1    512.0   1.095987   1.017676   0.585666    0.831397   1.052224
2   1024.0   1.994770   1.774736   1.458713    1.528525   1.722364
3   2048.0   3.574733   3.421901   2.760391    2.791225   3.084913
4   4096.0   6.985884   6.680162   3.309654    2.339204   2.663144
5   8192.0   6.215928   6.030377   4.740672    4.570815   5.137852
6  16384.0  12.080560  11.699616   9.137709    8.807846   9.920630
7  32768.0  24.023432  23.367226  18.218754   17.595257  19.763994

flao-memory-bwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C   Flao Tri
0    256.0    142.450    159.550    168.325     159.325    172.825
1    512.0    259.000    293.200    310.525     292.525    315.025
2   1024.0    491.225    559.625    594.050     558.050    598.550
3   2048.0    957.425   1094.225   1162.850    1090.850   1167.350
4   4096.0   1889.825   2163.425   2300.450    2156.450   2304.950
5   8192.0   3754.625   4301.825   4575.650    4287.650   4580.150
6  16384.0   7484.225   8578.625   9126.050    8550.050   9130.550
7  32768.0  14943.425  17132.225  18226.850   17074.850  18231.350
```



flao cache
```
flao-speed-fwd-batch12-head12-dim128-dim128-bf16:
         n   Lao Tor  Lao Tor C  Flao Tor  Flao Tor C
0    256.0  0.071980   0.108047  0.072407    0.111565
1    512.0  0.115666   0.127628  0.122565    0.143629
2   1024.0  0.212333   0.200172  0.199850    0.200057
3   2048.0  0.355979   0.353750  0.356141    0.355087
4   4096.0  0.658438   0.659937  0.659122    0.660739
5   8192.0  1.271852   1.273651  1.274873    1.272889
6  16384.0  2.522253   2.523446  2.525341    2.526485
7  32768.0  5.035986   5.053722  5.060450    5.037191
flao-memory-fwd-batch12-head12-dim128-dim128-bf16:
         n   Lao Tor  Lao Tor C  Flao Tor  Flao Tor C
0    256.0    75.625     75.625    75.625      75.625
1    512.0   138.625    138.625   138.625     138.625
2   1024.0   264.625    264.625   264.625     264.625
3   2048.0   516.625    516.625   516.625     516.625
4   4096.0  1020.625   1020.625  1020.625    1020.625
5   8192.0  2028.625   2028.625  2028.625    2028.625
6  16384.0  4044.625   4044.625  4044.625    4044.625
7  32768.0  8076.625   8076.625  8076.625    8076.625
flao-speed-bwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C
0    256.0   0.239458   0.236013   0.229657    0.202110
1    512.0   0.452200   0.434530   0.412347    0.362121
2   1024.0   0.830222   0.797166   0.731663    0.642279
3   2048.0   1.581387   1.525035   1.344298    1.187934
4   4096.0   3.085846   2.988179   2.569943    2.278361
5   8192.0   6.076303   5.881574   5.021824    4.454799
6  16384.0  12.093781  11.732697   9.909490    8.837621
7  32768.0  24.017506  23.356079  19.663456   17.535168
flao-memory-bwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C
0    256.0    142.450    159.550    168.325     159.325
1    512.0    259.000    293.200    310.525     292.525
2   1024.0    491.225    559.625    594.050     558.050
3   2048.0    957.425   1094.225   1162.850    1090.850
4   4096.0   1889.825   2163.425   2300.450    2156.450
5   8192.0   3754.625   4301.825   4575.650    4287.650
6  16384.0   7484.225   8578.625   9126.050    8550.050
7  32768.0  14943.425  17132.225  18226.850   17074.850
```

flao cache kv, qkv
```
flao-speed-fwd-batch12-head12-dim128-dim128-bf16:
         n   Lao Tor  Lao Tor C  Flao Tor  Flao Tor C
0    256.0  0.072256   0.155625  0.072397    0.107923
1    512.0  0.114733   0.124717  0.123149    0.133612
2   1024.0  0.213754   0.201766  0.201369    0.199209
3   2048.0  0.356097   0.353929  0.357516    0.353892
4   4096.0  0.659739   0.659906  0.659800    0.659820
5   8192.0  1.272027   1.271905  1.278298    1.272178
6  16384.0  2.521715   2.520809  2.526795    2.520589
7  32768.0  5.046240   5.039958  5.050101    5.045833
flao-memory-fwd-batch12-head12-dim128-dim128-bf16:
         n   Lao Tor  Lao Tor C  Flao Tor  Flao Tor C
0    256.0    75.625     75.625    75.625      75.625
1    512.0   138.625    138.625   138.625     138.625
2   1024.0   264.625    264.625   264.625     264.625
3   2048.0   516.625    516.625   516.625     516.625
4   4096.0  1020.625   1020.625  1020.625    1020.625
5   8192.0  2028.625   2028.625  2028.625    2028.625
6  16384.0  4044.625   4044.625  4044.625    4044.625
7  32768.0  8076.625   8076.625  8076.625    8076.625
flao-speed-bwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C
0    256.0   0.243181   0.235855   0.212338    0.201692
1    512.0   0.452940   0.436296   0.377593    0.362651
2   1024.0   0.830684   0.797864   0.669817    0.642544
3   2048.0   1.581372   1.525620   1.237845    1.189016
4   4096.0   3.085543   2.987959   2.370021    2.279549
5   8192.0   6.078986   5.886680   4.635602    4.451773
6  16384.0  12.084304  11.728964   9.166017    8.826856
7  32768.0  24.019535  23.368591  18.206446   17.516245
flao-memory-bwd-batch12-head12-dim128-dim128-bf16:
         n    Lao Tor  Lao Tor C   Flao Tor  Flao Tor C
0    256.0    142.450    159.550    168.325     159.325
1    512.0    259.000    293.200    310.525     292.525
2   1024.0    491.225    559.625    594.050     558.050
3   2048.0    957.425   1094.225   1162.850    1090.850
4   4096.0   1889.825   2163.425   2300.450    2156.450
5   8192.0   3754.625   4301.825   4575.650    4287.650
6  16384.0   7484.225   8578.625   9126.050    8550.050
7  32768.0  14943.425  17132.225  18226.850   17074.850
```

# Logcumsumexp benchmark

## Notation

- ptr: Parallel Triton
- rtr: Recurrence Triton
- to: Torch
- toc: Torch Compile

## A800

### Speed
```
logcumsumexp-speed-fwd-batch12-dim2048-bf16:
         n        rtr       ptr         to        toc
0    512.0   0.511852  0.062915   0.398178   0.260065
1   1024.0   0.833721  0.105678   0.689616   0.425918
2   2048.0   1.764521  0.182751   1.307949   0.837987
3   4096.0   3.839736  0.337422   2.432472   1.661094
4   8192.0   7.419119  0.648453   4.685101   3.308260
5  16384.0  14.707332  1.275111   9.200026   6.601072
6  32768.0  29.210070  2.530393  18.302219  13.181924

logcumsumexp-speed-bwd-batch12-dim2048-bf16:
         n         rtr       ptr          to        toc
0    512.0    0.786617  0.125256    2.053988   1.472460
1   1024.0    1.443604  0.242470    3.807844   2.016522
2   2048.0    2.800423  0.430138    7.399503   3.245831
3   4096.0    7.903709  0.823844   14.353551   6.113591
4   8192.0   43.404705  1.620511   28.296629  11.197360
5  16384.0  103.070686  3.210848   56.329121  21.427656
6  32768.0  231.317093  6.393496  112.513603  42.250896
```


### Memory
```
logcumsumexp-memory-fwd-batch12-dim2048-bf16:
         n          rtr          ptr           to          toc
0    512.0    48.023438    48.023438   144.011719   144.011719
1   1024.0    96.046875    96.046875   288.023438   288.023438
2   2048.0   192.093750   192.093750   576.046875   576.046875
3   4096.0   384.187500   384.187500  1152.093750  1152.093750
4   8192.0   768.375000   768.375000  2304.187500  2304.187500
5  16384.0  1536.750000  1536.750000  4608.375000  4608.375000
6  32768.0  3073.500000  3073.500000  9216.750000  9216.750000

logcumsumexp-memory-bwd-batch12-dim2048-bf16:
         n          rtr          ptr            to           toc
0    512.0   118.823437   118.823437    622.800488    310.811719
1   1024.0   237.646875   237.646875   1245.600488    621.623438
2   2048.0   475.293750   475.293750   2491.200488   1243.246875
3   4096.0   950.587500   950.587500   4982.400488   2486.493750
4   8192.0  1901.175000  1901.175000   9964.800488   4972.987500
5  16384.0  3802.350000  3802.350000  19929.600488   9945.975000
6  32768.0  7604.700000  7604.700000  39859.200488  19891.950000
```

# Logcumsumexp benchmark

## Notation

- ptr: Parallel Triton
- rtr: Recurrence Triton
- to: Torch
- toc: Torch Compile

## A800

### Speed
```
logcumsumexp-speed-fwd-batch12-dim2048-bf16:
         n        rtr         to        toc
0    512.0   0.741200   0.398367   0.269099
1   1024.0   0.987769   0.689907   0.425779
2   2048.0   1.818070   1.307665   0.838060
3   4096.0   4.037108   2.431724   1.660834
4   8192.0   7.599011   4.676806   3.305890
5  16384.0  14.722688   9.195635   6.599591
6  32768.0  29.243296  18.305637  13.183190

logcumsumexp-speed-bwd-batch12-dim2048-bf16:
         n         rtr          to        toc
0    512.0    0.787198    2.055726   1.473093
1   1024.0    1.444895    3.809001   2.016787
2   2048.0    2.733499    7.402237   3.245005
3   4096.0    7.904048   14.358971   6.114342
4   8192.0   43.235550   28.297342  11.193199
5  16384.0  102.133888   56.328960  21.448807
6  32768.0  234.968964  112.479393  42.265087
```


### Memory
```
logcumsumexp-memory-fwd-batch12-dim2048-bf16:
         n          rtr           to          toc
0    512.0    48.023438   144.011719   144.011719
1   1024.0    96.046875   288.023438   288.023438
2   2048.0   192.093750   576.046875   576.046875
3   4096.0   384.187500  1152.093750  1152.093750
4   8192.0   768.375000  2304.187500  2304.187500
5  16384.0  1536.750000  4608.375000  4608.375000
6  32768.0  3073.500000  9216.750000  9216.750000

logcumsumexp-memory-bwd-batch12-dim2048-bf16:
         n          rtr            to           toc
0    512.0   118.823437    622.800488    310.811719
1   1024.0   237.646875   1245.600488    621.623438
2   2048.0   475.293750   2491.200488   1243.246875
3   4096.0   950.587500   4982.400488   2486.493750
4   8192.0  1901.175000   9964.800488   4972.987500
5  16384.0  3802.350000  19929.600488   9945.975000
6  32768.0  7604.700000  39859.200488  19891.950000
```

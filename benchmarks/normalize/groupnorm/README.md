# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
groupnorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.115882  0.279360  0.154872
1   2048.0  0.167223  0.497620  0.143386
2   4096.0  0.273383  0.930864  0.148351
3   8192.0  0.165521  1.797672  0.291887
4  16384.0  0.322972  3.531130  0.578585
5  32768.0  0.637427  6.998955  1.152947

groupnorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  0.556715   0.576612  0.277936
1   2048.0  0.299561   1.058078  0.319968
2   4096.0  0.470806   1.995467  1.093508
3   8192.0  0.663096   3.865999  0.633416
4  16384.0  1.282922   7.606192  1.237326
5  32768.0  2.532886  15.108422  2.445753
```

#### Memory

```
groupnorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    48.128906   208.136719    48.128906
1   2048.0    96.253906   416.261719    96.253906
2   4096.0   192.503906   832.511719   192.503906
3   8192.0   385.003906  1665.011719   385.003906
4  16384.0   770.003906  3330.011719   770.003906
5  32768.0  1540.003906  6660.011719  1540.003906

groupnorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   206.540918    350.548730   126.536523
1   2048.0   413.065918    701.073730   253.061523
2   4096.0   702.115918   1402.123242   506.111523
3   8192.0  1272.215918   2804.223242  1012.211523
4  16384.0  2412.415918   5608.423242  2024.411523
5  32768.0  4692.815918  11216.823242  4048.811523
```

### Without Residual

#### Speed
```
groupnorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.156422  0.206153  0.110453
1   2048.0  0.095018  0.372176  0.111236
2   4096.0  0.095873  0.689766  0.127821
3   8192.0  0.164566  1.326936  0.250035
4  16384.0  0.321504  2.602935  0.496427
5  32768.0  0.637162  5.152259  0.988201

groupnorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  0.289830   0.529794  1.471597
1   2048.0  1.135514   1.557187  1.587708
2   4096.0  0.463290   1.822407  1.409782
3   8192.0  0.489692   3.533978  0.548949
4  16384.0  0.937115   6.951653  1.427922
5  32768.0  1.845611  13.800781  2.107427
```

#### Memory
```
groupnorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.128906   160.136719    32.128906
1   2048.0    64.253906   320.261719    64.253906
2   4096.0   128.503906   640.511719   128.503906
3   8192.0   257.003906  1281.011719   257.003906
4  16384.0   514.003906  2562.011719   514.003906
5  32768.0  1028.003906  5124.011719  1028.003906

groupnorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.340918    319.348730    79.461523
1   2048.0   350.665918    638.673730   158.911523
2   4096.0   577.315918   1277.323242   317.811523
3   8192.0  1022.615918   2554.623242   635.611523
4  16384.0  1913.215918   5109.223242  1271.211523
5  32768.0  3694.415918  10218.423242  2542.411523
```

# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
groupnorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.110949  0.297911  0.119105
1   2048.0  0.113864  0.546137  0.124432
2   4096.0  0.118820  1.029260  0.172285
3   8192.0  0.198721  1.993117  0.338473
4  16384.0  0.391161  3.918388  0.671853
5  32768.0  0.770317  7.773650  1.342445

groupnorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  0.378744   0.572339  0.325829
1   2048.0  0.292114   1.058449  1.391598
2   4096.0  0.416392   1.992677  0.778046
3   8192.0  0.788342   3.868411  0.918402
4  16384.0  1.531082   7.608359  1.801654
5  32768.0  3.025172  15.106875  3.566725
```

#### Memory

```
groupnorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    64.128906   176.136719    64.128906
1   2048.0   128.253906   352.261719   128.253906
2   4096.0   256.503906   704.511719   256.503906
3   8192.0   513.003906  1409.011719   513.003906
4  16384.0  1026.003906  2818.011719  1026.003906
5  32768.0  2052.003906  5636.011719  2052.003906

groupnorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   222.540918    350.548730   142.661523
1   2048.0   445.065918    701.073730   285.311523
2   4096.0   766.115918   1402.123242   570.611523
3   8192.0  1400.215918   2804.223242  1141.211523
4  16384.0  2668.415918   5608.423242  2282.411523
5  32768.0  5204.815918  11216.823242  4564.811523
```

### Without Residual

#### Speed
```
groupnorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.095308  0.204336  0.584040
1   2048.0  0.099161  0.391515  0.112008
2   4096.0  0.103719  0.688376  0.126799
3   8192.0  0.163315  1.326641  0.249056
4  16384.0  0.320713  2.601168  0.495226
5  32768.0  0.635886  5.150964  0.986981

groupnorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  0.264018   0.526687  0.248190
1   2048.0  0.294642   0.967432  0.648459
2   4096.0  0.264649   1.824363  0.421140
3   8192.0  0.488545   3.535242  0.549308
4  16384.0  0.937156   6.956839  1.068788
5  32768.0  1.842549  13.799456  2.107324
```

#### Memory
```
groupnorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.128906   160.136719    32.128906
1   2048.0    64.253906   320.261719    64.253906
2   4096.0   128.503906   640.511719   128.503906
3   8192.0   257.003906  1281.011719   257.003906
4  16384.0   514.003906  2562.011719   514.003906
5  32768.0  1028.003906  5124.011719  1028.003906

groupnorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.340918    319.348730    79.461523
1   2048.0   350.665918    638.673730   158.911523
2   4096.0   577.315918   1277.323242   317.811523
3   8192.0  1022.615918   2554.623242   635.611523
4  16384.0  1913.215918   5109.223242  1271.211523
5  32768.0  3694.415918  10218.423242  2542.411523
```

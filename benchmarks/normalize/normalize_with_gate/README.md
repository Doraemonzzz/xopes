# normalize with gate benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile


## A800

#### Speed
```
normalize_gate-speed-fwd-batch4-dim2048-gate_act_sigmoid-gate_pos_pre-bf16:
         n        tr         to       toc
0   1024.0  0.042542   0.388313  0.049002
1   2048.0  0.073386   0.736646  0.078176
2   4096.0  0.126838   1.383066  0.141949
3   8192.0  0.238417   2.696698  0.271430
4  16384.0  0.461903   5.329088  0.529476
5  32768.0  0.910122  10.594617  1.045549

normalize_gate-speed-bwd-batch4-dim2048-gate_act_sigmoid-gate_pos_pre-bf16:
         n        tr         to       toc
0   1024.0  0.210543   1.042091  0.184833
1   2048.0  0.340428   1.947126  0.329484
2   4096.0  0.631507   3.728548  0.617476
3   8192.0  1.206535   7.299247  1.195150
4  16384.0  2.360725  14.474880  2.348614
5  32768.0  4.669942  28.775787  4.641699

normalize_gate-speed-fwd-batch4-dim2048-gate_act_sigmoid-gate_pos_post-bf16:
         n        tr        to       toc
0   1024.0  0.044515  0.359834  0.043100
1   2048.0  0.073246  0.668332  0.076129
2   4096.0  0.130531  1.266890  0.140377
3   8192.0  0.246752  2.466823  0.271884
4  16384.0  0.476814  4.866336  0.530410
5  32768.0  0.935972  9.683386  1.047911

normalize_gate-speed-bwd-batch4-dim2048-gate_act_sigmoid-gate_pos_post-bf16:
         n        tr         to       toc
0   1024.0  0.199062   0.953759  0.179531
1   2048.0  0.340960   1.773841  0.320271
2   4096.0  0.632243   3.387890  0.603519
3   8192.0  1.206354   6.617026  1.167551
4  16384.0  2.362667  13.109121  2.297363
5  32768.0  4.672061  26.050720  4.523605
```

#### Memory
```
normalize_gate-memory-fwd-batch4-dim2048-gate_act_sigmoid-gate_pos_pre-bf16:
         n           tr           to          toc
0   1024.0    48.019531   224.027344    48.019531
1   2048.0    96.035156   448.042969    96.035156
2   4096.0   192.066406   896.074219   192.066406
3   8192.0   384.128906  1792.136719   384.128906
4  16384.0   768.253906  3584.261719   768.253906
5  32768.0  1536.503906  7168.511719  1536.503906

normalize_gate-memory-bwd-batch4-dim2048-gate_act_sigmoid-gate_pos_pre-bf16:
         n           tr            to          toc
0   1024.0   222.431543    398.439355   126.427148
1   2048.0   424.847168    796.854492   252.842773
2   4096.0   741.678418   1593.685742   505.674023
3   8192.0  1375.340918   3187.348242  1011.336523
4  16384.0  2642.665918   6374.673242  2022.661523
5  32768.0  5197.315918  12749.323242  4045.311523

normalize_gate-memory-fwd-batch4-dim2048-gate_act_sigmoid-gate_pos_post-bf16:
         n           tr           to          toc
0   1024.0    48.019531   192.027344    48.019531
1   2048.0    96.035156   384.042969    96.035156
2   4096.0   192.066406   768.074219   192.066406
3   8192.0   384.128906  1536.136719   384.128906
4  16384.0   768.253906  3072.261719   768.253906
5  32768.0  1536.503906  6144.511719  1536.503906

normalize_gate-memory-bwd-batch4-dim2048-gate_act_sigmoid-gate_pos_post-bf16:
         n           tr            to          toc
0   1024.0   222.431543    398.439355   126.427148
1   2048.0   424.847168    796.854492   252.842773
2   4096.0   741.678418   1593.685742   505.674023
3   8192.0  1375.340918   3187.348242  1011.336523
4  16384.0  2642.665918   6374.673242  2022.661523
5  32768.0  5197.315918  12749.323242  4045.311523
```

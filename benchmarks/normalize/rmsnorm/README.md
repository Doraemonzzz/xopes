# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
rmsnorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.116634  0.299639  0.102510
1   2048.0  0.111128  0.543029  0.109759
2   4096.0  0.124552  1.032004  0.136676
3   8192.0  0.183907  1.993644  0.186259
4  16384.0  0.359147  3.921083  0.386498
5  32768.0  0.712224  7.773790  0.736155

rmsnorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  0.427492   0.575484  0.288977
1   2048.0  0.276938   1.059161  0.427536
2   4096.0  0.409771   2.008573  0.393492
3   8192.0  0.774997   3.888964  0.755377
4  16384.0  1.500213   7.649813  1.477798
5  32768.0  2.963334  15.185557  2.926050
```

#### Memory

```
rmsnorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    64.019531   176.027344    64.019531
1   2048.0   128.035156   352.042969   128.035156
2   4096.0   256.066406   704.074219   256.066406
3   8192.0   512.128906  1408.136719   512.128906
4  16384.0  1024.253906  2816.261719  1024.253906
5  32768.0  2048.503906  5632.511719  2048.503906

rmsnorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   222.431543    350.439355   142.427148
1   2048.0   444.847168    700.854980   284.842773
2   4096.0   765.678418   1401.685742   569.674023
3   8192.0  1399.340918   2803.348242  1139.336523
4  16384.0  2666.665918   5606.673242  2278.661523
5  32768.0  5201.315918  11213.323242  4557.311523
```

### Without Residual

#### Speed
```
rmsnorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.123013  0.202869  0.199637
1   2048.0  0.143409  0.364317  0.100876
2   4096.0  0.172081  0.689282  0.132183
3   8192.0  0.160203  1.328508  0.122142
4  16384.0  0.183348  2.602735  0.220893
5  32768.0  0.358021  5.151884  0.438382

rmsnorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  0.363083   0.709600  1.064046
1   2048.0  1.043242   0.971448  0.298054
2   4096.0  0.431388   1.835622  0.484490
3   8192.0  0.579326   3.553765  0.398591
4  16384.0  0.916832   6.994567  0.770075
5  32768.0  1.798413  13.881783  1.513935
```

#### Memory
```
rmsnorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.019531   160.027344    32.019531
1   2048.0    64.035156   320.042969    64.035156
2   4096.0   128.066406   640.074219   128.066406
3   8192.0   256.128906  1280.136719   256.128906
4  16384.0   512.253906  2560.261719   512.253906
5  32768.0  1024.503906  5120.511719  1024.503906

rmsnorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.231543    319.239355    79.227148
1   2048.0   350.447168    638.454980   158.442773
2   4096.0   576.878418   1276.885742   316.874023
3   8192.0  1021.740918   2553.748242   633.736523
4  16384.0  1911.465918   5107.473242  1267.461523
5  32768.0  3690.915918  10214.923242  2534.911523
```

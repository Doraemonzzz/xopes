# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
rmsnorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.090959  0.269990  0.077525
1   2048.0  0.108455  0.489816  0.091589
2   4096.0  0.096349  0.929556  0.131847
3   8192.0  0.138979  1.797131  0.148986
4  16384.0  0.267941  3.529851  0.288692
5  32768.0  0.526919  6.995392  0.566699

rmsnorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  1.407855   1.708030  1.588914
1   2048.0  1.766971   1.839537  1.616378
2   4096.0  1.674510   2.010725  1.055278
3   8192.0  0.651961   3.886060  0.633315
4  16384.0  1.606935   7.649101  1.655847
5  32768.0  2.482860  15.181770  2.449396
```

#### Memory

```
rmsnorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    48.019531   208.027344    48.019531
1   2048.0    96.035156   416.042969    96.035156
2   4096.0   192.066406   832.074219   192.066406
3   8192.0   384.128906  1664.136719   384.128906
4  16384.0   768.253906  3328.261719   768.253906
5  32768.0  1536.503906  6656.511719  1536.503906

rmsnorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   206.431543    350.439355   126.427148
1   2048.0   412.847168    700.854980   252.842773
2   4096.0   701.678418   1401.685742   505.674023
3   8192.0  1271.340918   2803.348242  1011.336523
4  16384.0  2410.665918   5606.673242  2022.661523
5  32768.0  4689.315918  11213.323242  4045.311523
```

### Without Residual

#### Speed
```
rmsnorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.085429  0.202474  0.089491
1   2048.0  0.090629  0.364639  0.084363
2   4096.0  0.094609  0.689033  0.084208
3   8192.0  0.096048  1.326909  0.135236
4  16384.0  0.183904  2.602162  0.221128
5  32768.0  0.359772  5.149713  0.437300

rmsnorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  0.363145   0.530990  0.570361
1   2048.0  0.362484   0.969521  0.685226
2   4096.0  0.400734   1.836118  0.504540
3   8192.0  0.476750   3.557217  0.751100
4  16384.0  0.915593   6.990032  0.769190
5  32768.0  1.796255  13.879483  1.513319
```

#### Memory
```
rmsnorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.019531   160.027344    32.019531
1   2048.0    64.035156   320.042969    64.035156
2   4096.0   128.066406   640.074219   128.066406
3   8192.0   256.128906  1280.136719   256.128906
4  16384.0   512.253906  2560.261719   512.253906
5  32768.0  1024.503906  5120.511719  1024.503906

rmsnorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.231543    319.239355    79.227148
1   2048.0   350.447168    638.454980   158.442773
2   4096.0   576.878418   1276.885742   316.874023
3   8192.0  1021.740918   2553.748242   633.736523
4  16384.0  1911.465918   5107.473242  1267.461523
5  32768.0  3690.915918  10214.923242  2534.911523
```

# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
srmsnorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.096420  0.297080  0.115159
1   2048.0  0.106431  0.540180  0.092128
2   4096.0  0.101484  1.030691  0.098893
3   8192.0  0.183317  1.994981  0.186239
4  16384.0  0.359091  3.919346  0.366251
5  32768.0  0.712190  7.773457  0.736067

srmsnorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  0.253020   0.576309  0.353465
1   2048.0  0.367085   1.059402  1.326487
2   4096.0  0.885712   2.005155  1.054652
3   8192.0  1.048022   3.887980  1.039225
4  16384.0  1.499560   7.648019  1.478634
5  32768.0  2.961084  15.185969  2.926995
```

#### Memory

```
srmsnorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    64.019531   176.027344    64.019531
1   2048.0   128.035156   352.042969   128.035156
2   4096.0   256.066406   704.074219   256.066406
3   8192.0   512.128906  1408.136719   512.128906
4  16384.0  1024.253906  2816.261719  1024.253906
5  32768.0  2048.503906  5632.511719  2048.503906

srmsnorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   222.431543    350.439355   142.427148
1   2048.0   444.847168    700.854980   284.842773
2   4096.0   765.678418   1401.685742   569.674023
3   8192.0  1399.340918   2803.348242  1139.336523
4  16384.0  2666.665918   5606.673242  2278.661523
5  32768.0  5201.315918  11213.323242  4557.311523
```

### Without Residual

#### Speed

```
srmsnorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.090081  0.202868  0.086659
1   2048.0  0.092968  0.364210  0.078910
2   4096.0  0.090776  0.689289  0.077994
3   8192.0  0.095393  1.327548  0.116494
4  16384.0  0.183998  2.602564  0.221840
5  32768.0  0.360302  5.151229  0.438853

srmsnorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  0.317020   0.535485  0.361692
1   2048.0  1.243028   0.977156  0.568371
2   4096.0  0.835774   1.838463  0.874402
3   8192.0  0.793629   3.559573  0.982376
4  16384.0  0.919144   6.993573  0.770682
5  32768.0  1.797057  13.886966  1.514043
```

#### Memory

```
srmsnorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.019531   160.027344    32.019531
1   2048.0    64.035156   320.042969    64.035156
2   4096.0   128.066406   640.074219   128.066406
3   8192.0   256.128906  1280.136719   256.128906
4  16384.0   512.253906  2560.261719   512.253906
5  32768.0  1024.503906  5120.511719  1024.503906

srmsnorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.231543    319.239355    79.227148
1   2048.0   350.447168    638.454980   158.442773
2   4096.0   576.878418   1276.885742   316.874023
3   8192.0  1021.740918   2553.748242   633.736523
4  16384.0  1911.465918   5107.473242  1267.461523
5  32768.0  3690.915918  10214.923242  2534.911523
```

# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
srmsnorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.102271  0.272384  0.111524
1   2048.0  0.127273  0.491273  0.110110
2   4096.0  0.134264  0.931663  0.149300
3   8192.0  0.138995  1.799033  0.152082
4  16384.0  0.267731  3.531434  0.288647
5  32768.0  0.527179  6.999583  0.567478

srmsnorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  1.451156   1.842537  1.715699
1   2048.0  0.387699   1.068563  1.653843
2   4096.0  1.417704   2.013385  1.350544
3   8192.0  0.653282   3.895372  0.933861
4  16384.0  1.466203   7.651667  1.767398
5  32768.0  2.481997  15.186736  2.448696
```

#### Memory

```
srmsnorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    48.019531   208.027344    48.019531
1   2048.0    96.035156   416.042969    96.035156
2   4096.0   192.066406   832.074219   192.066406
3   8192.0   384.128906  1664.136719   384.128906
4  16384.0   768.253906  3328.261719   768.253906
5  32768.0  1536.503906  6656.511719  1536.503906

srmsnorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   206.431543    350.439355   126.427148
1   2048.0   412.847168    700.854980   252.842773
2   4096.0   701.678418   1401.685742   505.674023
3   8192.0  1271.340918   2803.348242  1011.336523
4  16384.0  2410.665918   5606.673242  2022.661523
5  32768.0  4689.315918  11213.323242  4045.311523
```

### Without Residual

#### Speed

```
srmsnorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.094720  0.203414  0.090494
1   2048.0  0.093923  0.365345  0.089025
2   4096.0  0.105239  0.690465  0.088920
3   8192.0  0.128207  1.329770  0.122730
4  16384.0  0.184509  2.605536  0.221985
5  32768.0  0.358641  5.154883  0.437655

srmsnorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  1.155290   1.495470  1.153067
1   2048.0  0.958755   0.975856  1.557188
2   4096.0  0.533315   1.844731  1.667267
3   8192.0  1.116695   3.558787  1.160058
4  16384.0  1.085172   7.000081  1.668720
5  32768.0  1.800827  13.887475  1.516340
```

#### Memory

```
srmsnorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.019531   160.027344    32.019531
1   2048.0    64.035156   320.042969    64.035156
2   4096.0   128.066406   640.074219   128.066406
3   8192.0   256.128906  1280.136719   256.128906
4  16384.0   512.253906  2560.261719   512.253906
5  32768.0  1024.503906  5120.511719  1024.503906

srmsnorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.231543    319.239355    79.227148
1   2048.0   350.447168    638.454980   158.442773
2   4096.0   576.878418   1276.885742   316.874023
3   8192.0  1021.740918   2553.748242   633.736523
4  16384.0  1911.465918   5107.473242  1267.461523
5  32768.0  3690.915918  10214.923242  2534.911523
```

# SRMSNORM benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### With Residual

#### Speed

```
layernorm-speed-fwd-batch4-dim2048-use_residual_True-bf16:
         n        tr        to       toc
0   1024.0  0.096946  0.313247  0.095849
1   2048.0  0.096711  0.574231  0.125273
2   4096.0  0.119447  1.099684  0.097250
3   8192.0  0.138210  2.120900  0.165307
4  16384.0  0.290699  4.164017  0.320401
5  32768.0  0.527197  8.251933  0.630438

layernorm-speed-bwd-batch4-dim2048-use_residual_True-bf16:
         n        tr         to       toc
0   1024.0  0.398486   0.674730  0.300272
1   2048.0  0.296798   1.298845  0.263274
2   4096.0  0.355363   2.372119  0.383586
3   8192.0  0.650953   4.591711  0.733161
4  16384.0  1.259168   9.030915  1.432520
5  32768.0  2.483439  17.904736  2.837049
```

#### Memory

```
layernorm-memory-fwd-batch4-dim2048-use_residual_True-bf16:
         n           tr           to          toc
0   1024.0    48.035156   240.027344    48.035156
1   2048.0    96.066406   480.042969    96.066406
2   4096.0   192.128906   960.074219   192.128906
3   8192.0   384.253906  1920.136719   384.253906
4  16384.0   768.503906  3840.261719   768.503906
5  32768.0  1537.003906  7680.511719  1537.003906

layernorm-memory-bwd-batch4-dim2048-use_residual_True-bf16:
         n           tr            to          toc
0   1024.0   206.447168    350.439355   158.442773
1   2048.0   412.878418    700.854980   316.874023
2   4096.0   701.740918   1401.685742   633.736523
3   8192.0  1271.465918   2803.348242  1267.461523
4  16384.0  2410.915918   5606.673242  2534.911523
5  32768.0  4689.815918  11213.323242  5069.811523
```

### Without Residual

#### Speed
```
layernorm-speed-fwd-batch4-dim2048-use_residual_False-bf16:
         n        tr        to       toc
0   1024.0  0.101410  0.246268  0.088555
1   2048.0  0.126292  0.448274  0.107445
2   4096.0  0.107998  0.859774  0.101067
3   8192.0  0.096932  1.653985  0.137270
4  16384.0  0.184605  3.240908  0.266676
5  32768.0  0.360543  6.406848  0.526089

layernorm-speed-bwd-batch4-dim2048-use_residual_False-bf16:
         n        tr         to       toc
0   1024.0  0.327710   0.632886  0.279899
1   2048.0  0.294413   1.164881  0.329974
2   4096.0  0.427202   2.202917  0.392265
3   8192.0  0.476730   4.261303  0.490143
4  16384.0  0.916981   8.376998  0.951991
5  32768.0  1.796492  16.621780  1.875837
```

#### Memory
```
layernorm-memory-fwd-batch4-dim2048-use_residual_False-bf16:
         n           tr           to          toc
0   1024.0    32.035156   192.027344    32.035156
1   2048.0    64.066406   384.042969    64.066406
2   4096.0   128.128906   768.074219   128.128906
3   8192.0   256.253906  1536.136719   256.253906
4  16384.0   512.503906  3072.261719   512.503906
5  32768.0  1025.003906  6144.511719  1025.003906

layernorm-memory-bwd-batch4-dim2048-use_residual_False-bf16:
         n           tr            to          toc
0   1024.0   175.247168    319.239355   111.242773
1   2048.0   350.478418    638.454980   222.474023
2   4096.0   576.940918   1276.885742   444.936523
3   8192.0  1021.865918   2553.748242   889.861523
4  16384.0  1911.715918   5107.473242  1779.711523
5  32768.0  3691.415918  10214.923242  3559.411523
```

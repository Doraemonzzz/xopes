# A800

$-1$ indicate error.

## Head dim = 128

1d version, sequence length is $n$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-1d:
         n    Triton  Triton Parallel      Torch   Torch C
0    256.0  0.221373         0.231003   0.367722  0.213542
1    512.0  0.249563         0.251046   0.537233  0.282405
2   1024.0  0.316635         0.305018   0.870772  0.453128
3   2048.0  0.432811         0.454257   1.649271  0.700093
4   4096.0  0.677204         0.674025   3.138505  1.307406
5   8192.0  1.160888         1.154330   6.124140  2.383536
6  16384.0  2.131533         2.151184  12.115060  4.634585
7  32768.0  4.050735         4.047791  24.017799  9.192899

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-1d:
         n       Triton  Triton Parallel         Torch      Torch C
0    256.0    27.019043        27.019043     87.022949    28.520996
1    512.0    54.019043        54.019043    174.026855    57.022949
2   1024.0   108.019043       108.019043    348.034668   114.026855
3   2048.0   216.019043       216.019043    696.050293   228.034668
4   4096.0   432.019043       432.019043   1392.081543   456.050293
5   8192.0   864.019043       864.019043   2784.144043   912.081543
6  16384.0  1728.019043      1728.019043   5568.269043  1824.144043
7  32768.0  3456.019043      3456.019043  11136.519043  3648.269043

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-1d:
         n    Triton  Triton Parallel      Torch   Torch C
0    256.0  0.203554         0.223099   0.196762  0.050094
1    512.0  0.237193         0.231823   0.388063  0.091007
2   1024.0  0.323795         0.323161   0.743632  0.168363
3   2048.0  0.514483         0.524152   1.569310  0.351721
4   4096.0  0.892379         0.887537   3.101379  0.712085
5   8192.0  1.635485         1.635932   6.163072  1.406749
6  16384.0  3.137159         3.114161  12.315656  2.796560
7  32768.0  6.119983         6.130452  24.649153  5.615482

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-1d:
         n       Triton  Triton Parallel         Torch      Torch C
0    256.0    62.569043        62.569043    128.568555    64.068555
1    512.0   125.119043       125.119043    257.118555   128.118555
2   1024.0   250.219043       250.219043    514.218555   256.218555
3   2048.0   500.419043       500.419043   1028.418555   512.418555
4   4096.0  1000.819043      1000.819043   2056.818555  1024.818555
5   8192.0  2001.619043      2001.619043   4113.618555  2049.618555
6  16384.0  4003.219043      4003.219043   8227.218555  4099.218555
7  32768.0  8006.419043      8006.419043  16454.418555  8198.418555
```

2d version, sequence length is $n^2$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-2d:
       n    Triton  Triton Parallel      Torch   Torch C
0   16.0  0.232339         0.260326   0.420023  0.233001
1   32.0  0.377466         0.413707   0.935225  0.426393
2   64.0  0.840004         1.073485   3.169399  1.251352
3  128.0  2.779727         3.709185  12.155503  4.251244

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-2d:
       n       Triton  Triton Parallel        Torch      Torch C
0   16.0    27.003906        27.003906    87.008789    28.504883
1   32.0   108.003906       108.003906   348.020508   114.004883
2   64.0   432.003906       432.003906  1392.067383   456.004883
3  128.0  1728.003906      1728.003906  5568.255859  1824.005859

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-2d:
       n    Triton  Triton Parallel      Torch   Torch C
0   16.0  0.203885         0.240160   0.195645  0.066655
1   32.0  0.403110         0.479020   0.749226  0.168205
2   64.0  1.043038         1.310285   3.101608  0.712502
3  128.0  3.692823         4.688085  12.316675  2.794647

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-2d:
       n       Triton  Triton Parallel        Torch      Torch C
0   16.0    62.553906        62.553906   128.553418    64.053418
1   32.0   250.203906       250.203906   514.203418   256.203418
2   64.0  1000.803906      1000.803906  2056.803418  1024.803418
3  128.0  4003.203906      4003.203906  8227.203418  4099.203418
```

3d version, sequence length is $n^3$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-3d:
      n    Triton  Triton Parallel      Torch   Torch C
0   4.0  0.247715         0.225334   0.378192  0.262701
1   8.0  0.319300         0.368234   0.651914  0.340065
2  16.0  1.199040         1.632814   3.269975  1.714615
3  32.0  8.049224        -1.000000  24.668055  9.473375

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-3d:
      n       Triton  Triton Parallel         Torch      Torch C
0   4.0  3462.755859       179.554004     22.131836     7.317871
1   8.0    54.003906        54.003906    177.517090    58.505371
2  16.0   432.003906       432.003906   1416.099121   468.005371
3  32.0  3456.003906        -1.000000  14784.757324  7200.007324

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-3d:
      n    Triton  Triton Parallel      Torch   Torch C
0   4.0  0.228487         0.230145   0.062538  0.079790
1   8.0  0.294703         0.355167   0.387055  0.099478
2  16.0  1.428038         1.841558   3.100744  0.756024
3  32.0  9.994959        -1.000000  24.654247  5.909690

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-3d:
      n       Triton  Triton Parallel         Torch       Torch C
0   4.0  3471.643359        15.641406     32.140918     16.203418
1   8.0   125.103906       125.103906    257.103418    129.603418
2  16.0  1000.803906      1000.803906   2056.803418   1036.803418
3  32.0  8006.403906        -1.000000  19910.405371  11750.405371
```

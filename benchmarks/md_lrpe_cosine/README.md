# A800

## Head dim = 128

1d version, sequence length is $n$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-1d:
         n    Triton  Triton Parallel      Torch
0    256.0  0.231516         0.238690   0.475592
1    512.0  0.275970         0.276445   0.637077
2   1024.0  0.349464         0.352839   0.982053
3   2048.0  0.493667         0.517485   1.726173
4   4096.0  0.851289         0.826090   3.289875
5   8192.0  1.469120         1.514158   6.391710
6  16384.0  2.786028         2.745900  12.589322
7  32768.0  5.369411         5.307384  25.058420

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-1d:
         n       Triton  Triton Parallel         Torch
0    256.0    27.003418        27.003418     87.008301
1    512.0    54.003418        54.003418    174.013184
2   1024.0   108.003418       108.003418    348.022949
3   2048.0   216.003418       216.003418    696.042480
4   4096.0   432.003418       432.003418   1392.081543
5   8192.0   864.003418       864.003418   2784.159668
6  16384.0  1728.003418      1728.003418   5568.315918
7  32768.0  3456.003418      3456.003418  11136.628418

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-1d:
         n    Triton  Triton Parallel      Torch
0    256.0  0.182138         0.193671   0.222626
1    512.0  0.242275         0.263009   0.397259
2   1024.0  0.352856         0.399211   0.744859
3   2048.0  0.586946         0.622779   1.665115
4   4096.0  1.049618         1.058523   3.080746
5   8192.0  1.941292         1.952024   6.123446
6  16384.0  3.775023         3.761609  12.232484
7  32768.0  7.494728         7.409093  24.477150

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-1d:
         n       Triton  Triton Parallel        Torch
0    256.0    62.553418        62.553418    128.55293
1    512.0   125.103418       125.103418    257.10293
2   1024.0   250.203418       250.203418    514.20293
3   2048.0   500.403418       500.403418   1028.40293
4   4096.0  1000.803418      1000.803418   2056.80293
5   8192.0  2001.603418      2001.603418   4113.60293
6  16384.0  4003.203418      4003.203418   8227.20293
7  32768.0  8006.403418      8006.403418  16454.40293
```

2d version, sequence length is $n^2$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-2d:
       n    Triton  Triton Parallel      Torch
0   16.0  0.271877         0.324302   0.481283
1   32.0  0.480977         0.612207   0.987617
2   64.0  1.423262         1.866514   3.199325
3  128.0  5.198555         6.900781  12.048532

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-2d:
       n       Triton  Triton Parallel        Torch
0   16.0    27.001953        27.001953    87.007812
1   32.0   108.001953       108.001953   348.022461
2   64.0   432.001953       432.001953  1392.081055
3  128.0  1728.001953      1728.001953  5568.316406

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-2d:
       n    Triton  Triton Parallel      Torch
0   16.0  0.221431         0.256794   0.195821
1   32.0  0.505737         0.627548   0.739389
2   64.0  1.639761         2.052933   3.080696
3  128.0  6.142434         7.766619  12.231069

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-2d:
       n       Triton  Triton Parallel        Torch
0   16.0    62.551953        62.551953   128.551465
1   32.0   250.201953       250.201953   514.201465
2   64.0  1000.801953      1000.801953  2056.801465
3  128.0  4003.201953      4003.201953  8227.201465
```

3d version, sequence length is $n^3$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-3d:
      n     Triton      Torch
0   4.0   0.205550   0.411757
1   8.0   0.486381   0.753872
2  16.0   2.124623   3.299589
3  32.0  15.727946  24.246519

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-3d:
      n       Triton         Torch
0   4.0     6.751953     22.130371
1   8.0    54.001953    177.517090
2  16.0   432.001953   1416.112793
3  32.0  3456.001953  11328.878418

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-3d:
      n     Triton      Torch
0   4.0   0.210388   0.062451
1   8.0   0.404273   0.384454
2  16.0   2.413144   3.080609
3  32.0  17.940943  24.483002

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-3d:
      n       Triton         Torch
0   4.0    15.639453     32.138965
1   8.0   125.101953    257.101465
2  16.0  1000.801953   2056.801465
3  32.0  8006.401953  16454.401465
```

memory error in parallel
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-3d:
      n    Triton  Triton Parallel     Torch
0   4.0  0.206522         0.235664  0.461471
1   8.0  0.473021         0.618126  0.743278
2  16.0  2.114492         3.029075  3.293248

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-3d:
      n      Triton  Triton Parallel        Torch
0   4.0    6.751953         6.751953    22.130371
1   8.0   54.001953        54.001953   177.517090
2  16.0  432.001953       432.001953  1416.112793

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-3d:
      n    Triton  Triton Parallel     Torch
0   4.0  0.204471         0.190068  0.061641
1   8.0  0.419982         0.513809  0.385325
2  16.0  2.365662         3.214803  3.079358

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-3d:
      n       Triton  Triton Parallel        Torch
0   4.0    15.639453        15.639453    32.138965
1   8.0   125.101953       125.101953   257.101465
2  16.0  1000.801953      1000.801953  2056.801465
```

# A800

$-1$ indicate error.

## Head dim = 128

1d version, sequence length is $n$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-1d:
         n    Triton  Triton Parallel      Torch
0    256.0  0.216524         0.238535   0.371972
1    512.0  0.330585         0.247801   0.532420
2   1024.0  0.346994         0.347889   0.920117
3   2048.0  0.433057         0.427185   1.621067
4   4096.0  0.688628         0.671084   3.129839
5   8192.0  1.146662         1.151227   6.104144
6  16384.0  2.140335         2.100951  12.084320
7  32768.0  4.062366         4.019097  23.995632

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-1d:
         n       Triton  Triton Parallel         Torch
0    256.0    27.003418        27.003418     87.007324
1    512.0    54.003418        54.003418    174.011230
2   1024.0   108.003418       108.003418    348.019043
3   2048.0   216.003418       216.003418    696.034668
4   4096.0   432.003418       432.003418   1392.065918
5   8192.0   864.003418       864.003418   2784.128418
6  16384.0  1728.003418      1728.003418   5568.253418
7  32768.0  3456.003418      3456.003418  11136.503418

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-1d:
         n    Triton  Triton Parallel      Torch
0    256.0  0.214621         0.240581   0.195375
1    512.0  0.236267         0.234536   0.386439
2   1024.0  0.322205         0.344102   0.742761
3   2048.0  0.516051         0.520216   1.568813
4   4096.0  0.897482         0.910347   3.100045
5   8192.0  1.662639         1.636020   6.162770
6  16384.0  3.131797         3.114803  12.312876
7  32768.0  6.118351         6.069544  24.637640

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-1d:
         n       Triton  Triton Parallel        Torch
0    256.0    62.553418        62.553418    128.55293
1    512.0   125.103418       125.103418    257.10293
2   1024.0   250.203418       250.203418    514.20293
3   2048.0   500.403418       500.403418   1028.40293
4   4096.0  1000.803418      1000.803418   2056.80293
5   8192.0  2001.603418      2001.603418   4113.60293
6  16384.0  4003.203418      4003.203418   8227.20293
7  32768.0  8006.403418      8006.403418  16454.40293
```

2d version, sequence length is $n^2$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-2d:
       n    Triton  Triton Parallel      Torch
0   16.0  0.226035         0.245887   0.414533
1   32.0  0.364985         0.408490   0.927217
2   64.0  0.831034         1.073793   3.166168
3  128.0  2.754343         3.696024  12.137808

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-2d:
       n       Triton  Triton Parallel        Torch
0   16.0    27.001953        27.001953    87.006836
1   32.0   108.001953       108.001953   348.018555
2   64.0   432.001953       432.001953  1392.065430
3  128.0  1728.001953      1728.001953  5568.253906

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-2d:
       n    Triton  Triton Parallel      Torch
0   16.0  0.212018         0.214576   0.195256
1   32.0  0.372531         0.432952   0.743782
2   64.0  1.035165         1.273208   3.099793
3  128.0  3.689028         4.739532  12.312301

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-2d:
       n       Triton  Triton Parallel        Torch
0   16.0    62.551953        62.551953   128.551465
1   32.0   250.201953       250.201953   514.201465
2   64.0  1000.801953      1000.801953  2056.801465
3  128.0  4003.201953      4003.201953  8227.201465
```

3d version, sequence length is $n^3$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-3d:
      n    Triton  Triton Parallel      Torch
0   4.0  0.228756         0.221379   0.367084
1   8.0  0.308897         0.368143   0.662218
2  16.0  1.184863         1.612162   3.276602
3  32.0  8.043883        -1.000000  24.634319

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-3d:
      n       Triton  Triton Parallel         Torch
0   4.0  3462.753906       179.552051     22.129883
1   8.0    54.001953        54.001953    177.515137
2  16.0   432.001953       432.001953   1416.097168
3  32.0  3456.001953        -1.000000  14784.755371

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-3d:
      n    Triton  Triton Parallel      Torch
0   4.0  0.232514         0.203495   0.062366
1   8.0  0.295140         0.345439   0.386899
2  16.0  1.377704         1.825245   3.100084
3  32.0  9.991648        -1.000000  24.646008

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-3d:
      n       Triton  Triton Parallel         Torch
0   4.0  3471.641406        15.639453     32.138965
1   8.0   125.101953       125.101953    257.101465
2  16.0  1000.801953      1000.801953   2056.801465
3  32.0  8006.401953        -1.000000  19910.403418
```

# Gate Linear Benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Residual = True

#### Speed

```
gate_linear-speed-fwd-d1_4096-silu-bias_False-residual_True-bf16:
        b        tr        to       toc
0   256.0  0.106157  0.056251  0.084638
1   512.0  0.142659  0.083643  0.089640
2  1024.0  0.198019  0.131764  0.128232
3  2048.0  0.382066  0.277357  0.264050
4  4096.0  0.777378  0.454092  0.407521
5  8192.0  1.406171  0.787676  0.712275

gate_linear-speed-bwd-d1_4096-silu-bias_False-residual_True-bf16:
        b        tr        to       toc
0   256.0  0.251857  0.134888  0.193112
1   512.0  0.244577  0.178894  0.235419
2  1024.0  0.302441  0.304610  0.281837
3  2048.0  0.497741  0.513372  0.460552
4  4096.0  0.921884  0.947168  0.858842
5  8192.0  1.697119  1.748091  1.600552
```

#### Memory
```
gate_linear-memory-fwd-d1_4096-silu-bias_False-residual_True-bf16:
        b      tr      to     toc
0   256.0   38.25   43.25   40.25
1   512.0   44.25   54.25   48.25
2  1024.0   56.25   76.25   64.25
3  2048.0   80.25  120.25   96.25
4  4096.0  128.25  208.25  160.25
5  8192.0  224.25  384.25  288.25

gate_linear-memory-bwd-d1_4096-silu-bias_False-residual_True-bf16:
        b      tr      to     toc
0   256.0   97.20   81.45   83.20
1   512.0  114.95   99.45  102.95
2  1024.0  150.45  135.45  142.45
3  2048.0  221.45  222.65  221.45
4  4096.0  379.45  397.05  379.45
5  8192.0  695.45  745.85  695.45
```

### Residual = False

#### Speed
```
gate_linear-speed-fwd-d1_4096-silu-bias_False-residual_False-bf16:
        b        tr        to       toc
0   256.0  0.105346  0.051411  0.114396
1   512.0  0.141829  0.077566  0.072196
2  1024.0  0.396530  0.243073  0.246029
3  2048.0  1.015411  0.592005  0.545131
4  4096.0  1.507341  1.010588  0.662540
5  8192.0  2.131943  0.737770  0.647023

gate_linear-speed-bwd-d1_4096-silu-bias_False-residual_False-bf16:
        b        tr        to       toc
0   256.0  0.246534  0.129444  0.158347
1   512.0  0.209731  0.172110  0.161529
2  1024.0  0.287786  0.293560  0.267510
3  2048.0  0.476867  0.491466  0.439099
4  4096.0  0.889015  0.914049  0.824515
5  8192.0  1.654597  1.706200  1.545970
```

#### Memory
```
gate_linear-memory-fwd-d1_4096-silu-bias_False-residual_False-bf16:
        b      tr      to     toc
0   256.0   37.25   41.25   39.25
1   512.0   42.25   50.25   46.25
2  1024.0   52.25   68.25   60.25
3  2048.0   72.25  104.25   88.25
4  4096.0  112.25  176.25  144.25
5  8192.0  192.25  320.25  256.25

gate_linear-memory-bwd-d1_4096-silu-bias_False-residual_False-bf16:
        b      tr      to     toc
0   256.0   95.25   79.45   81.25
1   512.0  111.05   95.45   99.05
2  1024.0  142.65  127.45  134.65
3  2048.0  205.85  206.65  205.85
4  4096.0  348.25  365.05  348.25
5  8192.0  633.05  681.85  633.05
```

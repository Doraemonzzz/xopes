# Gate Linear Benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Residual = True

#### Speed

```
gate_linear-speed-fwd-d1_4096-silu-bias_False-residual_True-bf16:
        b        tr        ag        to       toc
0   256.0  0.106088  0.056220  0.056046  0.063146
1   512.0  0.142076  0.083285  0.083585  0.084882
2  1024.0  0.197705  0.131872  0.131838  0.129235
3  2048.0  0.381330  0.278043  0.278113  0.264436
4  4096.0  0.773385  0.451675  0.448950  0.410597
5  8192.0  1.403413  0.788954  0.794850  0.714254

gate_linear-speed-bwd-d1_4096-silu-bias_False-residual_True-bf16:
        b        tr        ag        to       toc
0   256.0  0.245020  0.242991  0.134160  0.178527
1   512.0  0.217588  0.215647  0.179068  0.170099
2  1024.0  0.300326  0.300093  0.304639  0.280429
3  2048.0  0.496970  0.496583  0.512435  0.461582
4  4096.0  0.921842  0.921969  0.949080  0.858520
5  8192.0  1.705240  1.707366  1.761389  1.602485
```

#### Memory
```
gate_linear-memory-fwd-d1_4096-silu-bias_False-residual_True-bf16:
        b      tr      ag      to     toc
0   256.0   38.25   41.25   43.25   40.25
1   512.0   44.25   50.25   54.25   48.25
2  1024.0   56.25   68.25   76.25   64.25
3  2048.0   80.25  104.25  120.25   96.25
4  4096.0  128.25  176.25  208.25  160.25
5  8192.0  224.25  320.25  384.25  288.25

gate_linear-memory-bwd-d1_4096-silu-bias_False-residual_True-bf16:
        b      tr      ag      to     toc
0   256.0   97.20   97.20   81.45   83.20
1   512.0  114.95  114.95   99.45  102.95
2  1024.0  150.45  150.45  135.45  142.45
3  2048.0  221.45  221.45  222.65  221.45
4  4096.0  379.45  379.45  397.05  379.45
5  8192.0  695.45  695.45  745.85  695.45
```

### Residual = False

#### Speed
```
gate_linear-speed-fwd-d1_4096-silu-bias_False-residual_False-bf16:
        b        tr        ag        to       toc
0   256.0  0.104949  0.051434  0.051474  0.062184
1   512.0  0.141277  0.077127  0.077114  0.071707
2  1024.0  0.194899  0.123063  0.124150  0.116393
3  2048.0  0.376332  0.265099  0.265013  0.246289
4  4096.0  0.774860  0.422718  0.419796  0.380115
5  8192.0  1.428774  0.743924  0.740292  0.657692

gate_linear-speed-bwd-d1_4096-silu-bias_False-residual_False-bf16:
        b        tr        ag        to       toc
0   256.0  0.231861  0.232164  0.129446  0.181934
1   512.0  0.233247  0.230016  0.170552  0.188822
2  1024.0  0.287427  0.287213  0.294143  0.266678
3  2048.0  0.477247  0.477472  0.492214  0.440459
4  4096.0  0.892401  0.894847  0.921127  0.828151
5  8192.0  1.663705  1.672729  1.713643  1.552432
```

#### Memory
```
gate_linear-memory-fwd-d1_4096-silu-bias_False-residual_False-bf16:
        b      tr      ag      to     toc
0   256.0   37.25   40.25   41.25   39.25
1   512.0   42.25   48.25   50.25   46.25
2  1024.0   52.25   64.25   68.25   60.25
3  2048.0   72.25   96.25  104.25   88.25
4  4096.0  112.25  160.25  176.25  144.25
5  8192.0  192.25  288.25  320.25  256.25

gate_linear-memory-bwd-d1_4096-silu-bias_False-residual_False-bf16:
        b      tr      ag      to     toc
0   256.0   95.25   95.25   79.45   81.25
1   512.0  111.05  111.05   95.45   99.05
2  1024.0  142.65  142.65  127.45  134.65
3  2048.0  205.85  205.85  206.65  205.85
4  4096.0  348.25  348.25  365.05  348.25
5  8192.0  633.05  633.05  681.85  633.05
```

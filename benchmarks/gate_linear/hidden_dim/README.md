# Gate Linear Benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Residual = True

#### Speed

```
gate_linear-speed-fwd-batch4096-silu-bias_False-residual_True-bf16:
       d1        tr        to       toc
0   256.0  0.016950  0.028694  0.066671
1   512.0  0.028586  0.041943  0.175727
2  1024.0  0.062217  0.073271  0.175415
3  2048.0  0.205856  0.185463  0.171800
4  4096.0  0.782998  0.451027  0.409622
5  8192.0  2.721678  1.322010  1.234168

gate_linear-speed-bwd-batch4096-silu-bias_False-residual_True-bf16:
       d1        tr        to       toc
0   256.0  0.288773  0.076432  0.198257
1   512.0  0.289490  0.096563  0.211455
2  1024.0  0.297346  0.162048  0.199109
3  2048.0  0.390618  0.362866  0.312816
4  4096.0  0.924565  0.951936  0.865519
5  8192.0  2.837936  2.870241  2.725024
```

#### Memory
```
gate_linear-memory-fwd-batch4096-silu-bias_False-residual_True-bf16:
       d1        tr        to       toc
0   256.0   22.3125   27.3125   24.3125
1   512.0   28.5000   38.5000   32.5000
2  1024.0   41.2500   61.2500   49.2500
3  2048.0   68.2500  108.2500   84.2500
4  4096.0  128.2500  208.2500  160.2500
5  8192.0  272.2500  432.2500  336.2500

gate_linear-memory-bwd-batch4096-silu-bias_False-residual_True-bf16:
       d1          tr       to         toc
0   256.0   36.184375   38.175   36.184375
1   512.0   56.487500   60.350   56.487500
2  1024.0   98.200000  105.450   98.200000
3  2048.0  186.050000  198.650  186.050000
4  4096.0  379.450000  397.050  379.450000
5  8192.0  837.050000  841.850  837.050000
```

### Residual = False

#### Speed
```
gate_linear-speed-fwd-batch4096-silu-bias_False-residual_False-bf16:
       d1        tr        to       toc
0   256.0  0.015512  0.023943  0.069060
1   512.0  0.027085  0.035409  0.069163
2  1024.0  0.059407  0.065768  0.059425
3  2048.0  0.202800  0.172492  0.151484
4  4096.0  0.780297  0.428899  0.382048
5  8192.0  2.791008  1.263873  1.193263

gate_linear-speed-bwd-batch4096-silu-bias_False-residual_False-bf16:
       d1        tr        to       toc
0   256.0  0.282686  0.075799  0.194741
1   512.0  0.231139  0.084006  0.159575
2  1024.0  0.281915  0.150110  0.146475
3  2048.0  0.329202  0.342054  0.292916
4  4096.0  0.893447  0.919587  0.832283
5  8192.0  2.803456  2.838713  2.687321
```

#### Memory
```
gate_linear-memory-fwd-batch4096-silu-bias_False-residual_False-bf16:
       d1        tr        to       toc
0   256.0   21.3125   25.3125   23.3125
1   512.0   26.5000   34.5000   30.5000
2  1024.0   37.2500   53.2500   45.2500
3  2048.0   60.2500   92.2500   76.2500
4  4096.0  112.2500  176.2500  144.2500
5  8192.0  240.2500  368.2500  304.2500

gate_linear-memory-bwd-batch4096-silu-bias_False-residual_False-bf16:
       d1          tr       to         toc
0   256.0   34.234375   36.175   34.234375
1   512.0   52.587500   56.350   52.587500
2  1024.0   90.400000   97.450   90.400000
3  2048.0  170.450000  182.650  170.450000
4  4096.0  348.250000  365.050  348.250000
5  8192.0  774.650000  777.850  774.650000
```

# Gate Linear Benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Residual = True

#### Speed

```
gate_linear-speed-fwd-batch4096-silu-bias_False-residual_True-bf16:
       d1        tr        ag        to       toc
0   256.0  0.016426  0.028777  0.028876  0.058606
1   512.0  0.028585  0.041205  0.042024  0.090022
2  1024.0  0.062244  0.072674  0.073776  0.073209
3  2048.0  0.206328  0.185397  0.185503  0.171686
4  4096.0  0.777036  0.453557  0.448646  0.410245
5  8192.0  2.717617  1.302080  1.313334  1.242532

gate_linear-speed-bwd-batch4096-silu-bias_False-residual_True-bf16:
       d1        tr        ag        to       toc
0   256.0  0.273709  0.217085  0.063629  0.170781
1   512.0  0.210296  0.213962  0.086284  0.140962
2  1024.0  0.309030  0.306484  0.161875  0.158101
3  2048.0  0.348604  0.348972  0.362661  0.313994
4  4096.0  0.921104  0.921173  0.949051  0.857763
5  8192.0  2.802110  2.819000  2.865335  2.723897
```

#### Memory
```
gate_linear-memory-fwd-batch4096-silu-bias_False-residual_True-bf16:
       d1        tr        ag        to       toc
0   256.0   22.3125   25.3125   27.3125   24.3125
1   512.0   28.5000   34.5000   38.5000   32.5000
2  1024.0   41.2500   53.2500   61.2500   49.2500
3  2048.0   68.2500   92.2500  108.2500   84.2500
4  4096.0  128.2500  176.2500  208.2500  160.2500
5  8192.0  272.2500  368.2500  432.2500  336.2500

gate_linear-memory-bwd-batch4096-silu-bias_False-residual_True-bf16:
       d1          tr          ag       to         toc
0   256.0   36.184375   36.184375   38.175   36.184375
1   512.0   56.487500   56.487500   60.350   56.487500
2  1024.0   98.200000   98.200000  105.450   98.200000
3  2048.0  186.050000  186.050000  198.650  186.050000
4  4096.0  379.450000  379.450000  397.050  379.450000
5  8192.0  837.050000  837.050000  841.850  837.050000
```

### Residual = False

#### Speed
```
gate_linear-speed-fwd-batch4096-silu-bias_False-residual_False-bf16:
       d1        tr        ag        to       toc
0   256.0  0.015781  0.024001  0.023993  0.070884
1   512.0  0.027727  0.035363  0.036525  0.061671
2  1024.0  0.059974  0.065230  0.066338  0.058638
3  2048.0  0.202913  0.173638  0.172565  0.151519
4  4096.0  0.775813  0.422375  0.419375  0.380841
5  8192.0  2.755032  1.267140  1.267789  1.192465

gate_linear-speed-bwd-batch4096-silu-bias_False-residual_False-bf16:
       d1        tr        ag        to       toc
0   256.0  0.218366  0.218208  0.057996  0.145485
1   512.0  0.199589  0.225711  0.079253  0.136270
2  1024.0  0.192807  0.196103  0.150102  0.144748
3  2048.0  0.329037  0.328826  0.342155  0.292863
4  4096.0  0.893008  0.895825  0.917268  0.831119
5  8192.0  2.782196  2.785074  2.830612  2.714155
```

#### Memory
```
gate_linear-memory-fwd-batch4096-silu-bias_False-residual_False-bf16:
       d1        tr        ag        to       toc
0   256.0   21.3125   24.3125   25.3125   23.3125
1   512.0   26.5000   32.5000   34.5000   30.5000
2  1024.0   37.2500   49.2500   53.2500   45.2500
3  2048.0   60.2500   84.2500   92.2500   76.2500
4  4096.0  112.2500  160.2500  176.2500  144.2500
5  8192.0  240.2500  336.2500  368.2500  304.2500

gate_linear-memory-bwd-batch4096-silu-bias_False-residual_False-bf16:
       d1          tr          ag       to         toc
0   256.0   34.234375   34.234375   36.175   34.234375
1   512.0   52.587500   52.587500   56.350   52.587500
2  1024.0   90.400000   90.400000   97.450   90.400000
3  2048.0  170.450000  170.450000  182.650  170.450000
4  4096.0  348.250000  348.250000  365.050  348.250000
5  8192.0  774.650000  774.650000  777.850  774.650000
```

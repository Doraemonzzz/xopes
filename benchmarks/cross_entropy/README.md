# Cross Entropy benchmark

## Notation

- tr: Triton
- fla: Fla Kernel
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
cross_entropy-speed-fwd-batch4096-bf16-ls0.0-mean:
          v        tr       fla        to       toc
0    1024.0  0.291936  0.168225  0.109778  0.125655
1    2048.0  0.137250  0.179336  0.138167  0.200941
2    4096.0  0.135277  0.180157  0.161308  0.132599
3    8192.0  0.166052  0.285053  0.191266  0.105223
4   16384.0  0.194550  0.282135  0.242112  0.121863
5   32768.0  0.328491  0.178880  0.349611  0.206049
6   65536.0  0.636831  0.255421  0.803021  0.444250
7  131072.0  3.016428  0.485554  1.532270  0.914448

cross_entropy-speed-bwd-batch4096-bf16-ls0.0-mean:
          v        tr       fla        to       toc
0    1024.0  0.648518  1.264678  0.149269  0.182321
1    2048.0  0.585304  0.368852  0.142764  1.235479
2    4096.0  1.483843  0.401502  0.415492  1.105303
3    8192.0  1.558107  0.988767  0.478088  0.836278
4   16384.0  1.131979  1.395571  1.024624  1.389483
5   32768.0  1.678388  1.005443  0.831517  0.562768
6   65536.0  1.843783  1.374645  1.599733  1.157818
7  131072.0  3.667981  1.790223  3.141634  2.037520
```


### Memory

```
cross_entropy-memory-fwd-batch4096-bf16-ls0.0-mean:
          v           tr          fla           to          toc
0    1024.0     8.066895     8.114258    16.032227     8.063477
1    2048.0    16.066895    16.114258    32.032227    16.063477
2    4096.0    32.066895    32.114258    64.032227    32.063477
3    8192.0    64.066895    64.114258   128.032227    64.063477
4   16384.0   128.066895   128.114258   256.032227   128.063477
5   32768.0   256.066895   256.114258   512.032227   256.063477
6   65536.0   512.066895   512.114258  1024.032227   512.063477
7  131072.0  1024.066895  1024.187500  2048.032227  1024.063477

cross_entropy-memory-bwd-batch4096-bf16-ls0.0-mean:
          v           tr          fla           to          toc
0    1024.0    39.632227    16.078491    39.632715    23.663965
1    2048.0    79.232227    32.078491    79.232715    47.263965
2    4096.0   158.432227    64.078491   158.432715    94.463965
3    8192.0   316.832227   128.078491   316.832715   188.863965
4   16384.0   633.632227   256.078491   633.632715   377.663965
5   32768.0  1267.232227   512.078491  1267.232715   755.263965
6   65536.0  2534.432227  1024.078491  2534.432715  1510.463965
7  131072.0  5068.832227  2048.078491  5068.832715  3020.863965
```

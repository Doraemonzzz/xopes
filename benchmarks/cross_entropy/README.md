# Cross Entropy benchmark

## Notation

- tr: Triton
- pt: Parallel Triton
- fla: Fla Kernel
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
cross_entropy-speed-fwd-batch4096-bf16-ls0.0-mean:
          v        tr        pt       fla        to       toc
0    1024.0  0.133649  0.202914  0.169243  0.110286  0.166867
1    2048.0  0.134996  0.219498  0.179990  0.138582  0.185147
2    4096.0  0.134995  0.203456  0.177854  0.161969  0.104555
3    8192.0  0.145467  0.204856  0.180191  0.192114  0.076989
4   16384.0  0.171120  0.142422  0.089774  0.241430  0.119029
5   32768.0  0.374892  0.279434  0.164878  0.348011  0.204948
6   65536.0  0.611550  0.304901  0.255610  0.801571  0.443247
7  131072.0  3.002627  0.525290  0.485504  1.531305  0.915056

cross_entropy-speed-bwd-batch4096-bf16-ls0.0-mean:
          v        tr        pt       fla        to       toc
0    1024.0  0.545819  0.220119  0.248748  0.130917  0.269122
1    2048.0  0.548246  0.327353  0.443353  0.226069  1.075560
2    4096.0  1.496524  1.139897  1.391756  0.923288  1.419378
3    8192.0  1.573809  1.270494  1.611162  0.797062  1.358617
4   16384.0  1.445164  1.285438  1.533308  0.974193  1.413486
5   32768.0  1.554461  1.340430  1.415033  1.039389  1.635058
6   65536.0  1.843795  1.334554  1.591877  1.599608  1.578812
7  131072.0  3.671910  1.770107  1.789887  3.142687  2.035786
```


### Memory

```
cross_entropy-memory-fwd-batch4096-bf16-ls0.0-mean:
          v           tr           pt          fla           to          toc
0    1024.0     8.066895     8.066895     8.114258    16.032227     8.063477
1    2048.0    16.066895    16.066895    16.114258    32.032227    16.063477
2    4096.0    32.066895    32.066895    32.114258    64.032227    32.063477
3    8192.0    64.066895    64.066895    64.114258   128.032227    64.063477
4   16384.0   128.066895   128.066895   128.114258   256.032227   128.063477
5   32768.0   256.066895   256.066895   256.114258   512.032227   256.063477
6   65536.0   512.066895   512.066895   512.114258  1024.032227   512.063477
7  131072.0  1024.066895  1024.093750  1024.187500  2048.032227  1024.063477

cross_entropy-memory-bwd-batch4096-bf16-ls0.0-mean:
          v           tr           pt          fla           to          toc
0    1024.0    39.632227    16.062695    16.078491    39.632715    23.663965
1    2048.0    79.232227    32.062695    32.078491    79.232715    47.263965
2    4096.0   158.432227    64.062695    64.078491   158.432715    94.463965
3    8192.0   316.832227   128.062695   128.078491   316.832715   188.863965
4   16384.0   633.632227   256.062695   256.078491   633.632715   377.663965
5   32768.0  1267.232227   512.062695   512.078491  1267.232715   755.263965
6   65536.0  2534.432227  1024.062695  1024.078491  2534.432715  1510.463965
7  131072.0  5068.832227  2048.062695  2048.078491  5068.832715  3020.863965
```

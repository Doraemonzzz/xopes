# Cross Entropy benchmark

## Notation

- tr: Triton
- pt: Parallel Triton
- fla: Fla Kernel
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
cross_entropy-speed-fwd-batch4096-bf16-ls0.0-mean:
          v        tr        pt       fla        to       toc
0    1024.0  0.143832  0.204920  0.184878  0.110190  0.095906
1    2048.0  0.129922  0.206907  0.175646  0.138607  0.176809
2    4096.0  0.134973  0.212486  0.257034  0.161772  0.102847
3    8192.0  0.144553  0.208709  0.179331  0.192301  0.102986
4   16384.0  0.194087  0.225772  0.179164  0.242061  0.120104
5   32768.0  0.326983  0.218390  0.181239  0.350794  0.205870
6   65536.0  0.644357  0.303912  0.257591  0.803072  0.444131
7  131072.0  3.017799  0.471964  0.487656  1.532063  0.914679

cross_entropy-speed-bwd-batch4096-bf16-ls0.0-mean:
          v        tr        pt       fla        to       toc
0    1024.0  1.008853  0.722623  0.744668  0.214385  0.324304
1    2048.0  0.873111  0.419283  0.418741  0.656144  0.806922
2    4096.0  1.544483  0.733854  1.230899  0.631477  1.233492
3    8192.0  1.413055  0.292912  0.924735  0.367634  1.210425
4   16384.0  1.072885  0.731586  0.965593  0.434514  0.699180
5   32768.0  1.294109  0.627879  0.616401  0.843205  0.981204
6   65536.0  1.842276  0.951567  1.555586  1.599244  1.519316
7  131072.0  3.669267  1.765971  1.789889  3.143104  2.038623
```


### Memory

```
cross_entropy-memory-fwd-batch4096-bf16-ls0.0-mean:
          v           tr           pt          fla           to          toc
0    1024.0     8.066895     8.066895     8.114258    16.032227     8.063477
1    2048.0    16.066895    16.066895    16.114258    32.032227    16.063477
2    4096.0    32.066895    32.066895    32.114258    64.032227    32.063477
3    8192.0    64.066895    64.066895    64.114258   128.032227    64.063477
4   16384.0   128.066895   128.093750   128.114258   256.032227   128.063477
5   32768.0   256.066895   256.125000   256.114258   512.032227   256.063477
6   65536.0   512.066895   512.187500   512.114258  1024.032227   512.063477
7  131072.0  1024.066895  1024.312500  1024.187500  2048.032227  1024.063477

cross_entropy-memory-bwd-batch4096-bf16-ls0.0-mean:
          v           tr           pt          fla           to          toc
0    1024.0    39.632227    16.062695    16.078491    39.632715    23.663965
1    2048.0    79.232227    32.062695    32.078491    79.232715    47.263965
2    4096.0   158.432227    64.062695    64.078491   158.432715    94.463965
3    8192.0   316.832227   128.062695   128.078491   316.832715   188.863965
4   16384.0   633.632227   256.062695   256.078491   633.632715   377.663965
5   32768.0  1267.232227   512.062695   512.078491  1267.232715   755.263965
6   65536.0  2534.432227  1024.062695  1024.078491  2534.432715  1510.463965
7  131072.0  5068.832227  2048.062695  2048.078491  5068.832715  3020.863965
```

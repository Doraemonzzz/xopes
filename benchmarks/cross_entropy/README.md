# Cross Entropy benchmark

## Notation

- tr: Triton
- pt: Parallel Triton
- fla: Fla Kernel
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
cross_entropy-speed-fwd-batch4096-bf16-ls0.0-mean:
          v        tr        pt       fla        to       toc
0    1024.0  0.138341  0.249695  0.184137  0.110055  0.150889
1    2048.0  0.139038  0.222645  0.192815  0.138486  0.155304
2    4096.0  0.139197  0.222765  0.195039  0.161758  0.119048
3    8192.0  0.149446  0.223517  0.198892  0.191742  0.120372
4   16384.0  0.202410  0.239334  0.196306  0.242448  0.170683
5   32768.0  0.333039  0.237346  0.199623  0.350183  0.205676
6   65536.0  0.645724  0.303653  0.255937  0.802631  0.444073
7  131072.0  3.026768  0.476879  0.666186  1.532151  0.914420

cross_entropy-speed-bwd-batch4096-bf16-ls0.0-mean:
          v        tr        pt       fla        to       toc
0    1024.0  0.433479  1.288491  1.118412  0.751750  1.253131
1    2048.0  0.395488  1.249131  1.449052  0.448329  1.132807
2    4096.0  1.386613  0.488171  1.399992  0.569963  0.935171
3    8192.0  1.344967  1.058572  1.019256  0.626879  1.356729
4   16384.0  1.352819  0.344367  0.375456  0.434290  0.988525
5   32768.0  1.486897  0.477230  0.973200  0.831969  1.112882
6   65536.0  1.841550  0.888484  1.519433  1.598637  1.432924
7  131072.0  3.669930  1.770674  1.788359  3.142164  2.234074
```


### Memory

```
cross_entropy-memory-fwd-batch4096-bf16-ls0.0-mean:
          v           tr           pt          fla           to          toc
0    1024.0     8.066895     8.066895     8.114258    16.032227     8.063477
1    2048.0    16.066895    16.066895    16.114258    32.032227    16.063477
2    4096.0    32.066895    32.066895    32.114258    64.032227    32.063477
3    8192.0    64.066895    64.066895    64.114258   128.032227    64.063477
4   16384.0   128.066895   128.093750   128.114258   256.032227   128.063477
5   32768.0   256.066895   256.125000   256.114258   512.032227   256.063477
6   65536.0   512.066895   512.187500   512.114258  1024.032227   512.063477
7  131072.0  1024.066895  1024.312500  1024.187500  2048.032227  1024.063477

cross_entropy-memory-bwd-batch4096-bf16-ls0.0-mean:
          v           tr           pt          fla           to          toc
0    1024.0    39.632227    16.062695    16.078491    39.632715    23.663965
1    2048.0    79.232227    32.062695    32.078491    79.232715    47.263965
2    4096.0   158.432227    64.062695    64.078491   158.432715    94.463965
3    8192.0   316.832227   128.062695   128.078491   316.832715   188.863965
4   16384.0   633.632227   256.062695   256.078491   633.632715   377.663965
5   32768.0  1267.232227   512.062695   512.078491  1267.232715   755.263965
6   65536.0  2534.432227  1024.062695  1024.078491  2534.432715  1510.463965
7  131072.0  5068.832227  2048.062695  2048.078491  5068.832715  3020.863965
```

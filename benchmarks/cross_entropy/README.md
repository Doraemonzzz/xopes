# Cross Entropy benchmark

## Notation

- tr: Triton
- fla: Fla Kernel
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
cross_entropy-speed-fwd-batch4096-bf16-ls0.0-mean:
          v        tr       fla        to       toc
0    1024.0  0.132601  0.169246  0.109969  0.124913
1    2048.0  0.133121  0.176900  0.138418  0.109708
2    4096.0  0.133281  0.176206  0.161731  0.101621
3    8192.0  0.146659  0.175245  0.191708  0.105441
4   16384.0  0.193111  0.175090  0.241861  0.119704
5   32768.0  0.328052  0.184303  0.348780  0.205878
6   65536.0  0.611291  0.255135  0.801407  0.443173
7  131072.0  2.980476  0.480931  1.530707  0.913579

cross_entropy-speed-bwd-batch4096-bf16-ls0.0-mean:
          v        tr       fla        to       toc
0    1024.0  0.130263  0.920205  0.231168  0.261634
1    2048.0  0.269207  0.663824  0.235654  0.553364
2    4096.0  0.258519  0.589470  0.214953  0.453367
3    8192.0  0.297997  0.649655  0.502715  1.226846
4   16384.0  1.060610  1.521131  1.008074  1.523114
5   32768.0  1.153837  1.521162  1.082319  1.353801
6   65536.0  2.291938  1.644263  1.599994  1.309832
7  131072.0  4.568042  1.789345  3.141741  2.233647
```


### Memory

```
cross_entropy-memory-fwd-batch4096-bf16-ls0.0-mean:
          v           tr          fla           to          toc
0    1024.0     8.066895     8.114258    16.032227     8.063477
1    2048.0    16.066895    16.114258    32.032227    16.063477
2    4096.0    32.066895    32.114258    64.032227    32.063477
3    8192.0    64.066895    64.114258   128.032227    64.063477
4   16384.0   128.066895   128.114258   256.032227   128.063477
5   32768.0   256.066895   256.114258   512.032227   256.063477
6   65536.0   512.066895   512.114258  1024.032227   512.063477
7  131072.0  1024.066895  1024.187500  2048.032227  1024.063477

cross_entropy-memory-bwd-batch4096-bf16-ls0.0-mean:
          v           tr          fla           to          toc
0    1024.0    39.632227    16.078491    39.632715    23.663965
1    2048.0    79.232227    32.078491    79.232715    47.263965
2    4096.0   158.432227    64.078491   158.432715    94.463965
3    8192.0   316.832227   128.078491   316.832715   188.863965
4   16384.0   633.632227   256.078491   633.632715   377.663965
5   32768.0  1267.232227   512.078491  1267.232715   755.263965
6   65536.0  2534.432227  1024.078491  2534.432715  1510.463965
7  131072.0  5068.832227  2048.078491  5068.832715  3020.863965
```

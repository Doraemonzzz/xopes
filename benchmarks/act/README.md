# Act benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## H100

### Without dim act

#### Speed(fwd)
```
act-speed-fwd-batch12-head12-dim128-act_relu-bf16:
         n        tr        to       toc
0    256.0  0.043131  0.014025  0.300839
1    512.0  0.050825  0.022934  0.096720
2   1024.0  0.095260  0.033127  0.074055
3   2048.0  0.183512  0.059413  0.077925
4   4096.0  0.360655  0.110727  0.132052
5   8192.0  0.714422  0.213933  0.257789
6  16384.0  1.423459  0.419292  0.508542
7  32768.0  2.839868  0.830730  1.009366

act-speed-fwd-batch12-head12-dim128-act_sigmoid-bf16:
         n        tr        to       toc
0    256.0  0.054441  0.013755  0.082462
1    512.0  0.057167  0.020617  0.064880
2   1024.0  0.095126  0.034340  0.064212
3   2048.0  0.183176  0.061218  0.063358
4   4096.0  0.360854  0.114792  0.105408
5   8192.0  0.714031  0.220891  0.204142
6  16384.0  1.422536  0.434373  0.401440
7  32768.0  2.842082  0.860860  0.795817

act-speed-fwd-batch12-head12-dim128-act_silu-bf16:
         n        tr        to       toc
0    256.0  0.036730  0.012855  0.093885
1    512.0  0.049663  0.019739  0.060332
2   1024.0  0.094022  0.033376  0.059218
3   2048.0  0.182827  0.060444  0.060403
4   4096.0  0.359956  0.113552  0.105105
5   8192.0  0.714648  0.220642  0.205154
6  16384.0  1.423037  0.433495  0.402592
7  32768.0  2.839550  0.858448  0.796288

act-speed-fwd-batch12-head12-dim128-act_none-bf16:
         n        tr        to       toc
0    256.0  0.003548  0.003794  0.003813
1    512.0  0.003779  0.003777  0.003795
2   1024.0  0.003741  0.003732  0.003091
3   2048.0  0.003032  0.003069  0.003122
4   4096.0  0.003240  0.003560  0.003793
5   8192.0  0.003798  0.003827  0.003804
6  16384.0  0.003832  0.003810  0.003802
7  32768.0  0.003774  0.003817  0.003810
```

#### Speed(bwd)
```
act-speed-bwd-batch12-head12-dim128-act_relu-bf16:
         n        tr        to       toc
0    256.0  0.482951  0.225499  0.292583
1    512.0  0.402142  0.167707  0.357509
2   1024.0  0.295619  0.163285  0.276549
3   2048.0  0.876247  0.321744  0.319687
4   4096.0  0.656228  0.369014  0.317061
5   8192.0  1.005122  0.591490  0.591578
6  16384.0  2.005422  1.171604  1.172090
7  32768.0  4.002885  2.334263  2.334333

act-speed-bwd-batch12-head12-dim128-act_sigmoid-bf16:
         n        tr        to       toc
0    256.0  0.436371  0.121975  0.346832
1    512.0  1.456105  0.792418  0.445046
2   1024.0  1.049017  0.169295  0.181083
3   2048.0  0.554000  0.248663  0.291024
4   4096.0  0.847492  0.337172  0.300153
5   8192.0  1.003780  0.590409  0.590356
6  16384.0  2.005047  1.170209  1.169977
7  32768.0  4.001229  2.332979  2.333046

act-speed-bwd-batch12-head12-dim128-act_silu-bf16:
         n        tr        to       toc
0    256.0  1.027766  0.281243  0.284954
1    512.0  0.603511  0.215926  0.340828
2   1024.0  0.908610  0.437987  0.301766
3   2048.0  0.795569  0.288300  0.346908
4   4096.0  0.888800  0.300540  0.477817
5   8192.0  1.003771  0.590597  0.590624
6  16384.0  2.005147  1.169620  1.169570
7  32768.0  4.001599  2.330495  2.330909

act-speed-bwd-batch12-head12-dim128-act_none-bf16:
         n        tr        to       toc
0    256.0  0.102826  0.045059  0.092977
1    512.0  0.229670  0.182027  0.194936
2   1024.0  0.317689  0.200369  0.280027
3   2048.0  0.308079  0.368156  0.240086
4   4096.0  0.160478  0.163240  0.172211
5   8192.0  0.379015  0.297268  0.297576
6  16384.0  0.587274  0.587331  0.587171
7  32768.0  1.168895  1.168854  1.169317
```

#### Memory(fwd)
```
act-memory-fwd-batch12-head12-dim128-act_relu-bf16:
         n      tr      to     toc
0    256.0    18.0    18.0    18.0
1    512.0    36.0    36.0    36.0
2   1024.0    72.0    72.0    72.0
3   2048.0   144.0   144.0   144.0
4   4096.0   288.0   288.0   288.0
5   8192.0   576.0   576.0   576.0
6  16384.0  1152.0  1152.0  1152.0
7  32768.0  2304.0  2304.0  2304.0

act-memory-fwd-batch12-head12-dim128-act_sigmoid-bf16:
         n      tr      to     toc
0    256.0    18.0    18.0    18.0
1    512.0    36.0    36.0    36.0
2   1024.0    72.0    72.0    72.0
3   2048.0   144.0   144.0   144.0
4   4096.0   288.0   288.0   288.0
5   8192.0   576.0   576.0   576.0
6  16384.0  1152.0  1152.0  1152.0
7  32768.0  2304.0  2304.0  2304.0

act-memory-fwd-batch12-head12-dim128-act_silu-bf16:
         n      tr      to     toc
0    256.0    18.0    18.0    18.0
1    512.0    36.0    36.0    36.0
2   1024.0    72.0    72.0    72.0
3   2048.0   144.0   144.0   144.0
4   4096.0   288.0   288.0   288.0
5   8192.0   576.0   576.0   576.0
6  16384.0  1152.0  1152.0  1152.0
7  32768.0  2304.0  2304.0  2304.0

act-memory-fwd-batch12-head12-dim128-act_none-bf16:
         n      tr      to     toc
0    256.0     9.0     9.0     9.0
1    512.0    18.0    18.0    18.0
2   1024.0    36.0    36.0    36.0
3   2048.0    72.0    72.0    72.0
4   4096.0   144.0   144.0   144.0
5   8192.0   288.0   288.0   288.0
6  16384.0   576.0   576.0   576.0
7  32768.0  1152.0  1152.0  1152.0
```

#### Memory(bwd)
```
act-memory-bwd-batch12-head12-dim128-act_relu-bf16:
         n       tr       to      toc
0    256.0    44.55    44.55    44.55
1    512.0    89.10    89.10    89.10
2   1024.0   178.20   178.20   178.20
3   2048.0   356.40   356.40   356.40
4   4096.0   712.80   712.80   712.80
5   8192.0  1425.60  1425.60  1425.60
6  16384.0  2851.20  2851.20  2851.20
7  32768.0  5702.40  5702.40  5702.40

act-memory-bwd-batch12-head12-dim128-act_sigmoid-bf16:
         n       tr       to      toc
0    256.0    44.55    44.55    44.55
1    512.0    89.10    89.10    89.10
2   1024.0   178.20   178.20   178.20
3   2048.0   356.40   356.40   356.40
4   4096.0   712.80   712.80   712.80
5   8192.0  1425.60  1425.60  1425.60
6  16384.0  2851.20  2851.20  2851.20
7  32768.0  5702.40  5702.40  5702.40

act-memory-bwd-batch12-head12-dim128-act_silu-bf16:
         n       tr       to      toc
0    256.0    44.55    44.55    44.55
1    512.0    89.10    89.10    89.10
2   1024.0   178.20   178.20   178.20
3   2048.0   356.40   356.40   356.40
4   4096.0   712.80   712.80   712.80
5   8192.0  1425.60  1425.60  1425.60
6  16384.0  2851.20  2851.20  2851.20
7  32768.0  5702.40  5702.40  5702.40

act-memory-bwd-batch12-head12-dim128-act_none-bf16:
         n      tr      to     toc
0    256.0    27.0    27.0    27.0
1    512.0    54.0    54.0    54.0
2   1024.0   108.0   108.0   108.0
3   2048.0   216.0   216.0   216.0
4   4096.0   432.0   432.0   432.0
5   8192.0   864.0   864.0   864.0
6  16384.0  1728.0  1728.0  1728.0
7  32768.0  3456.0  3456.0  3456.0
```

### Without dim act

#### Speed(fwd)
```
act-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr        to       toc
0    256.0  0.044107  0.051584  0.065883
1    512.0  0.053544  0.098944  0.834755
2   1024.0  0.095510  0.179617  0.167424
3   2048.0  0.183953  0.339818  0.080311
4   4096.0  0.360873  0.657740  0.108708
5   8192.0  0.715241  1.301880  0.208598
6  16384.0  1.423606  2.579372  0.410314
7  32768.0  2.840768  5.154560  0.813261

act-speed-fwd-batch12-head12-dim128-act_softmax-dim_-2-bf16:
         n        tr         to       toc
0    256.0  0.241717   0.189792  0.104309
1    512.0  0.217073   0.665787  0.104790
2   1024.0  0.222595   1.403654  0.111304
3   2048.0  0.240311   2.783924  0.202437
4   4096.0  0.459467   5.537331  0.410158
5   8192.0  0.904078  11.037532  0.822043
6  16384.0  1.789178  22.052664  1.646186
7  32768.0  3.608834  44.076706  3.279456
```

#### Speed(bwd)
```
act-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr        to       toc
0    256.0  1.078102  1.038050  0.818664
1    512.0  1.288218  1.044364  1.233274
2   1024.0  0.383298  0.316202  1.455365
3   2048.0  1.220842  0.709585  1.194795
4   4096.0  0.505630  1.193745  0.909970
5   8192.0  1.005069  2.361830  1.193684
6  16384.0  2.003967  4.703096  1.472012
7  32768.0  4.001739  9.397840  2.349231

act-speed-bwd-batch12-head12-dim128-act_softmax-dim_-2-bf16:
         n        tr         to       toc
0    256.0  1.538150   0.504466  0.420399
1    512.0  2.646428   0.959637  1.213476
2   1024.0  1.241022   0.830918  1.473601
3   2048.0  1.143925   1.629390  1.263828
4   4096.0  1.401821   3.231650  1.411061
5   8192.0  1.990986   6.393097  1.296429
6  16384.0  3.951740  12.678940  1.802643
7  32768.0  7.880902  25.379051  3.594967
```

#### Memory(fwd)
```
act-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n      tr      to         toc
0    256.0    18.0    45.0    18.28125
1    512.0    36.0    90.0    36.56250
2   1024.0    72.0   180.0    73.12500
3   2048.0   144.0   360.0   146.25000
4   4096.0   288.0   720.0   292.50000
5   8192.0   576.0  1440.0   585.00000
6  16384.0  1152.0  2880.0  1170.00000
7  32768.0  2304.0  5760.0  2340.00000

act-memory-fwd-batch12-head12-dim128-act_softmax-dim_-2-bf16:
         n      tr      to          toc
0    256.0    36.0    45.0    18.140625
1    512.0    72.0    90.0    36.140625
2   1024.0   144.0   180.0    72.140625
3   2048.0   288.0   360.0   144.140625
4   4096.0   576.0   720.0   288.140625
5   8192.0  1152.0  1440.0   576.140625
6  16384.0  2304.0  2880.0  1152.140625
7  32768.0  4608.0  5760.0  2304.140625
```

#### Memory(bwd)
```
act-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n       tr        to         toc
0    256.0    44.55    107.55    44.83125
1    512.0    89.10    215.10    89.66250
2   1024.0   178.20    430.20   179.32500
3   2048.0   356.40    860.40   358.65000
4   4096.0   712.80   1720.80   717.30000
5   8192.0  1425.60   3441.60  1434.60000
6  16384.0  2851.20   6883.20  2869.20000
7  32768.0  5702.40  13766.40  5738.40000

act-memory-bwd-batch12-head12-dim128-act_softmax-dim_-2-bf16:
         n       tr        to          toc
0    256.0    71.55    107.55    44.760937
1    512.0   143.10    215.10    89.310937
2   1024.0   286.20    430.20   178.410937
3   2048.0   572.40    860.40   356.610937
4   4096.0  1144.80   1720.80   713.010937
5   8192.0  2289.60   3441.60  1425.810937
6  16384.0  4579.20   6883.20  2851.410937
7  32768.0  9158.40  13766.40  5702.610937
```

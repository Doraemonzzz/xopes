# Linear Cross Entropy Benchmark

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
lce-speed-fwd+bwd-dim4096-v65536-bf16:
         b       tr_jg      tr_cut   tr_liger     tr_fla         to        toc
0    512.0    7.922029    6.217618  19.788559  12.065520   2.142958   2.853733
1   1024.0   11.685228    7.953494  18.349108  11.850988   2.986605   2.735172
2   2048.0   19.756588   13.912516  19.398720  13.445390   5.556693   5.121295
3   4096.0   32.681122   24.952513  21.200016  18.259968  10.553163   9.773203
4   8192.0   64.722595   48.847073  31.973066  23.879578  20.815472  19.972315
5  16384.0  126.105598   97.822403  45.017570  44.136269  42.062897  37.122864
6  32768.0  249.590469  191.487427  85.183266  80.708130  88.613503  77.450401
```

### Memory

```
lce-memory-fwd+bwd-dim4096-v65536-bf16:
         b        tr_jg       tr_cut     tr_liger       tr_fla            to           toc
0    512.0  2618.205371  1586.959277  1623.407227  2106.206836   1714.205371   1714.209277
1   1024.0  2638.009277  1598.767090  1646.812988  2126.012695   1854.009277   1854.017090
2   2048.0  2677.820215  1622.382715  1693.624512  2165.624902   2133.617090   2133.632715
3   4096.0  3269.113965  1669.613965  1787.247559  2244.849316   2692.832715   2692.863965
4   8192.0  3395.562305  1764.076465  1974.493652  2403.298145   4259.263965   3811.326465
5  16384.0  3648.424805  1953.001465  2348.985840  2720.195801   7456.126465   6048.251465
6  32768.0  4154.149805  2330.851465  3097.976465  3353.991113  13849.851465  10522.101465
```

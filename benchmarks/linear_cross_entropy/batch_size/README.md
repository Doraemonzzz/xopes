# Linear Cross Entropy Benchmark

## Notation

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- tr: Triton(xopes)
- tr_lce: Triton Linear Cross Entropy(xopes)
- to: Torch
- toc: Torch Compile


## H100

### Speed

```
lce-speed-fwd+bwd-dim4096-v131072-bf16:
         b       tr_jg      tr_cut    tr_liger     tr_fla         tr     tr_lce         to        toc
0    512.0   15.707989    7.565296   66.321533  21.886383  21.107391   5.292068   4.228051   3.960544
1   1024.0   23.618361   11.925659   64.854080  22.073462  21.747423   6.223959   5.879829   5.458654
2   2048.0   39.610321   20.443367   64.317345  25.235361  24.768972  10.193456  10.891829   9.757632
3   4096.0   65.838943   38.238289   65.756828  34.717312  34.206112  19.990345  21.777002  20.009504
4   8192.0  130.027039   73.308609   77.500160  46.639297  45.836800  38.364048  42.992496  38.559235
5  16384.0  254.091965  146.005951  114.162720  82.911011  82.016640  75.264511  82.814018  75.460419
```

### Memory

```
lce-memory-fwd+bwd-dim4096-v131072-bf16:
         b        tr_jg       tr_cut     tr_liger       tr_fla           tr       tr_lce            to           toc
0    512.0  5152.605371  3098.109277  3159.407227  4136.606836  4136.607324  3224.607324   3352.605371   3352.609277
1   1024.0  5172.409277  3109.917090  3182.812988  4164.412695  4164.413184  3364.413184   3620.409277   3620.417090
2   2048.0  5228.407715  3133.532715  3229.624512  4220.024902  4220.025879  3644.024902   4156.017090   4156.032715
3   4096.0  6347.763965  3180.763965  3323.247559  4331.249316  4331.251270  4203.248340   5227.232715   5227.263965
4   8192.0  6474.212305  3275.226465  3510.493652  4553.698145  4553.702051  5321.695215   8329.663965   7369.726465
5  16384.0  6727.074805  3464.151465  3884.985840  4998.595801  4998.603613  7558.588965  14598.526465  11654.651465
```

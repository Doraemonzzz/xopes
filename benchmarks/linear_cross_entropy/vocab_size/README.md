# Linear Cross Entropy Benchmark

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
lce-speed-fwd+bwd-batch2048-dim4096-bf16:
          v      tr_jg     tr_cut   tr_liger     tr_fla         to        toc
0    1024.0   2.744171   4.419510   3.159672   3.164497   1.919581   3.283792
1    2048.0   2.718790   4.316057   4.064769   3.087571   2.000470   3.182692
2    4096.0   2.763084   4.593678   4.262774   3.220578   1.970449   3.228072
3    8192.0   2.834015   6.094061   5.137600   3.543656   1.896893   2.869412
4   16384.0   5.100572   8.027247   5.555512   4.124473   2.019773   3.282882
5   32768.0  10.002346   9.558086   7.120288   8.574248   2.766520   2.621560
6   65536.0  19.805994  13.587932  19.679615  13.834516   5.520906   5.190345
7  131072.0  39.611923  20.402927  64.796738  24.887018  10.949938  10.350510
```

### Memory

```
lce-memory-fwd+bwd-batch2048-dim4096-bf16:
          v        tr_jg       tr_cut     tr_liger       tr_fla          to          toc
0    1024.0   182.817090   134.844434   158.824902   155.031006   142.81709   142.832715
1    2048.0   222.417090   158.456152   190.424902   182.831006   174.41709   174.432715
2    4096.0   301.617090   205.679590   253.624902   253.631738   237.61709   237.632715
3    8192.0   460.017090   300.126465   349.624512   380.027832   364.01709   364.032715
4   16384.0   776.817090   489.020215   541.624512   632.825879   616.81709   616.832715
5   32768.0  1410.417090   866.807715   925.624512  1138.424902  1122.41709  1122.432715
6   65536.0  2677.820215  1622.382715  1693.624512  2165.624902  2133.61709  2133.632715
7  131072.0  5228.407715  3133.532715  3229.624512  4220.024902  4156.01709  4156.032715
```

# Linear Cross Entropy Benchmark

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
lce-speed-fwd+bwd-batch12288-dim4096-bf16:
          v       tr_jg      tr_cut   tr_liger     tr_fla         tr     tr_lce         to        toc
0    1024.0    4.078297    4.794009   3.669127   2.288949   3.907229   3.669052   2.057579   2.401282
1    2048.0    4.747909    7.369968   4.716936   2.945260   4.161751   3.374242   1.768795   3.212397
2    4096.0    6.629996   10.473977   4.820292   3.479271   4.175158   3.784059   2.449810   3.571072
3    8192.0   12.501207   17.892408   7.920928   5.617468   6.732032   4.261653   4.172534   3.615407
4   16384.0   24.626495   30.104202   9.902225   9.424864  10.712789   8.043704   7.742917   7.110281
5   32768.0   48.074368   48.412975  17.576576  16.587263  19.496799  14.394568  15.135734  14.240877
6   65536.0   95.458755   73.290077  35.258125  32.255924  36.671360  28.000000  31.189474  28.706448
7  131072.0  192.097763  111.124542  87.879005  63.352097  71.565788  57.469406  62.297314  61.492481
```

### Memory

```
lce-memory-fwd+bwd-batch12288-dim4096-bf16:
          v        tr_jg       tr_cut     tr_liger       tr_fla           tr      tr_lce            to          toc
0    1024.0   578.895215   371.000684   514.942090   490.987988   499.034863   394.94209    418.895215   418.988965
1    2048.0   618.495215   394.612402   586.542090   538.587988   554.634863   442.54209    490.495215   490.588965
2    4096.0   697.695215   441.835840   729.742090   633.787988   665.834863   537.74209    633.695215   633.788965
3    8192.0   856.095215   536.282715   856.142090   728.172363   792.203613   728.14209    952.095215   920.188965
4   16384.0  1213.006055   725.176465  1108.942090   980.956738  1108.972363  1108.94209   1652.895215  1492.988965
5   32768.0  1982.668555  1102.963965  1486.542090  1486.548926  1742.556738  1870.54209   3054.495215  2638.588965
6   65536.0  3521.993555  1858.538965  2252.939746  2625.748926  3137.756738  3393.74209   5857.695215  4929.788965
7  131072.0  6600.643555  3369.688965  3788.939746  4904.148926  5928.156738  6440.14209  11464.095215  9512.188965
```

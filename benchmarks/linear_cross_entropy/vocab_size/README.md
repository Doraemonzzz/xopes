# Linear Cross Entropy Benchmark

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- tr: Triton(xopes)
- tr_lce: Triton Linear Cross Entropy(xopes)
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
lce-speed-fwd+bwd-batch12288-dim4096-bf16:
          v       tr_jg      tr_cut   tr_liger     tr_fla         tr     tr_lce         to        toc
0    1024.0    2.827156    5.104064   1.439527   3.976874   2.575497   1.588131   1.012235   1.354609
1    2048.0    4.070869    7.304716   3.814716   2.648086   2.623637   2.248194   1.596958   3.140789
2    4096.0    6.596973   10.173011   4.035078   3.171287   3.617968   3.598454   2.457339   3.095068
3    8192.0   12.475631   17.683815   7.004032   5.548038   4.544110   4.718421   4.194214   3.573143
4   16384.0   24.605719   30.325537  10.148324   9.210816   9.196180   8.154720   7.690728   7.181344
5   32768.0   47.976097   48.519810  17.887890  16.990503  16.969727  14.496549  15.101898  13.871040
6   65536.0   95.671005   72.826782  38.810528  32.179146  31.754448  28.873888  31.081612  28.860321
7  131072.0  193.659805  111.634590  87.322594  62.995617  62.909088  57.361343  63.087265  60.863743
```

### Memory

```
lce-memory-fwd+bwd-batch12288-dim4096-bf16:
          v        tr_jg       tr_cut     tr_liger       tr_fla           tr      tr_lce            to          toc
0    1024.0   578.895215   371.000684   514.942090   490.987988   491.034863   394.94209    418.895215   418.988965
1    2048.0   618.495215   394.612402   586.542090   538.587988   538.634863   442.54209    490.495215   490.588965
2    4096.0   697.695215   441.835840   729.742090   633.787988   633.834863   537.74209    633.695215   633.788965
3    8192.0   856.095215   536.282715   856.142090   728.172363   728.203613   728.14209    952.095215   920.188965
4   16384.0  1213.006055   725.176465  1108.942090   980.956738   980.972363  1108.94209   1652.895215  1492.988965
5   32768.0  1982.668555  1102.963965  1486.542090  1486.548926  1486.556738  1870.54209   3054.495215  2638.588965
6   65536.0  3521.993555  1858.538965  2252.939746  2625.748926  2625.756738  3393.74209   5857.695215  4929.788965
7  131072.0  6600.643555  3369.688965  3788.939746  4904.148926  4904.156738  6440.14209  11464.095215  9512.188965
```

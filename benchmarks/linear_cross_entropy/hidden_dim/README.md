# Linear Cross Entropy Benchmark

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- tr: Triton(xopes)
- tr_lce: Triton Linear Cross Entropy(xopes)
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
lce-speed-fwd+bwd-batch2048-v131072-bf16:
         d       tr_jg     tr_cut    tr_liger     tr_fla         tr     tr_lce         to        toc
0    512.0    6.578692   6.705226  126.106979   7.452411   6.061259   3.117604   3.070924   2.861584
1   1024.0   11.084149   8.219711   92.796928   9.663456  11.581505   4.648815   4.108530   3.238816
2   2048.0   20.462481  11.183120   82.012032  13.536173  13.031478   7.731306   6.210944   5.339988
3   4096.0   39.677921  20.587503   64.772575  24.135025  24.444626  10.794080  11.050336  10.055264
4   8192.0   75.853027  40.270817   62.358879  43.359535  43.013184  20.457968  20.859093  19.964705
5  16384.0  147.071335  86.210335   67.288445  84.347137  84.057343  42.203423  39.911392  39.918205

```

### Memory

```
lce-memory-fwd+bwd-batch2048-v131072-bf16:
         d         tr_jg        tr_cut      tr_liger        tr_fla            tr        tr_lce           to           toc
0    512.0   1633.688965    449.032715    459.724512    639.524902    639.525879    959.524902   1853.51709   1471.532715
1   1024.0   2147.220215    832.532715    855.424512   1151.024902   1151.025879   1343.024902   2107.01709   1855.032715
2   2048.0   3174.282715   1599.532715   1646.824512   2174.024902   2174.025879   2110.024902   2622.01709   2622.032715
3   4096.0   5228.407715   3133.532715   3229.624512   4220.024902   4220.025879   3644.024902   4156.01709   4156.032715
4   8192.0  10360.017090   6201.532715   6395.224512   8312.024902   8312.025879   6712.024902   7224.01709   7224.032715
5  16384.0  20656.017090  12337.532715  12726.424512  16496.024902  16496.025879  12848.024902  13360.01709  13360.032715
```

# Linear Cross Entropy Benchmark

## Notation

- tr_jg: Triton JG
- tr_cut: Triton Cut
- tr_liger: Triton Liger
- tr_fla: Triton FLA
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
lce-speed-fwd+bwd-batch2048-v65536-bf16:
         d      tr_jg     tr_cut   tr_liger     tr_fla         to        toc
0    512.0   3.353426   5.203349  44.289886   5.547855   1.598353   1.139196
1   1024.0   5.611532   4.975407  29.691946   5.090441   2.099369   1.557699
2   2048.0  10.348551   7.860499  20.984896   8.746917   3.202541   2.696209
3   4096.0  19.903492  13.429819  18.655167  13.197403   5.564978   5.107808
4   8192.0  38.209873  26.810209  18.658367  22.817135  10.449287  10.034649
5  16384.0  74.468063  56.523041  26.682869  32.139923  20.809736  20.295456
```

### Memory

```
lce-memory-fwd+bwd-batch2048-v65536-bf16:
         d         tr_jg       tr_cut     tr_liger       tr_fla          to          toc
0    512.0    852.810840   259.482715   267.724512   354.724902   960.71709   770.732715
1   1024.0   1113.526465   454.182715   471.424512   613.424902  1089.41709   965.432715
2   2048.0   1634.957715   843.582715   878.824512  1130.824902  1354.81709  1354.832715
3   4096.0   2677.820215  1622.382715  1693.624512  2165.624902  2133.61709  2133.632715
4   8192.0   5291.217090  3179.982715  3323.224512  4235.224902  3691.21709  3691.232715
5  16384.0  10518.417090  6295.182715  6582.424512  8406.425879  6806.41709  6806.432715
```

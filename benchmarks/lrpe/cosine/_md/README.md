# Benchmark

## Notation

- Tri: Triton
- Tri Ca: Triton Cache
- Tor: Torch
- Tor C: Torch Compile

$-1$ indicate error.

## A800

### 1d

1d version, sequence length is $n$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-1d-l0:
         n       Tri    Tri Ca        Tor     Tor C
0    256.0  0.163323  0.169270   0.411781  0.206048
1    512.0  0.198294  0.202130   0.610906  0.330625
2   1024.0  0.250804  0.265823   0.920157  0.431945
3   2048.0  0.398941  0.386600   1.662961  0.700253
4   4096.0  0.621821  0.638041   3.188930  1.262792
5   8192.0  1.115549  1.152078   6.179524  2.382696
6  16384.0  2.078264  2.142212  12.185967  4.660357
7  32768.0  4.064563  4.196456  24.382385  9.197300

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-1d-l0:
         n          Tri       Tri Ca           Tor        Tor C
0    256.0    36.019043    37.519043     96.022949    37.520996
1    512.0    72.019043    75.019043    192.026855    75.022949
2   1024.0   144.019043   150.019043    384.034668   150.026855
3   2048.0   288.019043   300.019043    768.050293   300.034668
4   4096.0   576.019043   600.019043   1536.081543   600.050293
5   8192.0  1152.019043  1200.019043   3072.144043  1200.081543
6  16384.0  2304.019043  2400.019043   6144.269043  2400.144043
7  32768.0  4608.019043  4800.019043  12288.519043  4800.269043

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-1d-l0:
         n       Tri    Tri Ca        Tor     Tor C
0    256.0  0.155535  0.176801   0.250497  0.054322
1    512.0  0.099048  0.096647   0.507157  0.091144
2   1024.0  0.192676  0.181977   0.990053  0.168388
3   2048.0  0.377653  0.354661   2.035642  0.352043
4   4096.0  0.746958  0.699928   4.006361  0.711934
5   8192.0  1.484754  1.389856   7.940115  1.406732
6  16384.0  2.961293  2.769722  15.862609  2.796264
7  32768.0  5.960190  5.550381  31.715530  5.612435

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-1d-l0:
         n          Tri       Tri Ca           Tor        Tor C
0    256.0    71.569043    73.069043    137.568555    73.068555
1    512.0   143.119043   146.119043    275.118555   146.118555
2   1024.0   286.219043   292.219043    550.218555   292.218555
3   2048.0   572.419043   584.419043   1100.418555   584.418555
4   4096.0  1144.819043  1168.819043   2200.818555  1168.818555
5   8192.0  2289.619043  2337.619043   4401.618555  2337.618555
6  16384.0  4579.219043  4675.219043   8803.218555  4675.218555
7  32768.0  9158.419043  9350.419043  17606.418555  9350.418555
```

num extra token $l=10$.
```
md_lrpe_cosine-speed-fwd-batch12-head12-dim128-bf16-1d-l10:
         n       Tri    Tri Ca        Tor     Tor C
0    256.0  0.161740  0.176735   0.494068  0.217221
1    512.0  0.196041  0.203490   0.706712  0.286963
2   1024.0  0.261750  0.269903   1.142890  0.435442
3   2048.0  0.378753  0.392495   2.091678  0.751403
4   4096.0  0.618155  0.645080   3.970725  1.318363
5   8192.0  1.103000  1.140384   7.750456  2.529507
6  16384.0  2.078072  2.135825  15.363130  4.865615
7  32768.0  4.002055  4.128171  30.654634  9.600323

md_lrpe_cosine-memory-fwd-batch12-head12-dim128-bf16-1d-l10:
         n          Tri       Tri Ca           Tor        Tor C
0    256.0    37.425293    38.983887     99.429199    38.927246
1    512.0    73.425293    76.483887    195.433105    76.429199
2   1024.0   145.425293   151.483887    387.440918   151.433105
3   2048.0   289.425293   301.483887    771.456543   301.440918
4   4096.0   577.425293   601.483887   1539.487793   601.456543
5   8192.0  1153.425293  1201.483887   3075.550293  1201.487793
6  16384.0  2305.425293  2401.483887   6147.675293  2401.550293
7  32768.0  4609.425293  4801.483887  12291.925293  4801.675293

md_lrpe_cosine-speed-bwd-batch12-head12-dim128-bf16-1d-l10:
         n       Tri    Tri Ca        Tor     Tor C
0    256.0  0.188331  0.192933   0.356172  0.086092
1    512.0  0.158702  0.122787   0.699061  0.123608
2   1024.0  0.231324  0.217040   1.332433  0.231511
3   2048.0  0.449422  0.419841   2.667959  0.456874
4   4096.0  0.886010  0.825570   5.222587  0.903714
5   8192.0  1.758219  1.636102  10.339890  1.782116
6  16384.0  3.504004  3.258821  20.639328  3.538119
7  32768.0  6.994319  6.503753  41.275406  7.053078

md_lrpe_cosine-memory-bwd-batch12-head12-dim128-bf16-1d-l10:
         n          Tri       Tri Ca           Tor        Tor C
0    256.0    75.183105    76.741699    142.732617    76.682617
1    512.0   147.183105   150.241699    279.688867   150.182617
2   1024.0   292.081152   298.139746    556.614648   298.080664
3   2048.0   579.183105   591.241699   1105.582617   591.182617
4   4096.0  1155.183105  1179.241699   2205.982617  1179.182617
5   8192.0  2307.183105  2355.241699   4406.188867  2355.182617
6  16384.0  4611.183105  4707.241699   8808.382617  4707.182617
7  32768.0  9219.183105  9411.241699  17611.582617  9411.182617
```

### 2d

2d version, sequence length is $n^2$.

#### num extra token $l=0$

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l0:
       n       Tri    Tri Ca        Tor     Tor C
0   16.0  0.199809  0.215933   0.498463  0.279577
1   32.0  0.359758  0.411124   1.017542  0.465304
2   64.0  0.805380  0.901795   3.202355  1.361766
3  128.0  2.755846  3.075391  12.225448  4.694922

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l0:
       n       Tri    Tri Ca        Tor      Tor C
0   16.0  0.160891  0.155499   0.292066   0.288101
1   32.0  0.231845  0.227697   1.081085   0.988746
2   64.0  0.905362  0.699138   4.003807   4.005084
3  128.0  3.595492  2.769368  15.863205  15.873685

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l0:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    36.005859    37.505859    96.010742    96.010742
1   32.0   144.005859   150.005859   384.022461   384.022461
2   64.0   576.005859   600.005859  1536.069336  1536.069336
3  128.0  2304.005859  2400.005859  6144.257812  6144.257812

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l0:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    71.555371    73.055371   137.554883   137.554883
1   32.0   286.205371   292.205371   550.204883   550.204883
2   64.0  1144.805371  1168.805371  2200.804883  2200.804883
3  128.0  4579.205371  4675.205371  8803.204883  8803.204883
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l0:
       n       Tri    Tri Ca        Tor     Tor C
0   16.0  0.227799  0.201259   0.475247  0.267269
1   32.0  0.340722  0.365617   1.019625  0.567589
2   64.0  1.019286  1.099826   3.384970  1.682842
3  128.0  3.098082  3.540242  13.003602  6.438084

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l0:
       n       Tri    Tri Ca        Tor      Tor C
0   16.0  0.138216  0.124767   0.267022   0.266955
1   32.0  0.269087  0.205810   1.061927   1.062073
2   64.0  1.056438  0.789354   4.278963   4.279146
3  128.0  4.200010  3.112641  16.945023  16.954124

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l0:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    36.005859    37.505859   105.010742   113.092773
1   32.0   144.005859   150.005859   420.022461   420.022461
2   64.0   576.005859   600.005859  1680.069336  1680.069336
3  128.0  2304.005859  2400.005859  6720.257812  6720.257812

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l0:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    71.555371    73.055371   137.554883   137.554883
1   32.0   286.205371   292.205371   550.204883   550.204883
2   64.0  1144.805371  1168.805371  2200.804883  2200.804883
3  128.0  4579.205371  4675.205371  8803.204883  8803.204883
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l0:
       n       Tri    Tri Ca        Tor     Tor C
0   16.0  0.202547  0.224836   0.470740  0.334324
1   32.0  0.399267  0.431156   1.016738  0.613148
2   64.0  0.993339  1.131957   3.462641  2.227787
3  128.0  3.505010  3.670649  13.170015  7.492828

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l0:
       n       Tri    Tri Ca        Tor      Tor C
0   16.0  0.246125  0.196571   0.280376   0.271703
1   32.0  0.299124  0.230371   1.133222   1.058242
2   64.0  1.383300  0.896733   4.546230   4.261481
3  128.0  4.687991  3.555135  17.994394  16.875624

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l0:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    36.005371    37.505371   105.010254   105.010254
1   32.0   144.005371   150.005371   420.021973   420.021973
2   64.0   576.005371   600.005371  1680.068848  1680.068848
3  128.0  2304.005371  2400.005371  6720.257324  6720.257324

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l0:
       n          Tri       Tri Ca         Tor       Tor C
0   16.0    71.553418    73.053418   146.55293   146.55293
1   32.0   286.203418   292.203418   586.20293   586.20293
2   64.0  1144.803418  1168.803418  2344.80293  2344.80293
3  128.0  4579.203418  4675.203418  9379.20293  9379.20293
```

#### num extra token $l=10$

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l10:
       n       Tri    Tri Ca        Tor     Tor C
0   16.0  0.201888  0.237329   0.637960  0.283476
1   32.0  0.316179  0.438479   1.314310  0.480947
2   64.0  0.809384  0.896831   4.002505  1.369084
3  128.0  2.754732  3.062403  15.480998  4.959208

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l10:
       n       Tri    Tri Ca        Tor      Tor C
0   16.0  0.179166  0.166121   0.423290   0.389305
1   32.0  0.268525  0.259991   1.499628   1.335242
2   64.0  1.032014  0.825296   5.226072   5.226335
3  128.0  4.085828  3.258903  20.647217  20.647217

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l10:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    37.412109    38.970703    98.823242    98.823242
1   32.0   145.412109   151.470703   386.834961   386.834961
2   64.0   577.412109   601.470703  1538.881836  1538.881836
3  128.0  2305.412109  2401.470703  6147.664062  6147.664062

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_none-dim_None-bf16-2d-l10:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    75.169434    76.728027   142.125195   142.125195
1   32.0   291.169434   297.228027   555.478320   555.478320
2   64.0  1155.169434  1179.228027  2205.375195  2205.375195
3  128.0  4611.169434  4707.228027  8808.368945  8808.368945
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l10:
       n       Tri    Tri Ca        Tor     Tor C
0   16.0  0.206491  0.235081   0.607597  0.327648
1   32.0  0.346296  0.371659   1.257957  0.656475
2   64.0  0.915261  0.944212   4.194705  1.965028
3  128.0  3.154742  3.249512  16.305738  7.306746

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l10:
       n       Tri    Tri Ca        Tor      Tor C
0   16.0  0.149928  0.151309   0.375829   0.374610
1   32.0  0.310670  0.242808   1.409516   1.409388
2   64.0  1.198582  0.919389   5.503781   5.503369
3  128.0  4.750659  3.633093  21.749527  21.743889

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l10:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    37.412109    38.970703   108.174805   108.174805
1   32.0   145.412109   151.470703   423.186523   423.186523
2   64.0   577.412109   601.470703  1683.233398  1683.233398
3  128.0  2305.412109  2401.470703  6724.015625  6724.015625

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-2d-l10:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    75.169434    76.728027   142.125195   142.125195
1   32.0   291.169434   297.228027   555.478320   555.478320
2   64.0  1155.169434  1179.228027  2205.375195  2205.375195
3  128.0  4611.169434  4707.228027  8808.368945  8808.368945
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l10:
       n       Tri    Tri Ca        Tor     Tor C
0   16.0  0.221669  0.223413   0.561946  0.339637
1   32.0  0.437414  0.430765   1.374232  0.775856
2   64.0  1.052364  1.192755   4.333516  2.374566
3  128.0  3.586001  3.685871  16.372576  8.583646

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l10:
       n       Tri    Tri Ca        Tor      Tor C
0   16.0  0.174016  0.141343   0.415716   0.407060
1   32.0  0.400932  0.312747   1.499202   1.404652
2   64.0  1.391750  1.213373   5.769217   5.480206
3  128.0  5.238639  4.167271  22.795687  21.664303

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l10:
       n          Tri       Tri Ca          Tor        Tor C
0   16.0    37.411621    38.970215   108.174316   108.174316
1   32.0   145.411621   151.470215   423.186035   423.186035
2   64.0   577.411621   601.470215  1683.232910  1683.232910
3  128.0  2305.411621  2401.470215  6724.015137  6724.015137

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-2d-l10:
       n         Tri       Tri Ca          Tor        Tor C
0   16.0    75.16748    76.726074   151.474805   151.474805
1   32.0   291.16748   297.226074   591.827930   591.827930
2   64.0  1155.16748  1179.226074  2349.724805  2349.724805
3  128.0  4611.16748  4707.226074  9384.124805  9384.124805
```

### 3d

3d version, sequence length is $n^3$.

#### num extra token $l=0$

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l0:
      n       Tri    Tri Ca        Tor      Tor C
0   4.0  0.206441  0.204932   0.440647   0.570023
1   8.0  0.280841  0.318225   0.749783   0.838036
2  16.0  1.116099  1.151911   3.272241   3.384736
3  32.0  7.654581  7.997602  24.596104  24.629471

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l0:
      n       Tri    Tri Ca        Tor      Tor C
0   4.0  0.219355  0.134133   0.103891   0.089619
1   8.0  0.156349  0.127528   0.507188   0.507209
2  16.0  1.210086  0.699238   4.003585   4.003652
3  32.0  9.622641  5.531624  31.715818  31.708139

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l0:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0     9.005859     9.380859     24.011719     24.011719
1   8.0    72.005859    75.005859    192.065918    192.065918
2  16.0   576.005859   600.005859   1536.288574   1536.288574
3  32.0  4608.005859  4800.005859  12290.257324  12290.257324

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l0:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    17.892871    18.267871     34.392383     34.392383
1   8.0   143.105371   146.105371    275.128320    275.128320
2  16.0  1144.805371  1168.805371   2200.804883   2200.804883
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l0:
      n       Tri    Tri Ca        Tor      Tor C
0   4.0  0.180777  0.195382   0.447338   0.335569
1   8.0  0.278466  0.310561   0.724270   0.402979
2  16.0  1.178895  1.221776   3.536786   1.666210
3  32.0  8.275805  8.575550  26.265610  26.009558

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l0:
      n        Tri    Tri Ca        Tor      Tor C
0   4.0   0.154745  0.132869   0.096364   0.096527
1   8.0   0.176332  0.139518   0.547612   0.547191
2  16.0   1.372347  0.789294   4.280591   4.280420
3  32.0  10.910995  6.215049  33.887009  33.896240

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l0:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0     9.005859     9.380859     26.261719     26.261719
1   8.0    72.005859    75.005859    210.065918    210.065918
2  16.0   576.005859   600.005859   1680.288574   1680.288574
3  32.0  4608.005859  4800.005859  13442.257324  13442.257324

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l0:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    17.892871    18.267871     34.392383     34.392383
1   8.0   143.105371   146.105371    275.128320    275.128320
2  16.0  1144.805371  1168.805371   2200.804883   2200.804883
3  32.0  9158.405371  9350.405371  17606.404883  17606.404883
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l0:
      n       Tri     Tri Ca        Tor      Tor C
0   4.0  0.181446   0.192779   0.448508   0.334808
1   8.0  0.289206   0.315084   0.709701   0.456018
2  16.0  1.310559   1.421409   3.514115   1.963952
3  32.0  9.199401  10.203762  26.484566  26.006655

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l0:
      n        Tri    Tri Ca        Tor      Tor C
0   4.0   0.163801  0.114980   0.106815   0.239091
1   8.0   0.191334  0.133465   0.583767   0.541243
2  16.0   1.770005  0.897012   4.547621   4.262832
3  32.0  11.917061  7.236236  35.997055  33.742958

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l0:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0     9.005371     9.380371     26.261230     26.261230
1   8.0    72.005371    75.005371    210.065430    210.065430
2  16.0   576.005371   600.005371   1680.288086   1680.288086
3  32.0  4608.005371  4800.005371  13442.256836  13442.256836

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l0:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    17.890918    18.265918     36.640430     36.640430
1   8.0   143.103418   146.103418    293.126367    293.126367
2  16.0  1144.803418  1168.803418   2344.802930   2344.802930
3  32.0  9158.403418  9350.403418  18758.402930  18758.402930
```

#### num extra token $l=10$

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l10:
      n       Tri    Tri Ca        Tor      Tor C
0   4.0  0.188706  0.195346   0.511784   0.665729
1   8.0  0.279641  0.306740   0.834740   0.954573
2  16.0  1.164781  1.226964   4.266176   4.369743
3  32.0  8.176625  8.603075  32.611340  32.499573

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l10:
      n        Tri    Tri Ca        Tor      Tor C
0   4.0   0.145344  0.148059   0.200230   0.194986
1   8.0   0.201982  0.157135   0.739367   0.740753
2  16.0   1.501695  0.919137   5.503637   5.501338
3  32.0  11.898485  7.245627  43.444386  43.447311

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l10:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    10.412109    10.845703     29.425781     29.425781
1   8.0    73.412109    76.470703    213.870605    213.870605
2  16.0   577.412109   601.470703   1683.452637   1683.452637
3  32.0  4609.412109  4801.470703  13446.015137  13446.015137

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_silu-dim_None-bf16-3d-l10:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    21.661621    22.095215     39.103320     39.103320
1   8.0   147.169434   150.228027    280.401758    280.401758
2  16.0  1155.169434  1179.228027   2205.375195   2205.375195
3  32.0  9219.169434  9411.228027  17611.568945  17611.568945
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l10:
      n       Tri    Tri Ca        Tor      Tor C
0   4.0  0.183939  0.194868   0.484043   0.622748
1   8.0  0.274964  0.332284   0.906592   0.960155
2  16.0  1.118021  1.173060   4.107378   4.208261
3  32.0  7.747096  8.038627  31.104437  30.903658

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l10:
      n        Tri    Tri Ca        Tor      Tor C
0   4.0   0.153140  0.153023   0.185743   0.187912
1   8.0   0.179005  0.151930   0.771194   0.699817
2  16.0   1.330074  0.825320   5.226236   5.225561
3  32.0  10.535723  6.501351  41.271633  41.271233

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l10:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    10.412109    10.845703     27.316406     27.316406
1   8.0    73.412109    76.470703    195.519043    195.519043
2  16.0   577.412109   601.470703   1539.101074   1539.101074
3  32.0  4609.412109  4801.470703  12293.663574  12293.663574

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_none-dim_None-bf16-3d-l10:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    21.661621    22.095215     40.298633     40.298633
1   8.0   147.169434   150.228027    280.401758    280.401758
2  16.0  1155.169434  1179.228027   2205.375195   2205.375195
3  32.0  9219.169434  9411.228027  17611.568945  17611.568945
```

```
lrpe_cosine_md-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l10:
      n       Tri     Tri Ca        Tor      Tor C
0   4.0  0.210395   0.187845   0.495883   0.750268
1   8.0  0.294642   0.322620   0.849966   1.092757
2  16.0  1.327934   1.446113   4.318391   4.397472
3  32.0  9.295934  10.400601  32.834270  32.564800

lrpe_cosine_md-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l10:
      n        Tri    Tri Ca        Tor      Tor C
0   4.0   0.156950  0.166012   0.241361   0.382014
1   8.0   0.266019  0.228537   0.776851   0.733402
2  16.0   1.640362  1.213383   5.770793   5.481942
3  32.0  13.000654  8.080424  45.560207  43.301231

lrpe_cosine_md-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l10:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    10.411621    10.845215     29.425293     29.425293
1   8.0    73.411621    76.470215    213.870117    213.870117
2  16.0   577.411621   601.470215   1683.452148   1683.452148
3  32.0  4609.411621  4801.470215  13446.014648  13446.014648

lrpe_cosine_md-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16-3d-l10:
      n          Tri       Tri Ca           Tor         Tor C
0   4.0    21.659668    22.093262     42.406055     42.406055
1   8.0   147.167480   150.226074    298.048242    298.048242
2  16.0  1155.167480  1179.226074   2349.724805   2349.724805
3  32.0  9219.167480  9411.226074  18763.918555  18763.918555
```

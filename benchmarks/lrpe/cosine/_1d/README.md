# A800

## Summary

In summary, use `Triton Bp` when `dim=-2` and `act=softmax`; otherwise, use `Triton Sp`.

## Notation

- Tr: Triton
- To: Torch
- Toc: Torch Compile


## No Act

```
lrpe_cosine-speed-fwd-batch12-head12-dim128-act_none-bf16:
         n        tr         to       toc
0    256.0  0.038915   0.135323  0.074762
1    512.0  0.050502   0.237365  0.159553
2   1024.0  0.094652   0.434426  0.110080
3   2048.0  0.183408   0.852795  0.205744
4   4096.0  0.360271   1.779803  0.404172
5   8192.0  0.714578   3.529024  0.803458
6  16384.0  1.423618   7.023886  1.596550
7  32768.0  2.846511  14.034259  3.197198

lrpe_cosine-memory-fwd-batch12-head12-dim128-act_none-bf16:
         n          tr            to         toc
0    256.0    27.00293     85.504883    27.00293
1    512.0    54.00293    171.006836    54.00293
2   1024.0   108.00293    342.010742   108.00293
3   2048.0   216.00293    684.018555   216.00293
4   4096.0   432.00293   1368.034180   432.00293
5   8192.0   864.00293   2736.065430   864.00293
6  16384.0  1728.00293   5472.127930  1728.00293
7  32768.0  3456.00293  10944.252930  3456.00293

lrpe_cosine-speed-bwd-batch12-head12-dim128-act_none-bf16:
         n        tr         to       toc
0    256.0  0.892433   0.653582  0.780566
1    512.0  0.749572   0.873137  1.325391
2   1024.0  0.738031   0.817791  1.243769
3   2048.0  0.789065   0.920332  0.784201
4   4096.0  0.758846   1.853636  1.070256
5   8192.0  1.004918   3.669726  0.987935
6  16384.0  2.003019   7.323011  1.333602
7  32768.0  4.008082  14.635728  2.667443

lrpe_cosine-memory-bwd-batch12-head12-dim128-act_none-bf16:
         n          tr           to         toc
0    256.0    62.55293    128.55293    62.55293
1    512.0   125.10293    257.10293   125.10293
2   1024.0   250.20293    514.20293   250.20293
3   2048.0   500.40293   1028.40293   500.40293
4   4096.0  1000.80293   2056.80293  1000.80293
5   8192.0  2001.60293   4113.60293  2001.60293
6  16384.0  4003.20293   8227.20293  4003.20293
7  32768.0  8006.40293  16454.40293  8006.40293
```

## Silu

```
lrpe_cosine-speed-fwd-batch12-head12-dim128-act_silu-bf16:
         n        tr         to       toc
0    256.0  0.052078   0.143014  0.124108
1    512.0  0.051824   0.253165  0.172543
2   1024.0  0.094965   0.468094  0.140644
3   2048.0  0.183552   0.909862  0.274813
4   4096.0  0.360523   1.888263  0.542890
5   8192.0  0.714954   3.745716  1.079418
6  16384.0  1.424088   7.452000  2.155100
7  32768.0  2.849161  14.887168  4.311257

lrpe_cosine-memory-fwd-batch12-head12-dim128-act_silu-bf16:
         n          tr            to         toc
0    256.0    27.00293     94.504883    27.00293
1    512.0    54.00293    189.006836    54.00293
2   1024.0   108.00293    378.010742   108.00293
3   2048.0   216.00293    756.018555   216.00293
4   4096.0   432.00293   1512.034180   432.00293
5   8192.0   864.00293   3024.065430   864.00293
6  16384.0  1728.00293   6048.127930  1728.00293
7  32768.0  3456.00293  12096.252930  3456.00293

lrpe_cosine-speed-bwd-batch12-head12-dim128-act_silu-bf16:
         n        tr         to       toc
0    256.0  0.397963   0.764443  1.149779
1    512.0  0.844988   0.994783  0.823743
2   1024.0  0.859389   1.067085  1.321444
3   2048.0  0.886739   1.180994  0.964871
4   4096.0  0.730776   2.000495  1.334038
5   8192.0  1.004501   3.964347  0.755458
6  16384.0  2.002919   7.907209  1.502192
7  32768.0  4.011709  15.797435  3.006414

lrpe_cosine-memory-bwd-batch12-head12-dim128-act_silu-bf16:
         n          tr           to         toc
0    256.0    62.55293    128.55293    62.55293
1    512.0   125.10293    257.10293   125.10293
2   1024.0   250.20293    514.20293   250.20293
3   2048.0   500.40293   1028.40293   500.40293
4   4096.0  1000.80293   2056.80293  1000.80293
5   8192.0  2001.60293   4113.60293  2001.60293
6  16384.0  4003.20293   8227.20293  4003.20293
7  32768.0  8006.40293  16454.40293  8006.40293
```

## Softmax on feature
```
lrpe_cosine-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr         to       toc
0    256.0  0.042549   0.147464  0.109926
1    512.0  0.051697   0.261608  0.162990
2   1024.0  0.096455   0.477842  0.187575
3   2048.0  0.184794   0.928584  0.362894
4   4096.0  0.361489   1.917628  0.710707
5   8192.0  0.715897   3.797240  1.406432
6  16384.0  1.423792   7.554753  2.796528
7  32768.0  2.853308  15.088554  5.580700

lrpe_cosine-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n          tr            to         toc
0    256.0    27.00293     94.504883    27.28418
1    512.0    54.00293    189.006836    54.56543
2   1024.0   108.00293    378.010742   109.12793
3   2048.0   216.00293    756.018555   218.25293
4   4096.0   432.00293   1512.034180   436.50293
5   8192.0   864.00293   3024.065430   873.00293
6  16384.0  1728.00293   6048.127930  1746.00293
7  32768.0  3456.00293  12096.252930  3492.00293

lrpe_cosine-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr         to       toc
0    256.0  0.313055   0.239235  0.161162
1    512.0  0.233693   0.316928  0.434316
2   1024.0  0.263670   0.535526  0.510665
3   2048.0  0.431066   1.073709  0.443714
4   4096.0  0.591323   2.153346  1.131462
5   8192.0  1.005709   4.267147  1.391844
6  16384.0  2.004102   8.501195  1.596729
7  32768.0  4.018205  16.990253  3.198860

lrpe_cosine-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n          tr           to         toc
0    256.0    62.55293    137.55293    62.83418
1    512.0   125.10293    275.10293   125.66543
2   1024.0   250.20293    550.20293   251.32793
3   2048.0   500.40293   1100.40293   502.65293
4   4096.0  1000.80293   2200.80293  1005.30293
5   8192.0  2001.60293   4401.60293  2010.60293
6  16384.0  4003.20293   8803.20293  4021.20293
7  32768.0  8006.40293  17606.40293  8042.40293
```

## Softmax on sequence
```
lrpe_cosine-speed-fwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n        tr         to       toc
0    256.0  0.206852   0.377568  0.184989
1    512.0  0.230181   2.155447  0.116646
2   1024.0  0.219043   1.821312  0.210466
3   2048.0  0.300532   3.610626  0.398023
4   4096.0  0.579698   7.270983  0.771909
5   8192.0  1.141397  14.511803  1.524573
6  16384.0  2.264385  28.963531  3.029501
7  32768.0  4.519954  57.745407  6.049438

lrpe_cosine-memory-fwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n           tr            to          toc
0    256.0    36.143555    112.504883    27.143555
1    512.0    72.143555    225.006836    54.143555
2   1024.0   144.143555    450.010742   108.143555
3   2048.0   288.143555    900.018555   216.143555
4   4096.0   576.143555   1800.034180   432.143555
5   8192.0  1152.143555   3600.065430   864.143555
6  16384.0  2304.143555   7200.127930  1728.143555
7  32768.0  4608.143555  14400.252930  3456.143555

lrpe_cosine-speed-bwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n        tr         to       toc
0    256.0  1.768678   1.131631  0.544332
1    512.0  0.577037   1.124929  1.483335
2   1024.0  1.023536   1.248666  1.363140
3   2048.0  1.310781   2.470855  0.764048
4   4096.0  1.243404   4.959481  1.419921
5   8192.0  1.697327   9.865181  1.558271
6  16384.0  3.266223  19.661043  2.808820
7  32768.0  6.519223  39.018654  5.608158

lrpe_cosine-memory-bwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n            tr           to           toc
0    256.0     80.763867    146.55293     80.763867
1    512.0    161.313867    293.10293    161.313867
2   1024.0    322.413867    586.20293    322.413867
3   2048.0    644.613867   1172.40293    644.613867
4   4096.0   1289.013867   2344.80293   1289.013867
5   8192.0   2577.813867   4689.60293   2577.813867
6  16384.0   5155.413867   9379.20293   5155.413867
7  32768.0  10310.613867  18758.40293  10310.613867
```

# A800

## Summary

In summary, use `Triton Bp` when `dim=-2` and `act=softmax`; otherwise, use `Triton Sp`.

## Notation

- Tr: Triton
- To: Torch
- Toc: Torch Compile


## No Act

```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_none-bf16:
         n        tr         to       toc
0    256.0  0.045846   0.332998  0.071191
1    512.0  0.055919   0.486208  0.082755
2   1024.0  0.095553   0.443752  0.114067
3   2048.0  0.183438   0.824325  0.219767
4   4096.0  0.361002   1.620257  0.432477
5   8192.0  0.714818   3.391012  0.858110
6  16384.0  1.423326   6.746258  1.712744
7  32768.0  2.840099  13.426053  3.416119

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_none-bf16:
         n           tr           to          toc
0    256.0    18.001465    57.753418    18.001465
1    512.0    36.001465   116.005371    36.001465
2   1024.0    72.001465   231.009277    72.001465
3   2048.0   144.001465   462.017090   144.001465
4   4096.0   288.001465   924.032715   288.001465
5   8192.0   576.001465  1848.063965   576.001465
6  16384.0  1152.001465  3696.126465  1152.001465
7  32768.0  2304.001465  7392.251465  2304.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_none-bf16:
         n        tr         to       toc
0    256.0  0.339264   0.527084  0.378100
1    512.0  1.021195   1.115530  0.929123
2   1024.0  0.334019   0.503271  0.509939
3   2048.0  0.704534   1.323264  1.042048
4   4096.0  0.745210   1.900499  0.966108
5   8192.0  1.007579   3.829195  1.492001
6  16384.0  2.005597   7.593398  2.291344
7  32768.0  4.005856  15.168432  4.572882

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_none-bf16:
         n           tr            to          toc
0    256.0    44.551465     88.051465    44.551465
1    512.0    89.101465    176.601465    89.101465
2   1024.0   178.201465    352.201465   178.201465
3   2048.0   356.401465    704.401465   356.401465
4   4096.0   712.801465   1408.801465   712.801465
5   8192.0  1425.601465   2817.601465  1425.601465
6  16384.0  2851.201465   5635.201465  2851.201465
7  32768.0  5702.401465  11270.401465  5702.401465
```

## Silu

```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_silu-bf16:
         n        tr         to       toc
0    256.0  0.042762   0.157381  0.070749
1    512.0  0.050898   0.260329  0.086739
2   1024.0  0.095277   0.477796  0.142627
3   2048.0  0.183428   0.885314  0.278772
4   4096.0  0.361119   1.737294  0.549402
5   8192.0  0.715114   3.614762  1.093269
6  16384.0  1.423742   7.170550  2.178470
7  32768.0  2.840819  14.290870  4.351795

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_silu-bf16:
         n           tr           to          toc
0    256.0    18.001465    66.753418    18.001465
1    512.0    36.001465   134.005371    36.001465
2   1024.0    72.001465   267.009277    72.001465
3   2048.0   144.001465   534.017090   144.001465
4   4096.0   288.001465  1068.032715   288.001465
5   8192.0   576.001465  2136.063965   576.001465
6  16384.0  1152.001465  4272.126465  1152.001465
7  32768.0  2304.001465  8544.251465  2304.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_silu-bf16:
         n        tr         to       toc
0    256.0  0.296087   0.439441  0.248525
1    512.0  0.604423   0.860829  0.463452
2   1024.0  0.523117   0.826032  0.832085
3   2048.0  0.539771   1.116387  1.295580
4   4096.0  0.505870   2.046040  1.163284
5   8192.0  1.006134   4.121567  1.237266
6  16384.0  2.005046   8.177578  2.467636
7  32768.0  4.003760  16.331371  4.925488

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_silu-bf16:
         n           tr            to          toc
0    256.0    44.551465     88.051465    44.551465
1    512.0    89.101465    176.601465    89.101465
2   1024.0   178.201465    352.201465   178.201465
3   2048.0   356.401465    704.401465   356.401465
4   4096.0   712.801465   1408.801465   712.801465
5   8192.0  1425.601465   2817.601465  1425.601465
6  16384.0  2851.201465   5635.201465  2851.201465
7  32768.0  5702.401465  11270.401465  5702.401465
```

## Softmax on feature
```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr         to       toc
0    256.0  0.051265   0.446868  0.094709
1    512.0  0.052099   0.264536  0.104383
2   1024.0  0.095982   0.483471  0.143081
3   2048.0  0.184436   0.899066  0.273855
4   4096.0  0.361452   1.761979  0.536221
5   8192.0  0.715700   3.663798  1.060916
6  16384.0  1.424742   7.267916  2.109562
7  32768.0  2.842446  14.477620  4.209656

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n           tr           to          toc
0    256.0    18.001465    66.753418    27.001465
1    512.0    36.001465   134.005371    54.001465
2   1024.0    72.001465   267.009277   108.001465
3   2048.0   144.001465   534.017090   216.001465
4   4096.0   288.001465  1068.032715   432.001465
5   8192.0   576.001465  2136.063965   864.001465
6  16384.0  1152.001465  4272.126465  1728.001465
7  32768.0  2304.001465  8544.251465  3456.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr         to       toc
0    256.0  1.051767   1.512398  1.107254
1    512.0  0.985164   1.268811  1.392509
2   1024.0  0.812190   1.542386  1.289469
3   2048.0  0.929885   1.281209  1.419712
4   4096.0  1.070066   2.200369  1.453676
5   8192.0  1.277417   4.422013  1.479814
6  16384.0  2.545619   8.774624  2.316000
7  32768.0  5.085180  17.515026  4.633198

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n           tr            to          toc
0    256.0    44.551465     97.051465    53.551465
1    512.0    89.101465    194.601465   107.101465
2   1024.0   178.201465    388.201465   214.201465
3   2048.0   356.401465    776.401465   428.401465
4   4096.0   712.801465   1552.801465   856.801465
5   8192.0  1425.601465   3105.601465  1713.601465
6  16384.0  2851.201465   6211.201465  3427.201465
7  32768.0  5702.401465  12422.401465  6854.401465
```

## Softmax on sequence
```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n         tr         to       toc
0    256.0   0.239062   0.354586  0.116222
1    512.0   0.498953   0.687829  0.127554
2   1024.0   1.272696   1.622488  0.175886
3   2048.0   2.666223   3.311101  0.335626
4   4096.0   5.309995   6.578117  0.650902
5   8192.0  10.587521  13.270680  1.284258
6  16384.0  21.144768  26.451838  2.551272
7  32768.0  42.214157  52.763424  5.092315

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n           tr           to          toc
0    256.0    27.001465    66.753418    27.001465
1    512.0    54.001465   134.005371    54.001465
2   1024.0   108.001465   267.009277   108.001465
3   2048.0   216.001465   534.017090   216.001465
4   4096.0   432.001465  1068.032715   432.001465
5   8192.0   864.001465  2136.063965   864.001465
6  16384.0  1728.001465  4272.126465  1728.001465
7  32768.0  3456.001465  8544.251465  3456.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n         tr         to       toc
0    256.0   0.919443   1.339475  1.036065
1    512.0   1.085570   1.571390  1.544839
2   1024.0   0.740187   1.428568  0.986855
3   2048.0   1.471992   2.158750  1.294546
4   4096.0   2.920425   4.315938  0.830475
5   8192.0   5.820482   8.642383  1.641035
6  16384.0  11.606989  17.203609  3.261736
7  32768.0  23.192944  34.339710  6.510615

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n           tr            to          toc
0    256.0    71.551465     97.051465    53.621777
1    512.0   143.101465    194.601465   107.171777
2   1024.0   286.201465    388.201465   214.271777
3   2048.0   572.401465    776.401465   428.471777
4   4096.0  1144.801465   1552.801465   856.871777
5   8192.0  2289.601465   3105.601465  1713.671777
6  16384.0  4579.201465   6211.201465  3427.271777
7  32768.0  9158.401465  12422.401465  6854.471777
```

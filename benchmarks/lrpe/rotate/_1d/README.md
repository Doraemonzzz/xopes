# A800

## Notation

- Tr: Triton
- To: Torch
- Toc: Torch Compile


## No Act

```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_none-bf16:
         n        tr         to       toc
0    256.0  0.045846   0.332998  0.071191
1    512.0  0.055919   0.486208  0.082755
2   1024.0  0.095553   0.443752  0.114067
3   2048.0  0.183438   0.824325  0.219767
4   4096.0  0.361002   1.620257  0.432477
5   8192.0  0.714818   3.391012  0.858110
6  16384.0  1.423326   6.746258  1.712744
7  32768.0  2.840099  13.426053  3.416119

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_none-bf16:
         n           tr           to          toc
0    256.0    18.001465    57.753418    18.001465
1    512.0    36.001465   116.005371    36.001465
2   1024.0    72.001465   231.009277    72.001465
3   2048.0   144.001465   462.017090   144.001465
4   4096.0   288.001465   924.032715   288.001465
5   8192.0   576.001465  1848.063965   576.001465
6  16384.0  1152.001465  3696.126465  1152.001465
7  32768.0  2304.001465  7392.251465  2304.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_none-bf16:
         n        tr         to       toc
0    256.0  0.339264   0.527084  0.378100
1    512.0  1.021195   1.115530  0.929123
2   1024.0  0.334019   0.503271  0.509939
3   2048.0  0.704534   1.323264  1.042048
4   4096.0  0.745210   1.900499  0.966108
5   8192.0  1.007579   3.829195  1.492001
6  16384.0  2.005597   7.593398  2.291344
7  32768.0  4.005856  15.168432  4.572882

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_none-bf16:
         n           tr            to          toc
0    256.0    44.551465     88.051465    44.551465
1    512.0    89.101465    176.601465    89.101465
2   1024.0   178.201465    352.201465   178.201465
3   2048.0   356.401465    704.401465   356.401465
4   4096.0   712.801465   1408.801465   712.801465
5   8192.0  1425.601465   2817.601465  1425.601465
6  16384.0  2851.201465   5635.201465  2851.201465
7  32768.0  5702.401465  11270.401465  5702.401465
```

## Silu

```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_silu-bf16:
         n        tr         to       toc
0    256.0  0.042762   0.157381  0.070749
1    512.0  0.050898   0.260329  0.086739
2   1024.0  0.095277   0.477796  0.142627
3   2048.0  0.183428   0.885314  0.278772
4   4096.0  0.361119   1.737294  0.549402
5   8192.0  0.715114   3.614762  1.093269
6  16384.0  1.423742   7.170550  2.178470
7  32768.0  2.840819  14.290870  4.351795

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_silu-bf16:
         n           tr           to          toc
0    256.0    18.001465    66.753418    18.001465
1    512.0    36.001465   134.005371    36.001465
2   1024.0    72.001465   267.009277    72.001465
3   2048.0   144.001465   534.017090   144.001465
4   4096.0   288.001465  1068.032715   288.001465
5   8192.0   576.001465  2136.063965   576.001465
6  16384.0  1152.001465  4272.126465  1152.001465
7  32768.0  2304.001465  8544.251465  2304.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_silu-bf16:
         n        tr         to       toc
0    256.0  0.296087   0.439441  0.248525
1    512.0  0.604423   0.860829  0.463452
2   1024.0  0.523117   0.826032  0.832085
3   2048.0  0.539771   1.116387  1.295580
4   4096.0  0.505870   2.046040  1.163284
5   8192.0  1.006134   4.121567  1.237266
6  16384.0  2.005046   8.177578  2.467636
7  32768.0  4.003760  16.331371  4.925488

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_silu-bf16:
         n           tr            to          toc
0    256.0    44.551465     88.051465    44.551465
1    512.0    89.101465    176.601465    89.101465
2   1024.0   178.201465    352.201465   178.201465
3   2048.0   356.401465    704.401465   356.401465
4   4096.0   712.801465   1408.801465   712.801465
5   8192.0  1425.601465   2817.601465  1425.601465
6  16384.0  2851.201465   5635.201465  2851.201465
7  32768.0  5702.401465  11270.401465  5702.401465
```

## Softmax on feature
```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr         to       toc
0    256.0  0.051265   0.446868  0.094709
1    512.0  0.052099   0.264536  0.104383
2   1024.0  0.095982   0.483471  0.143081
3   2048.0  0.184436   0.899066  0.273855
4   4096.0  0.361452   1.761979  0.536221
5   8192.0  0.715700   3.663798  1.060916
6  16384.0  1.424742   7.267916  2.109562
7  32768.0  2.842446  14.477620  4.209656

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n           tr           to          toc
0    256.0    18.001465    66.753418    27.001465
1    512.0    36.001465   134.005371    54.001465
2   1024.0    72.001465   267.009277   108.001465
3   2048.0   144.001465   534.017090   216.001465
4   4096.0   288.001465  1068.032715   432.001465
5   8192.0   576.001465  2136.063965   864.001465
6  16384.0  1152.001465  4272.126465  1728.001465
7  32768.0  2304.001465  8544.251465  3456.001465

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n        tr         to       toc
0    256.0  1.051767   1.512398  1.107254
1    512.0  0.985164   1.268811  1.392509
2   1024.0  0.812190   1.542386  1.289469
3   2048.0  0.929885   1.281209  1.419712
4   4096.0  1.070066   2.200369  1.453676
5   8192.0  1.277417   4.422013  1.479814
6  16384.0  2.545619   8.774624  2.316000
7  32768.0  5.085180  17.515026  4.633198

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_softmax-dim_-1-bf16:
         n           tr            to          toc
0    256.0    44.551465     97.051465    53.551465
1    512.0    89.101465    194.601465   107.101465
2   1024.0   178.201465    388.201465   214.201465
3   2048.0   356.401465    776.401465   428.401465
4   4096.0   712.801465   1552.801465   856.801465
5   8192.0  1425.601465   3105.601465  1713.601465
6  16384.0  2851.201465   6211.201465  3427.201465
7  32768.0  5702.401465  12422.401465  6854.401465
```

## Softmax on sequence
```
lrpe_rotate-speed-fwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n        tr         to       toc
0    256.0  0.200233   0.747718  0.092647
1    512.0  0.220164   1.907532  0.316984
2   1024.0  0.211492   6.534720  0.294347
3   2048.0  0.378558   7.547792  0.412406
4   4096.0  1.058376  15.584967  1.689521
5   8192.0  1.142163  14.381791  1.586094
6  16384.0  2.262314  28.619104  3.153138
7  32768.0  4.511290  57.052032  6.295984

lrpe_rotate-memory-fwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n          tr            to         toc
0    256.0    27.14209     84.753418    18.14209
1    512.0    54.14209    170.005371    36.14209
2   1024.0   108.14209    339.009277    72.14209
3   2048.0   216.14209    678.017090   144.14209
4   4096.0   432.14209   1356.032715   288.14209
5   8192.0   864.14209   2712.063965   576.14209
6  16384.0  1728.14209   5424.126465  1152.14209
7  32768.0  3456.14209  10848.251465  2304.14209

lrpe_rotate-speed-bwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n        tr         to       toc
0    256.0  1.102100   1.486611  0.369886
1    512.0  1.054679   1.297442  1.142467
2   1024.0  0.420874   1.293962  1.191622
3   2048.0  0.653968   2.500938  0.581236
4   4096.0  0.833592   4.974105  0.998266
5   8192.0  1.657902  10.004702  1.785379
6  16384.0  3.267929  19.919537  3.547954
7  32768.0  6.514342  39.828285  7.072716

lrpe_rotate-memory-bwd-batch12-head12-dim128-act_softmax-dim_1-bf16:
         n           tr            to          toc
0    256.0    62.762402    110.551465    44.762402
1    512.0   125.312402    221.101465    89.312402
2   1024.0   250.412402    442.201465   178.412402
3   2048.0   500.612402    884.401465   356.612402
4   4096.0  1001.012402   1768.801465   713.012402
5   8192.0  2001.812402   3537.601465  1425.812402
6  16384.0  4003.412402   7075.201465  2851.412402
7  32768.0  8006.612402  14150.401465  5702.612402
```

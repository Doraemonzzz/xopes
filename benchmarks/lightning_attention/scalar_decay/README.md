# Lightning Attention with Scalar Decay

## Notation

- lasd_r: Triton recurrence
- flash: Flash attention

## A100

### Speed
```
lasd-speed-fwd-batch4-head32-dim128-bf16:
         n     LASD_R     LASD_P     LAND_P       Flash  Lightning
0    256.0   0.655077   0.208061   0.199819    0.053743   0.206699
1    512.0   1.272537   0.243890   0.242236    0.106848   0.376798
2   1024.0   2.510782   0.429647   0.423686    0.256303   0.716699
3   2048.0   4.975761   0.802444   0.795258    0.802330   1.405201
4   4096.0   9.918656   1.528784   1.517433    2.847658   2.769384
5   8192.0  19.740095   2.996417   2.980257   10.799474   5.545857
6  16384.0  39.399857   5.904430   5.872728   42.167267  10.946008
7  32768.0  78.719101  11.776900  11.701132  166.370407  21.831295

lasd-speed-bwd-batch4-head32-dim128-bf16:
        n     LASD_R     Flash
0   256.0   3.077055  0.188792
1   512.0   6.117918  0.385829
2  1024.0  12.221627  0.937125
3  2048.0  24.393583  2.681542
```


### Memory
```
lasd-memory-fwd-batch4-head32-dim128-bf16:
         n       LASD_R       LASD_P       LAND_P        Flash    Lightning
0    256.0    40.000488    64.000488    64.000488    32.125977    56.000977
1    512.0    72.000488   112.000488   112.000488    64.250977   112.000977
2   1024.0   136.000488   176.000488   176.000488   128.500977   224.000977
3   2048.0   264.000488   336.000488   336.000488   257.000977   448.000977
4   4096.0   520.000488   656.000488   656.000488   514.000977   896.000977
5   8192.0  1032.000488  1296.000488  1296.000488  1028.000977  1792.000977
6  16384.0  2056.000488  2576.000488  2576.000488  2056.000977  3584.000977
7  32768.0  4104.000488  5136.000488  5136.000488  4112.000977  7168.000977

lasd-memory-bwd-batch4-head32-dim128-bf16:
        n      LASD_R       Flash
0   256.0  102.800488  103.050977
1   512.0  189.600488  206.100977
2  1024.0  363.200488  412.200977
3  2048.0  710.400488  824.400977
```

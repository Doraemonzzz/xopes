# Lightning Attention with Scalar Decay

## Notation

- lasd_r: Triton recurrence
- flash: Flash attention

## A100

### Speed
```
lasd-speed-fwd-batch4-head32-dim128-bf16:
         n     LASD_R     LASD_P     LAND_P       Flash  Lightning
0    256.0   0.654904   0.212199   0.196347    0.053760   0.206336
1    512.0   1.270979   0.239523   0.236565    0.106638   0.375870
2   1024.0   2.510414   0.403009   0.396530    0.256505   0.713880
3   2048.0   4.972556   0.743308   0.735130    0.800995   1.402048
4   4096.0   9.928025   1.413580   1.401393    2.833641   2.758795
5   8192.0  19.744108   2.751852   2.729864   10.670741   5.459136
6  16384.0  39.554787   5.424938   5.375532   41.731743  10.886657
7  32768.0  78.841026  10.810344  10.715598  166.413284  21.811552

lasd-memory-fwd-batch4-head32-dim128-bf16:
         n       LASD_R       LASD_P       LAND_P        Flash    Lightning
0    256.0    40.000488    56.000488    56.000488    32.125977    56.000977
1    512.0    72.000488   104.000488   104.000488    64.250977   112.000977
2   1024.0   136.000488   168.000488   168.000488   128.500977   224.000977
3   2048.0   264.000488   328.000488   328.000488   257.000977   448.000977
4   4096.0   520.000488   648.000488   648.000488   514.000977   896.000977
5   8192.0  1032.000488  1288.000488  1288.000488  1028.000977  1792.000977
6  16384.0  2056.000488  2568.000488  2568.000488  2056.000977  3584.000977
7  32768.0  4104.000488  5128.000488  5128.000488  4112.000977  7168.000977
```


### Memory
```
lasd-speed-bwd-batch4-head32-dim128-bf16:
         n      LASD_R     LASD_P     LAND_P       Flash   Lightning
0    256.0    3.062907   0.900851   0.918483    0.188037    6.589295
1    512.0    7.497469   1.067709   1.062558    0.386114   14.386341
2   1024.0   14.990757   1.859204   1.835455    0.936686   25.225271
3   2048.0   24.341269   3.464326   3.437063    2.671094   51.026913
4   4096.0   48.795040   6.698215   6.654076    8.642324  102.084541
5   8192.0   97.574402  13.091258  13.021062   30.878912  204.621368
6  16384.0  195.116196  25.987337  25.820395  116.617821  410.427643
7  32768.0  390.256561  51.698849  51.399361  455.492401  820.138550

lasd-memory-bwd-batch4-head32-dim128-bf16:
         n        LASD_R        LASD_P        LAND_P         Flash     Lightning
0    256.0    102.800488    182.800488    182.800488    103.050977    111.200977
1    512.0    189.600488    341.600488    341.600488    206.100977    222.400977
2   1024.0    363.200488    595.200488    595.200488    412.200977    444.800977
3   2048.0    710.400488   1166.400488   1166.400488    824.400977    889.600977
4   4096.0   1404.800488   2308.800488   2308.800488   1648.800977   1779.200977
5   8192.0   2793.600488   4593.600488   4593.600488   3297.600977   3558.400977
6  16384.0   5571.200488   9163.200488   9163.200488   6595.200977   7116.800977
7  32768.0  11126.400488  18302.400488  18302.400488  13190.400977  14233.600977
```

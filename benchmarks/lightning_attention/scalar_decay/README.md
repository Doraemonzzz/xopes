# Lightning Attention with Scalar Decay

## Notation

- lasd_r: Triton recurrence
- flash: Flash attention

## A100

### Speed
```
lasd-speed-fwd-batch4-head32-dim128-bf16:
         n     LASD_R     LASD_P     LAND_P       Flash  Lightning_P  Lightning_C
0    256.0   0.654971   0.198672   0.187541    0.054347     0.239300     0.207108
1    512.0   1.270130   0.239609   0.236595    0.106586     0.439914     0.375431
2   1024.0   2.511020   0.403195   0.396743    0.256780     1.024096     0.713545
3   2048.0   4.974435   0.744131   0.733819    0.794122     1.988737     1.601171
4   4096.0   9.931687   1.413814   1.401320    2.817301     3.873254     3.182996
5   8192.0  19.702671   2.756575   2.731912   10.831789     6.964518     5.448162
6  16384.0  39.460991   5.421858   5.378584   41.946896    14.813019    10.862179
7  32768.0  79.031075  10.817444  10.722496  166.811523    27.929377    21.736095

lasd-speed-bwd-batch4-head32-dim128-bf16:
         n      LASD_R     LASD_P     LAND_P       Flash  Lightning_P  Lightning_C
0    256.0    3.062463   0.945193   1.010321    0.188739     0.637684     5.906008
1    512.0    6.105584   1.158760   1.090072    0.385814     1.186568    12.369011
2   1024.0   12.227380   1.918210   1.862129    0.936648     2.686489    25.085312
3   2048.0   24.403137   3.486831   3.461016    2.678236     5.095433    50.647839
4   4096.0   48.789536   6.716662   6.672061    8.663302    10.279315   101.897827
5   8192.0   97.440323  13.091090  13.029344   30.961397    18.642664   203.950470
6  16384.0  194.668793  25.996054  25.841301  117.745117    35.118496   409.103668
7  32768.0  388.760559  51.711136  51.467041  458.043121    70.003326   817.197327
```


### Memory
```
lasd-memory-fwd-batch4-head32-dim128-bf16:
         n       LASD_R       LASD_P       LAND_P        Flash  Lightning_P  Lightning_C
0    256.0    40.000488    56.000488    56.000488    32.125977    64.000977    56.000977
1    512.0    72.000488   104.000488   104.000488    64.250977   128.000977   112.000977
2   1024.0   136.000488   168.000488   168.000488   128.500977   256.000977   224.000977
3   2048.0   264.000488   328.000488   328.000488   257.000977   512.000977   448.000977
4   4096.0   520.000488   648.000488   648.000488   514.000977  1024.000977   896.000977
5   8192.0  1032.000488  1288.000488  1288.000488  1028.000977  2048.000977  1792.000977
6  16384.0  2056.000488  2568.000488  2568.000488  2056.000977  4096.000977  3584.000977
7  32768.0  4104.000488  5128.000488  5128.000488  4112.000977  8192.000977  7168.000977

lasd-memory-bwd-batch4-head32-dim128-bf16:
         n        LASD_R        LASD_P        LAND_P         Flash   Lightning_P   Lightning_C
0    256.0    102.800488    190.800488    190.800488    103.050977    126.800977    111.200977
1    512.0    189.600488    349.600488    349.600488    206.100977    253.600977    222.400977
2   1024.0    363.200488    603.200488    603.200488    412.200977    507.200977    444.800977
3   2048.0    710.400488   1174.400488   1174.400488    824.400977   1014.400977    889.600977
4   4096.0   1404.800488   2316.800488   2316.800488   1648.800977   2028.800977   1779.200977
5   8192.0   2793.600488   4601.600488   4601.600488   3297.600977   4057.600977   3558.400977
6  16384.0   5571.200488   9171.200488   9171.200488   6595.200977   8115.200977   7116.800977
7  32768.0  11126.400488  18310.400488  18310.400488  13190.400977  16230.400977  14233.600977
```

# Lightning Attention State compute

## Notation

## A800

### Speed
```
state-speed-fwd-batch4-head32-dim128-bf16:
         n       GLA    LAVD_K   LAVD_KV  LAVD_K_P  LAVD_KV_P
0    256.0  0.075826  0.064016  0.065058  0.178324   0.221260
1    512.0  0.133686  0.127378  0.127376  0.205541   0.193472
2   1024.0  0.246491  0.238101  0.237774  0.347243   0.347127
3   2048.0  0.466311  0.446611  0.447688  0.663920   0.664195
4   4096.0  0.905026  0.863381  0.862360  1.287782   1.287132
5   8192.0  1.808811  1.713173  1.707584  2.540957   2.541044
6  16384.0  3.584901  3.444830  3.441893  5.014789   5.018641
7  32768.0  7.141530  6.969129  6.969824  9.892384   9.905543

state-speed-fwd-batch1-head16-dim128-bf16:
         n       GLA    LAVD_K   LAVD_KV  LAVD_K_P  LAVD_KV_P
0    256.0  0.040490  0.038191  0.043748  0.183557   0.190650
1    512.0  0.046288  0.039400  0.048994  0.190305   0.223093
2   1024.0  0.059027  0.048693  0.048716  0.199658   0.213545
3   2048.0  0.096625  0.088336  0.088085  0.203187   0.193486
4   4096.0  0.182235  0.164127  0.163954  0.222444   0.222282
5   8192.0  0.343060  0.309828  0.309794  0.416805   0.416809
6  16384.0  0.664660  0.603072  0.603093  0.834743   0.803710
7  32768.0  1.311576  1.192132  1.191492  1.601659   1.601469
```


### Memory
```
state-memory-fwd-batch4-head32-dim128-bf16:
         n     GLA  LAVD_K  LAVD_KV
0    256.0    64.0    56.0     56.0
1    512.0   120.0   108.0    108.0
2   1024.0   232.0   212.0    212.0
3   2048.0   456.0   420.0    420.0
4   4096.0   904.0   836.0    836.0
5   8192.0  1800.0  1668.0   1668.0
6  16384.0  3592.0  3332.0   3332.0
7  32768.0  7176.0  6660.0   6660.0

state-memory-fwd-batch1-head16-dim128-bf16:
         n    GLA  LAVD_K  LAVD_KV
0    256.0    8.0     7.0      7.0
1    512.0   15.0    14.0     14.0
2   1024.0   29.0    26.5     26.5
3   2048.0   57.0    52.5     52.5
4   4096.0  113.0   104.5    104.5
5   8192.0  225.0   208.5    208.5
6  16384.0  449.0   416.5    416.5
7  32768.0  897.0   832.5    832.5
```

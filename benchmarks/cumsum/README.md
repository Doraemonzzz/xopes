# Cumsum benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Reverse=True

#### Speed
```
cumsum-speed-fwd-batch4096-reverse_True-bf16:
         n        tr        to       toc
0   1024.0  0.021328  0.163086  0.036671
1   2048.0  0.032817  0.325195  0.095201
2   4096.0  0.055807  0.617270  0.174489
3   8192.0  0.118019  1.011828  0.329403
4  16384.0  0.317371  1.989275  0.632882
5  32768.0  0.812791  3.869169  1.242398

cumsum-speed-bwd-batch4096-reverse_True-bf16:
         n        tr        to       toc
0   1024.0  0.046807  0.221829  0.050514
1   2048.0  0.056090  0.448295  0.091073
2   4096.0  0.111429  0.855663  0.183850
3   8192.0  0.206703  1.480896  0.347530
4  16384.0  0.396558  2.911531  0.676072
5  32768.0  0.774322  5.710316  1.331576
```

#### Memory

```
cumsum-memory-fwd-batch4096-reverse_True-bf16:
         n     tr      to     toc
0   1024.0   16.0    56.0    32.0
1   2048.0   32.0   112.0    64.0
2   4096.0   64.0   224.0   128.0
3   8192.0  128.0   448.0   256.0
4  16384.0  256.0   896.0   512.0
5  32768.0  512.0  1792.0  1024.0

cumsum-memory-bwd-batch4096-reverse_True-bf16:
         n      tr      to     toc
0   1024.0    39.6    95.6    39.6
1   2048.0    79.2   191.2    79.2
2   4096.0   158.4   382.4   158.4
3   8192.0   316.8   764.8   316.8
4  16384.0   633.6  1529.6   633.6
5  32768.0  1267.2  3059.2  1267.2
```

### Reverse=False

#### Speed
```
cumsum-speed-fwd-batch4096-reverse_False-bf16:
         n        tr        to       toc
0   1024.0  0.017327  0.118353  0.038131
1   2048.0  0.028238  0.228219  0.066725
2   4096.0  0.047722  0.437875  0.120872
3   8192.0  0.087094  0.664703  0.228519
4  16384.0  0.163952  1.310258  0.443931
5  32768.0  0.318135  2.515462  0.874727

cumsum-speed-bwd-batch4096-reverse_False-bf16:
         n        tr        to       toc
0   1024.0  0.042369  0.174248  0.081740
1   2048.0  0.069574  0.352984  0.125580
2   4096.0  0.117661  0.674860  0.235299
3   8192.0  0.236012  1.130811  0.444660
4  16384.0  0.546187  2.218914  0.860994
5  32768.0  1.271387  4.327172  1.695874
```

#### Memory

```
cumsum-memory-fwd-batch4096-reverse_False-bf16:
         n     tr      to    toc
0   1024.0   16.0    48.0   16.0
1   2048.0   32.0    96.0   32.0
2   4096.0   64.0   192.0   64.0
3   8192.0  128.0   384.0  128.0
4  16384.0  256.0   768.0  256.0
5  32768.0  512.0  1536.0  512.0

cumsum-memory-bwd-batch4096-reverse_False-bf16:
         n      tr      to     toc
0   1024.0    39.6    95.6    55.6
1   2048.0    79.2   191.2   111.2
2   4096.0   158.4   382.4   222.4
3   8192.0   316.8   764.8   444.8
4  16384.0   633.6  1529.6   889.6
5  32768.0  1267.2  3059.2  1779.2
```

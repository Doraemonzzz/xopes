# Cumsum benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Reverse=True

#### Speed
```
cumsum-speed-fwd-batch4096-reverse_True-bf16:
         n        tr       trc        to       toc
0   1024.0  0.021392  0.177226  0.152282  0.038137
1   2048.0  0.032685  0.344680  0.311191  0.095023
2   4096.0  0.056133  0.677983  0.595576  0.174636
3   8192.0  0.118717  1.337958  0.973790  0.329576
4  16384.0  0.320040  2.663676  1.907532  0.633697
5  32768.0  0.938477  5.313396  3.714453  1.244187

cumsum-speed-bwd-batch4096-reverse_True-bf16:
         n        tr       trc        to       toc
0   1024.0  0.068473  0.155222  0.210955  0.054768
1   2048.0  0.085857  0.305532  0.438517  0.091421
2   4096.0  0.111351  0.608022  0.838093  0.184167
3   8192.0  0.206290  1.204417  1.437715  0.348377
4  16384.0  0.396637  2.405682  2.838906  0.677920
5  32768.0  0.775359  4.799014  5.545982  1.335788
```

#### Memory

```
cumsum-memory-fwd-batch4096-reverse_True-bf16:
         n     tr    trc      to     toc
0   1024.0   16.0   16.0    56.0    32.0
1   2048.0   32.0   32.0   112.0    64.0
2   4096.0   64.0   64.0   224.0   128.0
3   8192.0  128.0  128.0   448.0   256.0
4  16384.0  256.0  256.0   896.0   512.0
5  32768.0  512.0  512.0  1792.0  1024.0

cumsum-memory-bwd-batch4096-reverse_True-bf16:
         n      tr     trc      to     toc
0   1024.0    39.6    39.6    95.6    39.6
1   2048.0    79.2    79.2   191.2    79.2
2   4096.0   158.4   158.4   382.4   158.4
3   8192.0   316.8   316.8   764.8   316.8
4  16384.0   633.6   633.6  1529.6   633.6
5  32768.0  1267.2  1267.2  3059.2  1267.2
```

### Reverse=False

#### Speed
```
cumsum-speed-fwd-batch4096-reverse_False-bf16:
         n        tr       trc        to       toc
0   1024.0  0.017209  0.143828  0.106620  0.029790
1   2048.0  0.028659  0.279409  0.211224  0.041178
2   4096.0  0.048153  0.551554  0.411466  0.073781
3   8192.0  0.086916  1.094204  0.619840  0.138330
4  16384.0  0.163996  2.179292  1.218470  0.265863
5  32768.0  0.317926  4.349126  2.333416  0.522290

cumsum-speed-bwd-batch4096-reverse_False-bf16:
         n        tr       trc        to       toc
0   1024.0  0.054492  0.189463  0.163434  0.055174
1   2048.0  0.060552  0.371657  0.341423  0.110234
2   4096.0  0.117269  0.735183  0.656169  0.205686
3   8192.0  0.236064  1.453877  1.085340  0.386615
4  16384.0  0.548538  2.899716  2.136712  0.753680
5  32768.0  1.275999  5.791012  4.165328  1.483365
```

#### Memory

```
cumsum-memory-fwd-batch4096-reverse_False-bf16:
         n     tr    trc      to    toc
0   1024.0   16.0   16.0    48.0   16.0
1   2048.0   32.0   32.0    96.0   32.0
2   4096.0   64.0   64.0   192.0   64.0
3   8192.0  128.0  128.0   384.0  128.0
4  16384.0  256.0  256.0   768.0  256.0
5  32768.0  512.0  512.0  1536.0  512.0

cumsum-memory-bwd-batch4096-reverse_False-bf16:
         n      tr     trc      to     toc
0   1024.0    39.6    39.6    95.6    55.6
1   2048.0    79.2    79.2   191.2   111.2
2   4096.0   158.4   158.4   382.4   222.4
3   8192.0   316.8   316.8   764.8   444.8
4  16384.0   633.6   633.6  1529.6   889.6
5  32768.0  1267.2  1267.2  3059.2  1779.2
```

# Cumsum benchmark

## Notation

- tr: Triton
- to: Torch
- toc: Torch Compile

## A100

### Reverse=True

#### Speed
```
cumsum-speed-fwd-b12-h1-reverse_True-bf16:
         n        tr       trc      trnr        to       toc
0   1024.0  0.007390  0.017885  0.007379  0.030228  0.011975
1   2048.0  0.007851  0.029431  0.008449  0.030626  0.036961
2   4096.0  0.009166  0.052863  0.008538  0.038090  0.014082
3   8192.0  0.010724  0.095808  0.010727  0.039946  0.018868
4  16384.0  0.013243  0.183847  0.013239  0.055835  0.027272
5  32768.0  0.022947  0.351636  0.023568  0.088573  0.044961

cumsum-speed-fwd-b12-h128-reverse_True-bf16:
         n        tr       trc      trnr         to       toc
0   1024.0  0.032651  0.022731  0.061506   0.257108  0.068544
1   2048.0  0.051922  0.037460  0.111042   0.588016  0.125525
2   4096.0  0.091524  0.066609  0.211803   2.009897  0.249113
3   8192.0  0.181776  0.123906  0.416579   4.058136  0.512267
4  16384.0  0.387494  0.236461  0.863616   8.200008  1.045586
5  32768.0  0.837038  0.464313  2.029975  16.401360  2.361740
```

#### Memory

```
cumsum-memory-fwd-b12-h1-reverse_True-bf16:
         n        tr       trc      trnr        to      toc
0   1024.0  0.046875  0.046875  0.046875  0.164062  0.09375
1   2048.0  0.093750  0.093750  0.093750  0.328125  0.18750
2   4096.0  0.187500  0.187500  0.187500  0.656250  0.37500
3   8192.0  0.375000  0.375000  0.375000  1.312500  0.75000
4  16384.0  0.750000  0.750000  0.750000  2.625000  1.50000
5  32768.0  1.500000  1.500000  1.500000  5.250000  3.00000

cumsum-memory-fwd-b12-h128-reverse_True-bf16:
         n     tr    trc   trnr     to    toc
0   1024.0    9.0    6.0    6.0   21.0   12.0
1   2048.0   18.0   12.0   12.0   42.0   24.0
2   4096.0   36.0   24.0   24.0   84.0   48.0
3   8192.0   72.0   48.0   48.0  168.0   96.0
4  16384.0  144.0   96.0   96.0  336.0  192.0
5  32768.0  288.0  192.0  192.0  672.0  384.0
```

### Reverse=False

#### Speed
```
cumsum-speed-fwd-b12-h1-reverse_False-bf16:
         n        tr       trc      trnr        to       toc
0   1024.0  0.007716  0.019778  0.007661  0.021555  0.008270
1   2048.0  0.007221  0.032501  0.007185  0.021852  0.009001
2   4096.0  0.007375  0.058348  0.008002  0.030220  0.012267
3   8192.0  0.008492  0.106050  0.007865  0.031227  0.017341
4  16384.0  0.008865  0.204829  0.008862  0.046300  0.026928
5  32768.0  0.012225  0.401893  0.011572  0.077522  0.047467

cumsum-speed-fwd-b12-h128-reverse_False-bf16:
         n        tr       trc      trnr         to       toc
0   1024.0  0.029838  0.025843  0.067376   0.238166  0.112248
1   2048.0  0.047256  0.043074  0.110567   0.624361  0.211626
2   4096.0  0.081294  0.078353  0.211678   1.929774  0.418413
3   8192.0  0.159917  0.146930  0.417295   3.916995  0.833584
4  16384.0  0.317535  0.280882  0.848488   7.915824  1.665738
5  32768.0  0.634189  0.552153  1.799579  15.869786  3.304789```

#### Memory

```
cumsum-memory-fwd-b12-h1-reverse_False-bf16:
         n        tr       trc      trnr        to       toc
0   1024.0  0.046875  0.046875  0.046875  0.140625  0.046875
1   2048.0  0.093750  0.093750  0.093750  0.281250  0.093750
2   4096.0  0.187500  0.187500  0.187500  0.562500  0.187500
3   8192.0  0.375000  0.375000  0.375000  1.125000  0.375000
4  16384.0  0.750000  0.750000  0.750000  2.250000  0.750000
5  32768.0  1.500000  1.500000  1.500000  4.500000  1.500000

cumsum-memory-fwd-b12-h128-reverse_False-bf16:
         n     tr    trc   trnr     to    toc
0   1024.0    9.0    6.0    6.0   18.0   12.0
1   2048.0   18.0   12.0   12.0   36.0   24.0
2   4096.0   36.0   24.0   24.0   72.0   48.0
3   8192.0   72.0   48.0   48.0  144.0   96.0
4  16384.0  144.0   96.0   96.0  288.0  192.0
5  32768.0  288.0  192.0  192.0  576.0  384.0
```

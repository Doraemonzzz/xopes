# Logsumexp benchmark

## Notation

- ptr: Parallel Triton
- rtr: Recurrence Triton
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
logsumexp-speed-fwd-batch4-dim1024-bf16:
          n       ptr       rtr        to       toc
0    1024.0  0.116681  0.055476  0.052131  0.110113
1    2048.0  0.108690  0.038041  0.074202  0.085790
2    4096.0  0.123438  0.068852  0.127783  0.060024
3    8192.0  0.105477  0.043717  0.243841  0.064366
4   16384.0  0.183817  0.059882  0.417755  0.106650
5   32768.0  0.128535  0.103831  0.762382  0.192106
6   65536.0  0.239270  0.190221  1.451215  0.424308
7  131072.0  0.458197  0.360373  2.828283  0.881607

logsumexp-speed-bwd-batch4-dim1024-bf16:
          n       ptr       rtr        to       toc
0    1024.0  0.243823  0.262497  0.224152  0.407196
1    2048.0  0.267864  0.233431  0.225401  0.424639
2    4096.0  0.258011  0.264318  0.240989  0.415195
3    8192.0  0.281393  0.420661  0.296813  0.442425
4   16384.0  0.277327  0.598004  0.575912  0.747328
5   32768.0  0.451891  0.451899  1.131140  0.452687
6   65536.0  0.890852  0.891565  2.244774  0.889265
7  131072.0  1.775569  1.775125  4.471096  1.761538
```


### Memory
```
logsumexp-memory-fwd-batch4-dim1024-bf16:
          n          ptr          rtr           to          toc
0    1024.0     8.132812     8.007812    16.015625     8.007812
1    2048.0    16.257812    16.007812    32.015625    16.007812
2    4096.0    32.507812    32.007812    64.015625    32.007812
3    8192.0    65.007812    64.007812   128.015625    64.007812
4   16384.0   130.007812   128.007812   256.015625   128.007812
5   32768.0   260.007812   256.007812   512.015625   256.007812
6   65536.0   520.007812   512.007812  1024.015625   512.007812
7  131072.0  1040.007812  1024.007812  2048.015625  1024.007812

logsumexp-memory-bwd-batch4-dim1024-bf16:
          n          ptr          rtr           to          toc
0    1024.0    23.615625    23.615625    39.615625    23.615625
1    2048.0    47.215625    47.215625    79.215625    47.215625
2    4096.0    94.415625    94.415625   158.415625    94.415625
3    8192.0   188.815625   188.815625   316.815625   188.815625
4   16384.0   377.615625   377.615625   633.615625   377.615625
5   32768.0   755.215625   755.215625  1267.215625   755.215625
6   65536.0  1510.415625  1510.415625  2534.415625  1510.415625
7  131072.0  3020.815625  3020.815625  5068.815625  3020.815625
```

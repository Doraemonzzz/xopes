# Logsumexp benchmark

## Notation

- ptr: Parallel Triton
- rtr: Recurrence Triton
- to: Torch
- toc: Torch Compile

## H100

### Speed

```
logsumexp-speed-fwd-batch4-dim1024-bf16:
          n       ptr       rtr        to       toc
0    1024.0  0.134130  0.043485  0.055450  0.135457
1    2048.0  0.134939  0.045240  0.077612  0.096324
2    4096.0  0.130576  0.045508  0.147080  0.067179
3    8192.0  0.133149  0.048303  0.247654  0.068213
4   16384.0  0.129040  0.060898  0.420579  0.136167
5   32768.0  0.141337  0.104637  0.765629  0.193699
6   65536.0  0.282261  0.190312  1.460969  0.436353
7  131072.0  0.472705  0.359508  5.143463  1.935863

logsumexp-speed-bwd-batch4-dim1024-bf16:
          n       ptr       rtr        to       toc
0    1024.0  0.504429  0.883782  0.350307  1.120010
1    2048.0  0.250565  0.221087  0.194690  0.386262
2    4096.0  0.203553  0.298414  0.261455  0.406884
3    8192.0  0.185658  0.239006  0.297374  0.441216
4   16384.0  0.289193  1.192855  0.891194  1.440914
5   32768.0  1.252422  1.232994  1.133215  1.516357
6   65536.0  0.893857  1.117647  2.245005  1.357069
7  131072.0  1.777475  1.902975  4.585935  2.124180
```


### Memory
```
logsumexp-memory-fwd-batch4-dim1024-bf16:
          n          ptr          rtr           to          toc
0    1024.0     8.132812     8.007812    16.015625     8.007812
1    2048.0    16.257812    16.007812    32.015625    16.007812
2    4096.0    32.507812    32.007812    64.015625    32.007812
3    8192.0    65.007812    64.007812   128.015625    64.007812
4   16384.0   130.007812   128.007812   256.015625   128.007812
5   32768.0   260.007812   256.007812   512.015625   256.007812
6   65536.0   520.007812   512.007812  1024.015625   512.007812
7  131072.0  1040.007812  1024.007812  2048.015625  1024.007812

logsumexp-memory-bwd-batch4-dim1024-bf16:
          n          ptr          rtr           to          toc
0    1024.0    23.615625    23.615625    39.615625    23.615625
1    2048.0    47.215625    47.215625    79.215625    47.215625
2    4096.0    94.415625    94.415625   158.415625    94.415625
3    8192.0   188.815625   188.815625   316.815625   188.815625
4   16384.0   377.615625   377.615625   633.615625   377.615625
5   32768.0   755.215625   755.215625  1267.215625   755.215625
6   65536.0  1510.415625  1510.415625  2534.415625  1510.415625
7  131072.0  3020.815625  3020.815625  5068.815625  3020.815625
```

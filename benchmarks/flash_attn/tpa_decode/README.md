# Notation

- Trb: Triton parallel_b
- Trbh: Triton parallel_bh
- Trbn: Triton parallel_bn
- To: Torch
- Toc: Torch Compile
- Ton: Torch Naive
- Tonc: Torch Naive Compile

# A800

## Speed
```
tpa_decode-speed-fwd-batch8-head32-dim128-rank16-bf16:
         m       trb      trbh      trbn        to       toc        ton       tonc
0    256.0  0.018266  0.021854  0.032163  0.145374  0.135945   0.334204   0.176387
1    512.0  0.028048  0.033162  0.041107  0.149265  0.199616   0.553340   0.350306
2   1024.0  0.046810  0.058867  0.042433  0.148462  0.186442   1.047901   0.870592
3   2048.0  0.083894  0.101965  0.045207  0.152891  0.197651   2.030118   1.659351
4   4096.0  0.159492  0.191897  0.051771  0.171027  0.364394   3.975240   3.189269
5   8192.0  0.310250  0.370599  0.087761  0.151047  0.720112   7.904787   6.232171
6  16384.0  0.643519  0.735155  0.124758  0.248654  1.308606  15.957435  12.570787
7  32768.0  1.277707  1.529119  0.197956  0.448625  2.943373  32.020039  25.659063

tpa_decode-speed-fwd-batch32-head32-dim128-rank16-bf16:
         m       trb      trbh      trbn        to       toc         ton        tonc
0    256.0  0.020236  0.058963  0.028662  0.144217  0.217007    1.029603    0.647905
1    512.0  0.035903  0.098880  0.044461  0.161341  0.217843    2.051395    1.276447
2   1024.0  0.050707  0.185486  0.076047  0.154303  0.231792    3.990560    3.195560
3   2048.0  0.108271  0.359624  0.084658  0.150862  0.427926    7.888987    6.035728
4   4096.0  0.165758  0.731031  0.146273  0.209911  0.859791   15.811386   12.638465
5   8192.0  0.337437  1.485858  0.214823  0.377758  1.691976   31.749535   24.929163
6  16384.0  0.622298  2.973876  0.350476  0.716521  3.716136   63.749279   49.097984
7  32768.0  1.233322  7.152067  0.662828  1.381425  7.799680  128.022949  100.595299
```



## Memory
```
tpa_decode-memory-fwd-batch8-head32-dim128-rank16-bf16:
         m         trb        trbh        trbn          to         toc          ton         tonc
0    256.0    9.476562    9.476562    9.539551   10.101562    9.916016    73.789062    41.664062
1    512.0   10.726562   10.726562   10.789551   11.914062   11.603516   139.289062    75.039062
2   1024.0   13.226562   13.226562   13.352539   15.539062   14.978516   270.289062   141.789062
3   2048.0   18.226562   18.226562   18.478516   22.789062   21.728516   532.289062   275.289062
4   4096.0   28.226562   28.226562   28.730469   37.289062   35.228516  1056.289062   542.289062
5   8192.0   48.226562   48.226562   49.234375   66.289062   62.228516  2104.289062  1076.289062
6  16384.0   88.226562   88.226562   90.242188  124.289062  116.228516  4200.289062  2144.289062
7  32768.0  168.226562  168.226562  172.257812  240.289062  224.228516  8392.289062  4280.289062

tpa_decode-memory-fwd-batch32-head32-dim128-rank16-bf16:
         m        trb       trbh        trbn         to         toc          ton         tonc
0    256.0   13.53125   13.53125   13.783203   16.03125   15.289062    270.78125    142.28125
1    512.0   18.53125   18.53125   18.783203   23.28125   22.039062    532.78125    275.78125
2   1024.0   28.53125   28.53125   28.783203   37.78125   35.539062   1056.78125    542.78125
3   2048.0   48.53125   48.53125   48.783203   66.78125   62.539062   2104.78125   1076.78125
4   4096.0   88.53125   88.53125   88.783203  124.78125  116.539062   4200.78125   2144.78125
5   8192.0  168.53125  168.53125  169.035156  240.78125  224.539062   8392.78125   4280.78125
6  16384.0  328.53125  328.53125  329.539062  472.78125  440.539062  16776.78125   8552.78125
7  32768.0  648.53125  648.53125  650.546875  936.78125  872.539062  33544.78125  17096.78125
```

# Notation

- Trb: Triton parallel_b
- Trbh: Triton parallel_bh
- Trbn: Triton parallel_bn
- To: Torch
- Toc: Torch Compile
- Ton: Torch Naive
- Tonc: Torch Naive Compile

# A800

## Speed
```
tpa_decode-speed-fwd-batch8-head32-dim128-rank16-bf16:
         m       trb      trbh      trbn        to       toc        ton       tonc
0    256.0  0.017620  0.021803  0.039217  0.194414  0.173257   0.301590   0.178120
1    512.0  0.027370  0.033708  0.040961  0.170710  0.210492   0.552173   0.350204
2   1024.0  0.046116  0.056945  0.050399  0.160968  0.206018   1.046896   0.869180
3   2048.0  0.083779  0.101241  0.044987  0.179757  0.217208   2.029139   1.658857
4   4096.0  0.159983  0.192079  0.051610  0.173638  0.363050   3.973948   3.188514
5   8192.0  0.310070  0.370484  0.089441  0.157299  0.719818   7.903618   6.226259
6  16384.0  0.608003  0.733818  0.124771  0.247847  1.307523  15.959643  12.567579
7  32768.0  1.203443  1.536093  0.197696  0.447497  2.941790  32.014912  25.665335

tpa_decode-speed-fwd-batch32-head32-dim128-rank16-bf16:
         m       trb      trbh      trbn        to       toc         ton        tonc
0    256.0  0.020173  0.058935  0.032208  0.177448  0.208919    1.028250    0.646523
1    512.0  0.030057  0.098346  0.045146  0.162067  0.206047    2.049952    1.275347
2   1024.0  0.050670  0.184865  0.076825  0.164001  0.230714    3.990245    3.118163
3   2048.0  0.089754  0.359600  0.159230  0.165386  0.426834    7.888157    6.035478
4   4096.0  0.165650  0.731000  0.255372  0.209160  0.859315   15.810187   12.635982
5   8192.0  0.318259  1.486714  0.265604  0.376975  1.690469   31.706964   24.912394
6  16384.0  0.622784  2.974225  0.508119  0.715689  3.717000   63.741886   48.966766
7  32768.0  1.232879  7.170789  0.762150  1.379539  7.800825  127.961090  100.519745
```



## Memory
```
tpa_decode-memory-fwd-batch8-head32-dim128-rank16-bf16:
         m         trb        trbh        trbn          to         toc          ton         tonc
0    256.0    9.476562    9.476562    9.539551   10.101562    9.916016    73.789062    41.664062
1    512.0   10.726562   10.726562   10.789551   11.914062   11.603516   139.289062    75.039062
2   1024.0   13.226562   13.226562   13.352539   15.539062   14.978516   270.289062   141.789062
3   2048.0   18.226562   18.226562   18.478516   22.789062   21.728516   532.289062   275.289062
4   4096.0   28.226562   28.226562   28.730469   37.289062   35.228516  1056.289062   542.289062
5   8192.0   48.226562   48.226562   49.234375   66.289062   62.228516  2104.289062  1076.289062
6  16384.0   88.226562   88.226562   90.242188  124.289062  116.228516  4200.289062  2144.289062
7  32768.0  168.226562  168.226562  172.257812  240.289062  224.228516  8392.289062  4280.289062

tpa_decode-memory-fwd-batch32-head32-dim128-rank16-bf16:
         m        trb       trbh        trbn         to         toc          ton         tonc
0    256.0   13.53125   13.53125   13.783203   16.03125   15.289062    270.78125    142.28125
1    512.0   18.53125   18.53125   18.783203   23.28125   22.039062    532.78125    275.78125
2   1024.0   28.53125   28.53125   28.783203   37.78125   35.539062   1056.78125    542.78125
3   2048.0   48.53125   48.53125   48.783203   66.78125   62.539062   2104.78125   1076.78125
4   4096.0   88.53125   88.53125   88.783203  124.78125  116.539062   4200.78125   2144.78125
5   8192.0  168.53125  168.53125  169.035156  240.78125  224.539062   8392.78125   4280.78125
6  16384.0  328.53125  328.53125  329.539062  472.78125  440.539062  16776.78125   8552.78125
7  32768.0  648.53125  648.53125  650.546875  936.78125  872.539062  33544.78125  17096.78125
```
